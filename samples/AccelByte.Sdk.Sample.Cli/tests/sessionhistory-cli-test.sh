#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..37"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 GetHealthcheckInfoV1
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfoV1 \
    > test.out 2>&1
eval_tap $? 3 'GetHealthcheckInfoV1' test.out

#- 4 AdminGetLogConfig
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetLogConfig \
    > test.out 2>&1
eval_tap $? 4 'AdminGetLogConfig' test.out

#- 5 AdminPatchUpdateLogConfig
# body param: body
echo '{"logLevel": "trace"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op AdminPatchUpdateLogConfig \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'AdminPatchUpdateLogConfig' test.out

#- 6 AdminQueryGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'MjfoJ2IS' \
    --gameSessionID 'bFqIFHac' \
    --limit '53' \
    --offset '13' \
    --order 'ADT5pOcW' \
    --orderBy 'YhY3Mms6' \
    --startDate 'BJAmAvGf' \
    --userID 'HY9axfef' \
    > test.out 2>&1
eval_tap $? 6 'AdminQueryGameSessionDetail' test.out

#- 7 GetGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --sessionId 'O3vX60JZ' \
    > test.out 2>&1
eval_tap $? 7 'GetGameSessionDetail' test.out

#- 8 AdminQueryMatchmakingDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryMatchmakingDetail \
    --namespace $AB_NAMESPACE \
    --gameSessionID '45t6p5oi' \
    --limit '33' \
    --offset '63' \
    --order 'f8jIlsMY' \
    --orderBy 'IbNVyYXO' \
    --ticketID 'OF7l8Kql' \
    --userID 'A0HuLm1Q' \
    > test.out 2>&1
eval_tap $? 8 'AdminQueryMatchmakingDetail' test.out

#- 9 AdminGetMatchmakingDetailBySessionID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailBySessionID \
    --namespace $AB_NAMESPACE \
    --sessionId 'Y0rw3l1J' \
    > test.out 2>&1
eval_tap $? 9 'AdminGetMatchmakingDetailBySessionID' test.out

#- 10 AdminGetMatchmakingDetailByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'a0fYGfDY' \
    > test.out 2>&1
eval_tap $? 10 'AdminGetMatchmakingDetailByTicketID' test.out

#- 11 AdminQueryPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryPartyDetail \
    --namespace $AB_NAMESPACE \
    --limit '19' \
    --offset '43' \
    --order 'KUmcdXMh' \
    --orderBy 'WbvqniOW' \
    --partyID 'vnGS05I7' \
    --userID 'rxylIOhP' \
    > test.out 2>&1
eval_tap $? 11 'AdminQueryPartyDetail' test.out

#- 12 GetPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetPartyDetail \
    --namespace $AB_NAMESPACE \
    --sessionId '1dN9Sm6a' \
    > test.out 2>&1
eval_tap $? 12 'GetPartyDetail' test.out

#- 13 AdminQueryTicketDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryTicketDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'nvJYYRvM' \
    --gameMode 'dd5bh4P2' \
    --limit '74' \
    --offset '21' \
    --order 'MTx69frZ' \
    --partyID 'GBJKmxUB' \
    --region 'R17YkKU6' \
    --startDate 'wBDgq73B' \
    --userIDs 'rd9o2lXx' \
    > test.out 2>&1
eval_tap $? 13 'AdminQueryTicketDetail' test.out

#- 14 AdminTicketDetailGetByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminTicketDetailGetByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId '3R9ub738' \
    > test.out 2>&1
eval_tap $? 14 'AdminTicketDetailGetByTicketID' test.out

#- 15 PublicQueryGameSessionMe
$CLI_EXE \
    --sn sessionhistory \
    --op PublicQueryGameSessionMe \
    --namespace $AB_NAMESPACE \
    --limit '30' \
    --offset '25' \
    --order '4XoAJeUL' \
    > test.out 2>&1
eval_tap $? 15 'PublicQueryGameSessionMe' test.out

#- 16 QueryXrayMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatchPool \
    --namespace $AB_NAMESPACE \
    --poolName '["tTF3KxmT", "wy0Jor0C", "z8QYYYVa"]' \
    --endDate 'KXRupVsV' \
    --startDate 'm2M3s7aD' \
    > test.out 2>&1
eval_tap $? 16 'QueryXrayMatchPool' test.out

#- 17 QueryDetailTickMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPool \
    --namespace $AB_NAMESPACE \
    --podName 'dTRe5vZT' \
    --poolName '2Zpctd40' \
    --all 'false' \
    --limit '31' \
    --offset '92' \
    --endDate '4W7lejYL' \
    --startDate 'A3czT9oF' \
    > test.out 2>&1
eval_tap $? 17 'QueryDetailTickMatchPool' test.out

#- 18 QueryDetailTickMatchPoolMatches
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolMatches \
    --namespace $AB_NAMESPACE \
    --podName '7TTe60G4' \
    --poolName 'hlVSRHyG' \
    --tickId '9kLQxNkV' \
    > test.out 2>&1
eval_tap $? 18 'QueryDetailTickMatchPoolMatches' test.out

#- 19 QueryDetailTickMatchPoolTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolTicket \
    --namespace $AB_NAMESPACE \
    --podName 'xW07TVQa' \
    --poolName 'kOtRk434' \
    --tickId 'cZKlBbvt' \
    > test.out 2>&1
eval_tap $? 19 'QueryDetailTickMatchPoolTicket' test.out

#- 20 QueryMatchHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchHistories \
    --matchId '8dBI70Q0' \
    --namespace $AB_NAMESPACE \
    --limit '41' \
    --offset '17' \
    > test.out 2>&1
eval_tap $? 20 'QueryMatchHistories' test.out

#- 21 QueryMatchTicketHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchTicketHistories \
    --matchId '3Hlt09Tg' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'QueryMatchTicketHistories' test.out

#- 22 QueryXrayMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatch \
    --matchId 'WfTKTgf4' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'QueryXrayMatch' test.out

#- 23 QueryAcquiringDS
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDS \
    --namespace $AB_NAMESPACE \
    --matchPool '["dg29YLid", "5IF66FSP", "skvijCh8"]' \
    --endDate 'Tqlfkm2K' \
    --startDate 'v24ol0fn' \
    > test.out 2>&1
eval_tap $? 23 'QueryAcquiringDS' test.out

#- 24 QueryAcquiringDSWaitTimeAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDSWaitTimeAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["2n9oUxa9", "6Z8SpaMc", "BnG21a32"]' \
    --endDate 'r8plfQsu' \
    --startDate 'Z4oqV5Dq' \
    > test.out 2>&1
eval_tap $? 24 'QueryAcquiringDSWaitTimeAvg' test.out

#- 25 QueryMatchLengthDurationpAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationpAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["IJgiZwSP", "zhoOCy7H", "vXWKPlHm"]' \
    --endDate 'aiTEjJQ4' \
    --startDate 'ZRrPMw1H' \
    > test.out 2>&1
eval_tap $? 25 'QueryMatchLengthDurationpAvg' test.out

#- 26 QueryMatchLengthDurationp99
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationp99 \
    --namespace $AB_NAMESPACE \
    --matchPool '["BnmGLO8h", "Mi4jdRw1", "1CeaKzqi"]' \
    --endDate '5snL8RgG' \
    --startDate 'M1gMKCcw' \
    > test.out 2>&1
eval_tap $? 26 'QueryMatchLengthDurationp99' test.out

#- 27 QueryTotalActiveSession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalActiveSession \
    --namespace $AB_NAMESPACE \
    --matchPool '["FREq6ObG", "2iKm0C6C", "WV1c5yPV"]' \
    --region '3AIlSshe' \
    --endDate 'T2b41FGl' \
    --startDate 'SV526QJE' \
    > test.out 2>&1
eval_tap $? 27 'QueryTotalActiveSession' test.out

#- 28 QueryTotalMatchmakingMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatch \
    --namespace $AB_NAMESPACE \
    --matchPool '["AtULt2M2", "Escu8xch", "dDK1QweV"]' \
    --endDate 'wdjGReyR' \
    --startDate 'cMsNHUlr' \
    > test.out 2>&1
eval_tap $? 28 'QueryTotalMatchmakingMatch' test.out

#- 29 QueryTotalPlayerPersession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalPlayerPersession \
    --namespace $AB_NAMESPACE \
    --matchPool '["DaDpPsy4", "VkmzUq9S", "WJGLgo4Y"]' \
    --endDate '2Kamwkwv' \
    --startDate 'b2IFwsYH' \
    > test.out 2>&1
eval_tap $? 29 'QueryTotalPlayerPersession' test.out

#- 30 QueryTotalMatchmakingCanceled
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCanceled \
    --namespace $AB_NAMESPACE \
    --matchPool '["PHMS2A12", "USTXjBzs", "70NcNPQL"]' \
    --endDate 'XkjPjGwl' \
    --startDate 'u2bB2CTf' \
    > test.out 2>&1
eval_tap $? 30 'QueryTotalMatchmakingCanceled' test.out

#- 31 QueryTotalMatchmakingCreated
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCreated \
    --namespace $AB_NAMESPACE \
    --matchPool '["gxTa4bjN", "p8RZ0HGP", "oBUbMJKq"]' \
    --endDate 'SWN5QMfT' \
    --startDate 'L338w6pW' \
    > test.out 2>&1
eval_tap $? 31 'QueryTotalMatchmakingCreated' test.out

#- 32 QueryTotalMatchmakingExpired
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingExpired \
    --namespace $AB_NAMESPACE \
    --matchPool '["d4XuoXg4", "QLj7I3A0", "7CR1cb40"]' \
    --endDate 'Pwvxwi1h' \
    --startDate 'u1qq9xMm' \
    > test.out 2>&1
eval_tap $? 32 'QueryTotalMatchmakingExpired' test.out

#- 33 QueryTotalMatchmakingMatchTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatchTicket \
    --namespace $AB_NAMESPACE \
    --matchPool '["TfYaSYr6", "JPG05rYo", "Mx6szz6F"]' \
    --endDate 'KmbPc1B3' \
    --startDate '3FXAiekR' \
    > test.out 2>&1
eval_tap $? 33 'QueryTotalMatchmakingMatchTicket' test.out

#- 34 CreateXrayTicketObservability
# body param: body
echo '{"action": "OnWvIn5W", "activeAllianceRule": {"max_number": 78, "min_number": 3, "player_max_number": 36, "player_min_number": 87}, "activeMatchingRule": [{"attribute": "gzOrfRwU", "criteria": "qyehCqFb", "reference": 0.018622089773928097}, {"attribute": "iP7JrIAT", "criteria": "tRtpp1bf", "reference": 0.10591260250764267}, {"attribute": "b3KjnNuP", "criteria": "8QtlEKkN", "reference": 0.5698338001859693}], "function": "uuL4ZPDo", "gameMode": "dq2zPges", "isBackfillMatch": true, "isRuleSetFlexed": true, "iteration": 9, "matchID": "1uhMoGur", "namespace": "Xx25N8V7", "remainingPlayersPerTicket": [42, 100, 92], "remainingTickets": 8, "sessionTickID": "aAoKRhnC", "tickID": 21, "ticketID": "CTlVdc4z", "timeToMatchSec": 0.8422960180973115, "timestamp": "1995-11-27T00:00:00Z", "unbackfillReason": "wHkVVvEe", "unmatchReason": "pFIkrByN"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 34 'CreateXrayTicketObservability' test.out

#- 35 CreateXrayBulkTicketObservability
# body param: body
echo '{"ticketObservabilities": [{"action": "F512gHsX", "activeAllianceRule": {"max_number": 0, "min_number": 23, "player_max_number": 42, "player_min_number": 60}, "activeMatchingRule": [{"attribute": "n1buyQbe", "criteria": "efS0l2Uk", "reference": 0.8637238288895778}, {"attribute": "r6c6L3Lf", "criteria": "pCdFEy5b", "reference": 0.6786098174074714}, {"attribute": "hKj8GEBR", "criteria": "cTSXop0F", "reference": 0.8036517379316094}], "function": "wAqOQmt5", "gameMode": "TRuf3Ywy", "isBackfillMatch": true, "isRuleSetFlexed": true, "iteration": 27, "matchID": "Q7M5YkWJ", "namespace": "nwkvQnHO", "remainingPlayersPerTicket": [16, 7, 16], "remainingTickets": 86, "sessionTickID": "CJZlxTCQ", "tickID": 29, "ticketID": "gjX0X7bq", "timeToMatchSec": 0.7869214749480243, "timestamp": "1992-10-04T00:00:00Z", "unbackfillReason": "D0jaNBqS", "unmatchReason": "MtXJjjjk"}, {"action": "xS4V2DTz", "activeAllianceRule": {"max_number": 58, "min_number": 61, "player_max_number": 53, "player_min_number": 8}, "activeMatchingRule": [{"attribute": "xuWcsauI", "criteria": "zD2MPsOu", "reference": 0.43863126558457755}, {"attribute": "avpG7LFH", "criteria": "HjmKSLNp", "reference": 0.5214221440839711}, {"attribute": "4oBJgw1N", "criteria": "syLb4xSe", "reference": 0.38785205076409146}], "function": "9hJmfTPA", "gameMode": "naYE7nsT", "isBackfillMatch": true, "isRuleSetFlexed": false, "iteration": 85, "matchID": "Z1dr47sj", "namespace": "7qUqbYSi", "remainingPlayersPerTicket": [43, 19, 5], "remainingTickets": 60, "sessionTickID": "EdcMfN6h", "tickID": 34, "ticketID": "e5xRc3y6", "timeToMatchSec": 0.8670185549639546, "timestamp": "1989-07-26T00:00:00Z", "unbackfillReason": "I1AC8C2h", "unmatchReason": "olaYX4sg"}, {"action": "sI0aQMgY", "activeAllianceRule": {"max_number": 96, "min_number": 15, "player_max_number": 32, "player_min_number": 94}, "activeMatchingRule": [{"attribute": "Y17rTsdF", "criteria": "cLwXDd4F", "reference": 0.034915328478756336}, {"attribute": "gk1sMVVY", "criteria": "cps2h2T5", "reference": 0.9649328720901079}, {"attribute": "dboRL9c1", "criteria": "DdizINwV", "reference": 0.7567246505739454}], "function": "EYQhP3fE", "gameMode": "wc5GURDD", "isBackfillMatch": false, "isRuleSetFlexed": true, "iteration": 23, "matchID": "gJN7tib8", "namespace": "MVK0hwFk", "remainingPlayersPerTicket": [98, 79, 77], "remainingTickets": 37, "sessionTickID": "kikrEyOb", "tickID": 85, "ticketID": "dGXBlmmq", "timeToMatchSec": 0.38507851055156306, "timestamp": "1974-01-31T00:00:00Z", "unbackfillReason": "J2UAY4tI", "unmatchReason": "ymWgr8WB"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayBulkTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 35 'CreateXrayBulkTicketObservability' test.out

#- 36 QueryXrayTimelineByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId '9jaqfBh5' \
    --limit '55' \
    --offset '12' \
    --endDate 'WYxLdoX4' \
    --startDate 'ddG7ixhz' \
    > test.out 2>&1
eval_tap $? 36 'QueryXrayTimelineByTicketID' test.out

#- 37 QueryXrayTimelineByUserID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByUserID \
    --namespace $AB_NAMESPACE \
    --userId 'sXcZ0egc' \
    --limit '47' \
    --offset '40' \
    --endDate '3T5bkATd' \
    --startDate 'Wfa4BzAc' \
    > test.out 2>&1
eval_tap $? 37 'QueryXrayTimelineByUserID' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE