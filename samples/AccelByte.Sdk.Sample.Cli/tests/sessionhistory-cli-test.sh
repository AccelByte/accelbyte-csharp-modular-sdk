#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..37"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 GetHealthcheckInfoV1
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfoV1 \
    > test.out 2>&1
eval_tap $? 3 'GetHealthcheckInfoV1' test.out

#- 4 AdminGetLogConfig
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetLogConfig \
    > test.out 2>&1
eval_tap $? 4 'AdminGetLogConfig' test.out

#- 5 AdminPatchUpdateLogConfig
# body param: body
echo '{"logLevel": "info"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op AdminPatchUpdateLogConfig \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'AdminPatchUpdateLogConfig' test.out

#- 6 AdminQueryGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'tY05ZCb2' \
    --gameSessionID 'ugnqRhn1' \
    --limit '89' \
    --offset '9' \
    --order 'QVlqdyJa' \
    --orderBy '34rcRC1p' \
    --startDate 'nAVAI7VC' \
    --userID 'kEUdj8YV' \
    > test.out 2>&1
eval_tap $? 6 'AdminQueryGameSessionDetail' test.out

#- 7 GetGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --sessionId 'dIdU3WpH' \
    > test.out 2>&1
eval_tap $? 7 'GetGameSessionDetail' test.out

#- 8 AdminQueryMatchmakingDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryMatchmakingDetail \
    --namespace $AB_NAMESPACE \
    --gameSessionID 'bnQ3gSml' \
    --limit '29' \
    --offset '84' \
    --order '36Ajeg9i' \
    --orderBy 'd5PCYx04' \
    --ticketID 'Z8UVo1NF' \
    --userID 'qOXg22Wb' \
    > test.out 2>&1
eval_tap $? 8 'AdminQueryMatchmakingDetail' test.out

#- 9 AdminGetMatchmakingDetailBySessionID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailBySessionID \
    --namespace $AB_NAMESPACE \
    --sessionId 'zsCnNOlJ' \
    > test.out 2>&1
eval_tap $? 9 'AdminGetMatchmakingDetailBySessionID' test.out

#- 10 AdminGetMatchmakingDetailByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'HSZNpJlb' \
    > test.out 2>&1
eval_tap $? 10 'AdminGetMatchmakingDetailByTicketID' test.out

#- 11 AdminQueryPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryPartyDetail \
    --namespace $AB_NAMESPACE \
    --limit '26' \
    --offset '53' \
    --order 'uUNE7C7j' \
    --orderBy 'oisCfD0s' \
    --partyID 'eIkxqEUf' \
    --userID 'BmsUv3Ho' \
    > test.out 2>&1
eval_tap $? 11 'AdminQueryPartyDetail' test.out

#- 12 GetPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetPartyDetail \
    --namespace $AB_NAMESPACE \
    --sessionId '0SP8pgtb' \
    > test.out 2>&1
eval_tap $? 12 'GetPartyDetail' test.out

#- 13 AdminQueryTicketDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryTicketDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'DXci92IF' \
    --gameMode 'Sm3abDbv' \
    --limit '63' \
    --offset '9' \
    --order 'penJkeQ3' \
    --partyID 'vsAW88oo' \
    --region 'mWkwRhSj' \
    --startDate 'NbL3aMuT' \
    --userIDs 'PPiQ0Yd0' \
    > test.out 2>&1
eval_tap $? 13 'AdminQueryTicketDetail' test.out

#- 14 AdminTicketDetailGetByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminTicketDetailGetByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'PXnVFFu1' \
    > test.out 2>&1
eval_tap $? 14 'AdminTicketDetailGetByTicketID' test.out

#- 15 PublicQueryGameSessionMe
$CLI_EXE \
    --sn sessionhistory \
    --op PublicQueryGameSessionMe \
    --namespace $AB_NAMESPACE \
    --limit '63' \
    --offset '45' \
    --order 'hOHrmHBK' \
    > test.out 2>&1
eval_tap $? 15 'PublicQueryGameSessionMe' test.out

#- 16 QueryXrayMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatchPool \
    --namespace $AB_NAMESPACE \
    --poolName '["XCmBEbUM", "uXz3Ex65", "xs32GHin"]' \
    --endDate 'LLWhGk9O' \
    --startDate '2DOvVmRK' \
    > test.out 2>&1
eval_tap $? 16 'QueryXrayMatchPool' test.out

#- 17 QueryDetailTickMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPool \
    --namespace $AB_NAMESPACE \
    --podName 'N7hYauFB' \
    --poolName 'USvN9GYx' \
    --all 'true' \
    --limit '78' \
    --offset '70' \
    --endDate 'RVVFHbri' \
    --startDate 'E1vFDtsF' \
    > test.out 2>&1
eval_tap $? 17 'QueryDetailTickMatchPool' test.out

#- 18 QueryDetailTickMatchPoolMatches
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolMatches \
    --namespace $AB_NAMESPACE \
    --podName 'v082AwFp' \
    --poolName 'HGAqozPm' \
    --tickId 'Mjbjh4MR' \
    > test.out 2>&1
eval_tap $? 18 'QueryDetailTickMatchPoolMatches' test.out

#- 19 QueryDetailTickMatchPoolTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolTicket \
    --namespace $AB_NAMESPACE \
    --podName 'eaLmRXVH' \
    --poolName 'ALg5dziF' \
    --tickId '8hgYgTmI' \
    > test.out 2>&1
eval_tap $? 19 'QueryDetailTickMatchPoolTicket' test.out

#- 20 QueryMatchHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchHistories \
    --matchId 'LeX1s2X2' \
    --namespace $AB_NAMESPACE \
    --limit '1' \
    --offset '45' \
    > test.out 2>&1
eval_tap $? 20 'QueryMatchHistories' test.out

#- 21 QueryMatchTicketHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchTicketHistories \
    --matchId 'HqFkmlxl' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'QueryMatchTicketHistories' test.out

#- 22 QueryXrayMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatch \
    --matchId 'nlIUp5fS' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'QueryXrayMatch' test.out

#- 23 QueryAcquiringDS
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDS \
    --namespace $AB_NAMESPACE \
    --matchPool '["StzttBVZ", "S4He70su", "Vkyntq94"]' \
    --endDate 'fKkk0KYj' \
    --startDate 'vZexMOhx' \
    > test.out 2>&1
eval_tap $? 23 'QueryAcquiringDS' test.out

#- 24 QueryAcquiringDSWaitTimeAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDSWaitTimeAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["au50uysw", "aIcbwAU9", "M8CFRmU5"]' \
    --endDate '0OLpuYZs' \
    --startDate 'sjyrborS' \
    > test.out 2>&1
eval_tap $? 24 'QueryAcquiringDSWaitTimeAvg' test.out

#- 25 QueryMatchLengthDurationpAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationpAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["rW44u6em", "cmx5sKT0", "1ft78ISD"]' \
    --endDate 'XglGY8mz' \
    --startDate '9MQkqTPF' \
    > test.out 2>&1
eval_tap $? 25 'QueryMatchLengthDurationpAvg' test.out

#- 26 QueryMatchLengthDurationp99
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationp99 \
    --namespace $AB_NAMESPACE \
    --matchPool '["PC8vNL1F", "kJoigg7x", "IIlGAS9T"]' \
    --endDate 'I5fZPt4J' \
    --startDate 'iSUQroHt' \
    > test.out 2>&1
eval_tap $? 26 'QueryMatchLengthDurationp99' test.out

#- 27 QueryTotalActiveSession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalActiveSession \
    --namespace $AB_NAMESPACE \
    --matchPool '["03FaxHlY", "pH7gzv1E", "AqrHdhpr"]' \
    --region 'Egp4ppJU' \
    --endDate 'Q7e8ogyA' \
    --startDate 'Jrinu5xO' \
    > test.out 2>&1
eval_tap $? 27 'QueryTotalActiveSession' test.out

#- 28 QueryTotalMatchmakingMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatch \
    --namespace $AB_NAMESPACE \
    --matchPool '["w8Nc2yWK", "i0vvrSzi", "JMEpEatP"]' \
    --endDate 'MBRDlP7b' \
    --startDate 'vQ7OUw6E' \
    > test.out 2>&1
eval_tap $? 28 'QueryTotalMatchmakingMatch' test.out

#- 29 QueryTotalPlayerPersession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalPlayerPersession \
    --namespace $AB_NAMESPACE \
    --matchPool '["yaoHJeuk", "ZcuglceV", "3zJ5Z3Uk"]' \
    --endDate 'UpeCK4Cs' \
    --startDate 'g2FYNP4e' \
    > test.out 2>&1
eval_tap $? 29 'QueryTotalPlayerPersession' test.out

#- 30 QueryTotalMatchmakingCanceled
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCanceled \
    --namespace $AB_NAMESPACE \
    --matchPool '["YPFfQD0S", "IGJg2ckN", "nOCOHxUq"]' \
    --endDate '1KnAMFKI' \
    --startDate 'BrDO3Fi6' \
    > test.out 2>&1
eval_tap $? 30 'QueryTotalMatchmakingCanceled' test.out

#- 31 QueryTotalMatchmakingCreated
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCreated \
    --namespace $AB_NAMESPACE \
    --matchPool '["fHcXdIuY", "NNsEeXQf", "G9GRMCxI"]' \
    --endDate 'mpBgNbJH' \
    --startDate 'bzsORdc3' \
    > test.out 2>&1
eval_tap $? 31 'QueryTotalMatchmakingCreated' test.out

#- 32 QueryTotalMatchmakingExpired
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingExpired \
    --namespace $AB_NAMESPACE \
    --matchPool '["SFNfjBKX", "EHdYe7Oo", "lQOv1Kca"]' \
    --endDate 'xOEAgTRy' \
    --startDate 'Uc3AbNBs' \
    > test.out 2>&1
eval_tap $? 32 'QueryTotalMatchmakingExpired' test.out

#- 33 QueryTotalMatchmakingMatchTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatchTicket \
    --namespace $AB_NAMESPACE \
    --matchPool '["MIKxA6yT", "91muwTsq", "PYkkvmjk"]' \
    --endDate 'vxG0Hys5' \
    --startDate 'j30e473P' \
    > test.out 2>&1
eval_tap $? 33 'QueryTotalMatchmakingMatchTicket' test.out

#- 34 CreateXrayTicketObservability
# body param: body
echo '{"action": "b2XQuPeJ", "activeAllianceRule": {"max_number": 21, "min_number": 74, "player_max_number": 31, "player_min_number": 15}, "activeMatchingRule": [{"attribute": "WsAwrTbA", "criteria": "w11bo1yv", "reference": 0.08972523705543001}, {"attribute": "1TuPg1Xf", "criteria": "rwh7VZp2", "reference": 0.15294671961987538}, {"attribute": "SE7eE9ZV", "criteria": "FrfUJe4w", "reference": 0.17128338135371513}], "function": "vZQPWmtq", "gameMode": "pOsoFw6W", "isBackfillMatch": true, "isRuleSetFlexed": true, "iteration": 80, "matchID": "eYd2HiKn", "namespace": "a8rf7hry", "remainingPlayersPerTicket": [84, 69, 89], "remainingTickets": 53, "sessionTickID": "IH5lkiwO", "tickID": 60, "ticketID": "hW1LLItR", "timeToMatchSec": 0.38996290370366826, "timestamp": "1974-06-23T00:00:00Z", "unbackfillReason": "oLJDh2KO", "unmatchReason": "6DNL2QnY"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 34 'CreateXrayTicketObservability' test.out

#- 35 CreateXrayBulkTicketObservability
# body param: body
echo '{"ticketObservabilities": [{"action": "91ntiJMb", "activeAllianceRule": {"max_number": 79, "min_number": 100, "player_max_number": 47, "player_min_number": 74}, "activeMatchingRule": [{"attribute": "58830V5g", "criteria": "9goIapZ0", "reference": 0.6927455754231382}, {"attribute": "ItrqKRcm", "criteria": "CtJ3Hht9", "reference": 0.7491146401444275}, {"attribute": "QJdjYJ1b", "criteria": "kHZzN47v", "reference": 0.036967464955585116}], "function": "0qXksvzT", "gameMode": "PmpWLlFu", "isBackfillMatch": true, "isRuleSetFlexed": false, "iteration": 50, "matchID": "MZZL6ZM1", "namespace": "0ECzopZR", "remainingPlayersPerTicket": [99, 42, 49], "remainingTickets": 9, "sessionTickID": "cg3Md6lj", "tickID": 10, "ticketID": "7C3KSfrv", "timeToMatchSec": 0.01656234360053843, "timestamp": "1974-07-24T00:00:00Z", "unbackfillReason": "mTnXjJgH", "unmatchReason": "WUPoUTyF"}, {"action": "4Ny40b3U", "activeAllianceRule": {"max_number": 21, "min_number": 16, "player_max_number": 53, "player_min_number": 60}, "activeMatchingRule": [{"attribute": "Go24o3vg", "criteria": "3YwImA9m", "reference": 0.728107888357677}, {"attribute": "EIxjio3J", "criteria": "5LYVP4om", "reference": 0.49956848430111056}, {"attribute": "CbvyM70T", "criteria": "2mOeJs31", "reference": 0.02976300140476762}], "function": "h9uuxcEg", "gameMode": "hiyelS2e", "isBackfillMatch": true, "isRuleSetFlexed": true, "iteration": 57, "matchID": "qjE2UtV3", "namespace": "qGduRKOE", "remainingPlayersPerTicket": [17, 87, 35], "remainingTickets": 33, "sessionTickID": "eiSBECM3", "tickID": 5, "ticketID": "40pHdAJj", "timeToMatchSec": 0.4554108615285898, "timestamp": "1977-11-03T00:00:00Z", "unbackfillReason": "E02kf71X", "unmatchReason": "4RzH9ZZ7"}, {"action": "gDbYk78D", "activeAllianceRule": {"max_number": 80, "min_number": 48, "player_max_number": 54, "player_min_number": 86}, "activeMatchingRule": [{"attribute": "GuP2b9l2", "criteria": "rifkER2W", "reference": 0.09570578514569006}, {"attribute": "KUfBGx2j", "criteria": "FnUxc696", "reference": 0.6064154952214303}, {"attribute": "liem0rh5", "criteria": "M2AZZMq3", "reference": 0.7244332262315946}], "function": "cXlH27Dw", "gameMode": "hse2Y2UN", "isBackfillMatch": false, "isRuleSetFlexed": true, "iteration": 17, "matchID": "YRC8MluR", "namespace": "X4q4n86u", "remainingPlayersPerTicket": [86, 54, 82], "remainingTickets": 40, "sessionTickID": "ZhiZdYdS", "tickID": 57, "ticketID": "Wi0MdSC6", "timeToMatchSec": 0.044504788881660984, "timestamp": "1978-09-03T00:00:00Z", "unbackfillReason": "xBCSIkHt", "unmatchReason": "isEbtMTS"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayBulkTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 35 'CreateXrayBulkTicketObservability' test.out

#- 36 QueryXrayTimelineByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'aquHmG1W' \
    --limit '52' \
    --offset '27' \
    --endDate 'siqvPqNM' \
    --startDate '87dklfWF' \
    > test.out 2>&1
eval_tap $? 36 'QueryXrayTimelineByTicketID' test.out

#- 37 QueryXrayTimelineByUserID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByUserID \
    --namespace $AB_NAMESPACE \
    --userId 'iYneb6Qq' \
    --limit '20' \
    --offset '22' \
    --endDate 'SZ1SlIBA' \
    --startDate 'vEXFvs2q' \
    > test.out 2>&1
eval_tap $? 37 'QueryXrayTimelineByUserID' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE