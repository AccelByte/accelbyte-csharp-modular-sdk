#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 GetHealthcheckInfoV1
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfoV1 \
    > test.out 2>&1
eval_tap $? 3 'GetHealthcheckInfoV1' test.out

#- 4 AdminGetEnvConfig
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetEnvConfig \
    > test.out 2>&1
eval_tap $? 4 'AdminGetEnvConfig' test.out

#- 5 AdminPatchUpdateEnvConfig
# body param: body
echo '{"SESSION_DELETION_GRACE_PERIOD": 82}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op AdminPatchUpdateEnvConfig \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'AdminPatchUpdateEnvConfig' test.out

#- 6 AdminGetLogConfig
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetLogConfig \
    > test.out 2>&1
eval_tap $? 6 'AdminGetLogConfig' test.out

#- 7 AdminPatchUpdateLogConfig
# body param: body
echo '{"logLevel": "fatal"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op AdminPatchUpdateLogConfig \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'AdminPatchUpdateLogConfig' test.out

#- 8 AdminQueryGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --completedOnly 'kCzDN70q' \
    --configurationName 'WnPAx0ci' \
    --dsPodName 'OJ9kNfst' \
    --endDate 'nRnrrDYJ' \
    --gameSessionID 'Eyl2aFQo' \
    --isPersistent 'L8kVhLxt' \
    --joinability 'HnJmJEwd' \
    --limit '74' \
    --matchPool 'TeeXxfnH' \
    --offset '93' \
    --order '9hdOmQ7S' \
    --orderBy 'iu0p2Gpk' \
    --startDate 'fd4kxs4l' \
    --statusV2 'dwxaeUne' \
    --userID 'fghiHMh6' \
    > test.out 2>&1
eval_tap $? 8 'AdminQueryGameSessionDetail' test.out

#- 9 GetGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --sessionId '33sFayo1' \
    > test.out 2>&1
eval_tap $? 9 'GetGameSessionDetail' test.out

#- 10 AdminQueryMatchmakingDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryMatchmakingDetail \
    --namespace $AB_NAMESPACE \
    --gameSessionID '8mD2ak7z' \
    --limit '42' \
    --offset '50' \
    --order '7br6C00e' \
    --orderBy 'UkeuRaUQ' \
    --ticketID 'QSrgUCUJ' \
    --userID 'L0fDAiJY' \
    > test.out 2>&1
eval_tap $? 10 'AdminQueryMatchmakingDetail' test.out

#- 11 AdminGetMatchmakingDetailBySessionID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailBySessionID \
    --namespace $AB_NAMESPACE \
    --sessionId 'LBMOu0kV' \
    > test.out 2>&1
eval_tap $? 11 'AdminGetMatchmakingDetailBySessionID' test.out

#- 12 AdminGetMatchmakingDetailByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'cIYkwi5z' \
    > test.out 2>&1
eval_tap $? 12 'AdminGetMatchmakingDetailByTicketID' test.out

#- 13 AdminQueryPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryPartyDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'WiRytwhH' \
    --joinability 'DChTi3JY' \
    --leaderID 'rpK0NW1l' \
    --limit '91' \
    --offset '74' \
    --order 'XgQMc6lG' \
    --orderBy 'wNID1IqR' \
    --partyID 'LruH34Ty' \
    --startDate 'ourHb6CQ' \
    --userID 'xh3jSnx9' \
    > test.out 2>&1
eval_tap $? 13 'AdminQueryPartyDetail' test.out

#- 14 GetPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetPartyDetail \
    --namespace $AB_NAMESPACE \
    --sessionId 'YU6GBDgy' \
    > test.out 2>&1
eval_tap $? 14 'GetPartyDetail' test.out

#- 15 AdminQueryTicketDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryTicketDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'GqpnqcMh' \
    --gameMode 'Q0f3zOhe' \
    --limit '2' \
    --offset '47' \
    --order 'ucjGvjCN' \
    --partyID 'oezVOnwy' \
    --region 'iHxsX6HC' \
    --startDate 'oIcRei7d' \
    --userIDs 'JtkdKC6B' \
    > test.out 2>&1
eval_tap $? 15 'AdminQueryTicketDetail' test.out

#- 16 AdminTicketDetailGetByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminTicketDetailGetByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'XhPoqB8f' \
    > test.out 2>&1
eval_tap $? 16 'AdminTicketDetailGetByTicketID' test.out

#- 17 PublicQueryGameSessionMe
$CLI_EXE \
    --sn sessionhistory \
    --op PublicQueryGameSessionMe \
    --namespace $AB_NAMESPACE \
    --limit '5' \
    --offset '85' \
    --order 'q35mmCi5' \
    > test.out 2>&1
eval_tap $? 17 'PublicQueryGameSessionMe' test.out

#- 18 QueryXrayMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatchPool \
    --namespace $AB_NAMESPACE \
    --poolName '["DpuFIyj4", "qFQ9XaXg", "cpQoX632"]' \
    --endDate 'LSw3BOGM' \
    --startDate 'TXItnviy' \
    > test.out 2>&1
eval_tap $? 18 'QueryXrayMatchPool' test.out

#- 19 QueryDetailTickMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPool \
    --namespace $AB_NAMESPACE \
    --podName 'kA2IFMJ9' \
    --poolName 'dO3acIYX' \
    --all 'true' \
    --limit '93' \
    --offset '96' \
    --endDate 'FM2HGzno' \
    --startDate 'DvIQTZDh' \
    > test.out 2>&1
eval_tap $? 19 'QueryDetailTickMatchPool' test.out

#- 20 QueryDetailTickMatchPoolMatches
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolMatches \
    --namespace $AB_NAMESPACE \
    --podName 'FuTwcInQ' \
    --poolName 'AzFiqUPJ' \
    --tickId 'I2ylS9Ax' \
    > test.out 2>&1
eval_tap $? 20 'QueryDetailTickMatchPoolMatches' test.out

#- 21 QueryDetailTickMatchPoolTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolTicket \
    --namespace $AB_NAMESPACE \
    --podName 'Xjl9Ke20' \
    --poolName 'AoprmMVF' \
    --tickId 'BAwlEmUa' \
    > test.out 2>&1
eval_tap $? 21 'QueryDetailTickMatchPoolTicket' test.out

#- 22 QueryMatchHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchHistories \
    --matchId '6KfXA8S0' \
    --namespace $AB_NAMESPACE \
    --limit '16' \
    --offset '79' \
    > test.out 2>&1
eval_tap $? 22 'QueryMatchHistories' test.out

#- 23 QueryMatchTicketHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchTicketHistories \
    --matchId 'CNgNP5SV' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'QueryMatchTicketHistories' test.out

#- 24 QueryXrayMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatch \
    --matchId 'zpNEbRuo' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 24 'QueryXrayMatch' test.out

#- 25 QueryAcquiringDS
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDS \
    --namespace $AB_NAMESPACE \
    --matchPool '["iWct2S0K", "vg1C9p22", "CJRDs1vd"]' \
    --endDate 'qEE3sRAO' \
    --startDate '2gJ8jO2z' \
    > test.out 2>&1
eval_tap $? 25 'QueryAcquiringDS' test.out

#- 26 QueryAcquiringDSWaitTimeAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDSWaitTimeAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["wr56WdQJ", "CH3yE9nB", "x1KH3tVp"]' \
    --endDate 'buqfs6fe' \
    --startDate 'Kovz34mQ' \
    > test.out 2>&1
eval_tap $? 26 'QueryAcquiringDSWaitTimeAvg' test.out

#- 27 QueryMatchLengthDurationpAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationpAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["5vQ6AOPO", "wjgYZu4H", "pv8pxarW"]' \
    --endDate 'Nl4SNx18' \
    --startDate '2FLxhHvL' \
    > test.out 2>&1
eval_tap $? 27 'QueryMatchLengthDurationpAvg' test.out

#- 28 QueryMatchLengthDurationp99
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationp99 \
    --namespace $AB_NAMESPACE \
    --matchPool '["s6F3vVWQ", "md65snUp", "VIq7uSnM"]' \
    --endDate 'Dcg6YbeL' \
    --startDate 'HXcq7Nqf' \
    > test.out 2>&1
eval_tap $? 28 'QueryMatchLengthDurationp99' test.out

#- 29 QueryTotalActiveSession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalActiveSession \
    --namespace $AB_NAMESPACE \
    --matchPool '["vTwYtVN4", "taOGeOiy", "W8Cb1RLK"]' \
    --region 'euURpCfU' \
    --endDate 'pzdL3Yan' \
    --startDate 'W4QnUB1W' \
    > test.out 2>&1
eval_tap $? 29 'QueryTotalActiveSession' test.out

#- 30 QueryTotalMatchmakingMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatch \
    --namespace $AB_NAMESPACE \
    --matchPool '["8xixanSW", "lFg0Zrct", "kqdggZbT"]' \
    --endDate 'BBfijmet' \
    --startDate 'O2zoYSv0' \
    > test.out 2>&1
eval_tap $? 30 'QueryTotalMatchmakingMatch' test.out

#- 31 QueryTotalPlayerPersession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalPlayerPersession \
    --namespace $AB_NAMESPACE \
    --matchPool '["Gatmmy55", "chCpo0lg", "mfe9Pkls"]' \
    --endDate 'Z0GIy664' \
    --startDate 'wryonDVk' \
    > test.out 2>&1
eval_tap $? 31 'QueryTotalPlayerPersession' test.out

#- 32 QueryTotalMatchmakingCanceled
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCanceled \
    --namespace $AB_NAMESPACE \
    --matchPool '["TXeyVlYc", "Ul39Uxps", "IFKFBtl6"]' \
    --endDate 'qXsbvOuG' \
    --startDate 'ER5hCHX9' \
    > test.out 2>&1
eval_tap $? 32 'QueryTotalMatchmakingCanceled' test.out

#- 33 QueryTotalMatchmakingCreated
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCreated \
    --namespace $AB_NAMESPACE \
    --matchPool '["GQ3sMrqe", "tWy8tqWE", "pKW4S34j"]' \
    --endDate 'opETaBrn' \
    --startDate 'lBSMZ5PH' \
    > test.out 2>&1
eval_tap $? 33 'QueryTotalMatchmakingCreated' test.out

#- 34 QueryTotalMatchmakingExpired
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingExpired \
    --namespace $AB_NAMESPACE \
    --matchPool '["uuPPvAiF", "pGlLRMoO", "twfDySmf"]' \
    --endDate 'HspoDvly' \
    --startDate 'trP1bVDt' \
    > test.out 2>&1
eval_tap $? 34 'QueryTotalMatchmakingExpired' test.out

#- 35 QueryTotalMatchmakingMatchTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatchTicket \
    --namespace $AB_NAMESPACE \
    --matchPool '["sw06oHbZ", "eCG5HrW7", "FFtQvdoe"]' \
    --endDate 'AOZzJedM' \
    --startDate 'nR3I30JY' \
    > test.out 2>&1
eval_tap $? 35 'QueryTotalMatchmakingMatchTicket' test.out

#- 36 CreateXrayTicketObservability
# body param: body
echo '{"action": "L7HMLadD", "activeAllianceRule": {"max_number": 50, "min_number": 9, "player_max_number": 80, "player_min_number": 10}, "activeMatchingRule": [{"attribute": "SJINLwFn", "criteria": "NmzXW1gl", "reference": 0.9159678987455823}, {"attribute": "FbCumNmb", "criteria": "zXkwlFfO", "reference": 0.10452867595180837}, {"attribute": "0KNt5RMq", "criteria": "Vi4E3NWp", "reference": 0.611853413995294}], "function": "sJ8Xr3fK", "gameMode": "GjQ2xhiK", "isBackfillMatch": true, "isRuleSetFlexed": true, "iteration": 47, "matchID": "nmSf1pMX", "namespace": "Xq2GYJb4", "remainingPlayersPerTicket": [50, 18, 21], "remainingTickets": 93, "sessionTickID": "3STdJJVe", "tickID": 94, "ticketID": "T079RIct", "timeToMatchSec": 0.34057286845936097, "timestamp": "1985-05-31T00:00:00Z", "unbackfillReason": "QilCwHLX", "unmatchReason": "v8ZaOJyk"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 36 'CreateXrayTicketObservability' test.out

#- 37 CreateXrayBulkTicketObservability
# body param: body
echo '{"ticketObservabilities": [{"action": "mLzcg7xa", "activeAllianceRule": {"max_number": 24, "min_number": 79, "player_max_number": 45, "player_min_number": 75}, "activeMatchingRule": [{"attribute": "6BdEC4hU", "criteria": "qlaUOgNo", "reference": 0.0003434657583063494}, {"attribute": "eyU7y71y", "criteria": "E0d6XFyi", "reference": 0.4660187362492464}, {"attribute": "2NrDkhjU", "criteria": "vJq04Zqx", "reference": 0.5083614658568729}], "function": "GQPeqH6z", "gameMode": "9eKBfvjS", "isBackfillMatch": true, "isRuleSetFlexed": false, "iteration": 75, "matchID": "RmoWIj2g", "namespace": "tHuciP4G", "remainingPlayersPerTicket": [71, 96, 86], "remainingTickets": 21, "sessionTickID": "HzdHqjv5", "tickID": 77, "ticketID": "f2NkAl3N", "timeToMatchSec": 0.32002957071581983, "timestamp": "1998-05-30T00:00:00Z", "unbackfillReason": "VHjmc4QM", "unmatchReason": "0P1AA8sm"}, {"action": "B6X9zpkj", "activeAllianceRule": {"max_number": 53, "min_number": 18, "player_max_number": 51, "player_min_number": 35}, "activeMatchingRule": [{"attribute": "uTGrgLh6", "criteria": "TBv3RRoJ", "reference": 0.30957152326786663}, {"attribute": "DwFXCCXA", "criteria": "yJqZNd9T", "reference": 0.444696196236235}, {"attribute": "MeNxbLQP", "criteria": "pG1xtT0J", "reference": 0.618059345116293}], "function": "RrMfe6a0", "gameMode": "bhfyceWl", "isBackfillMatch": true, "isRuleSetFlexed": false, "iteration": 7, "matchID": "zSjE7B2G", "namespace": "RRbHagEx", "remainingPlayersPerTicket": [92, 82, 31], "remainingTickets": 43, "sessionTickID": "FVqk7e2l", "tickID": 82, "ticketID": "5CUdUg60", "timeToMatchSec": 0.9546501147508005, "timestamp": "1974-01-25T00:00:00Z", "unbackfillReason": "5El1yV0S", "unmatchReason": "f4exGZpa"}, {"action": "4RGMujxj", "activeAllianceRule": {"max_number": 18, "min_number": 94, "player_max_number": 27, "player_min_number": 16}, "activeMatchingRule": [{"attribute": "8PzGCs67", "criteria": "NUA2hO3s", "reference": 0.8654400001550999}, {"attribute": "h6Uu9P0b", "criteria": "syay7fu1", "reference": 0.7112784946126267}, {"attribute": "bkFVRwGS", "criteria": "C44JnRQP", "reference": 0.5789157737701377}], "function": "B9AubLeo", "gameMode": "uD0flbvX", "isBackfillMatch": false, "isRuleSetFlexed": false, "iteration": 51, "matchID": "Xby4aAD8", "namespace": "92Jtr6ro", "remainingPlayersPerTicket": [97, 23, 57], "remainingTickets": 7, "sessionTickID": "aMcjwF0Q", "tickID": 55, "ticketID": "1p6LTLaI", "timeToMatchSec": 0.5786594018064752, "timestamp": "1999-03-20T00:00:00Z", "unbackfillReason": "iNA8e40T", "unmatchReason": "kmnMpgdv"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayBulkTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 37 'CreateXrayBulkTicketObservability' test.out

#- 38 QueryXrayTimelineByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'aBchmmrn' \
    --limit '71' \
    --offset '37' \
    --endDate '6V6Uq2Xu' \
    --startDate 'UCFHt99G' \
    > test.out 2>&1
eval_tap $? 38 'QueryXrayTimelineByTicketID' test.out

#- 39 QueryXrayTimelineByUserID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByUserID \
    --namespace $AB_NAMESPACE \
    --userId 'C5vJKEJY' \
    --limit '24' \
    --offset '45' \
    --order '5JMtGbzl' \
    --orderBy 'HxQgfeDy' \
    --endDate 'G5bm0kSX' \
    --startDate '1IHdj9N7' \
    > test.out 2>&1
eval_tap $? 39 'QueryXrayTimelineByUserID' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE