#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 GetHealthcheckInfoV1
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfoV1 \
    > test.out 2>&1
eval_tap $? 3 'GetHealthcheckInfoV1' test.out

#- 4 AdminGetEnvConfig
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetEnvConfig \
    > test.out 2>&1
eval_tap $? 4 'AdminGetEnvConfig' test.out

#- 5 AdminPatchUpdateEnvConfig
# body param: body
echo '{"SESSION_DELETION_GRACE_PERIOD": 68}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op AdminPatchUpdateEnvConfig \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'AdminPatchUpdateEnvConfig' test.out

#- 6 AdminGetLogConfig
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetLogConfig \
    > test.out 2>&1
eval_tap $? 6 'AdminGetLogConfig' test.out

#- 7 AdminPatchUpdateLogConfig
# body param: body
echo '{"logLevel": "error"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op AdminPatchUpdateLogConfig \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'AdminPatchUpdateLogConfig' test.out

#- 8 AdminQueryGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --completedOnly 'sFp1Uc18' \
    --configurationName '1bIYAFEP' \
    --dsPodName 'jBYjp1d9' \
    --endDate 'g4VETINN' \
    --gameSessionID 'LU4eYHiK' \
    --isPersistent 'TemiXQpa' \
    --joinability 'oRnbGr9b' \
    --limit '80' \
    --matchPool 'IToKhiWz' \
    --offset '34' \
    --order 'drN0e6Mz' \
    --orderBy 'C6cFvrmh' \
    --startDate 'jGq3SZ9Q' \
    --statusV2 'r5IXBLad' \
    --userID 'pMepFDCb' \
    > test.out 2>&1
eval_tap $? 8 'AdminQueryGameSessionDetail' test.out

#- 9 GetGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --sessionId '9Ftrc3Ww' \
    > test.out 2>&1
eval_tap $? 9 'GetGameSessionDetail' test.out

#- 10 AdminQueryMatchmakingDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryMatchmakingDetail \
    --namespace $AB_NAMESPACE \
    --gameSessionID 'Jt4VXVp4' \
    --limit '74' \
    --offset '0' \
    --order 'aLIwazz8' \
    --orderBy '8Rv24cZz' \
    --ticketID 'DAxv3O21' \
    --userID 'Lki3L7ug' \
    > test.out 2>&1
eval_tap $? 10 'AdminQueryMatchmakingDetail' test.out

#- 11 AdminGetMatchmakingDetailBySessionID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailBySessionID \
    --namespace $AB_NAMESPACE \
    --sessionId 'qRFqncyn' \
    > test.out 2>&1
eval_tap $? 11 'AdminGetMatchmakingDetailBySessionID' test.out

#- 12 AdminGetMatchmakingDetailByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'ZCBqArtt' \
    > test.out 2>&1
eval_tap $? 12 'AdminGetMatchmakingDetailByTicketID' test.out

#- 13 AdminQueryPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryPartyDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'duWtJIaj' \
    --joinability 'ziKMkbp5' \
    --leaderID 'IEgujTD0' \
    --limit '58' \
    --offset '10' \
    --order 'R5T63dig' \
    --orderBy 'LPYSN7eF' \
    --partyID 'm2YSbBCV' \
    --startDate 'cKLM2arq' \
    --userID '0mrypp0M' \
    > test.out 2>&1
eval_tap $? 13 'AdminQueryPartyDetail' test.out

#- 14 GetPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetPartyDetail \
    --namespace $AB_NAMESPACE \
    --sessionId 'ovIGSqvW' \
    > test.out 2>&1
eval_tap $? 14 'GetPartyDetail' test.out

#- 15 AdminQueryTicketDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryTicketDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'D7X19nxz' \
    --gameMode 'dorpGvAC' \
    --limit '66' \
    --offset '89' \
    --order '7D7U82ek' \
    --partyID 'ZNrcOsNO' \
    --region 'WRMcBR0n' \
    --startDate 'JSEx6lEH' \
    --userIDs 'fIgGU1at' \
    > test.out 2>&1
eval_tap $? 15 'AdminQueryTicketDetail' test.out

#- 16 AdminTicketDetailGetByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminTicketDetailGetByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'SWaxEPim' \
    > test.out 2>&1
eval_tap $? 16 'AdminTicketDetailGetByTicketID' test.out

#- 17 PublicQueryGameSessionMe
$CLI_EXE \
    --sn sessionhistory \
    --op PublicQueryGameSessionMe \
    --namespace $AB_NAMESPACE \
    --limit '86' \
    --offset '61' \
    --order 'sJTj1afu' \
    > test.out 2>&1
eval_tap $? 17 'PublicQueryGameSessionMe' test.out

#- 18 QueryXrayMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatchPool \
    --namespace $AB_NAMESPACE \
    --poolName '["eEUdhZiR", "KKbEM24x", "u1Sbglvu"]' \
    --endDate '0PER57mh' \
    --startDate 'bOm3CnfR' \
    > test.out 2>&1
eval_tap $? 18 'QueryXrayMatchPool' test.out

#- 19 QueryDetailTickMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPool \
    --namespace $AB_NAMESPACE \
    --podName '92MOtUr7' \
    --poolName 'iis3KOzS' \
    --all 'false' \
    --limit '44' \
    --offset '66' \
    --endDate 'XcRgjoZv' \
    --startDate '6ZJzpkym' \
    > test.out 2>&1
eval_tap $? 19 'QueryDetailTickMatchPool' test.out

#- 20 QueryDetailTickMatchPoolMatches
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolMatches \
    --namespace $AB_NAMESPACE \
    --podName 'w0b6UwjA' \
    --poolName 'TBMkeVvT' \
    --tickId 'ps2U6dEG' \
    > test.out 2>&1
eval_tap $? 20 'QueryDetailTickMatchPoolMatches' test.out

#- 21 QueryDetailTickMatchPoolTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolTicket \
    --namespace $AB_NAMESPACE \
    --podName 'NtI9eDMy' \
    --poolName 'VawHL2DM' \
    --tickId '4OL2qduT' \
    > test.out 2>&1
eval_tap $? 21 'QueryDetailTickMatchPoolTicket' test.out

#- 22 QueryMatchHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchHistories \
    --matchId 'zMnh9fy7' \
    --namespace $AB_NAMESPACE \
    --limit '62' \
    --offset '28' \
    > test.out 2>&1
eval_tap $? 22 'QueryMatchHistories' test.out

#- 23 QueryMatchTicketHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchTicketHistories \
    --matchId 'roLC2JuM' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'QueryMatchTicketHistories' test.out

#- 24 QueryXrayMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatch \
    --matchId 'su4XlCtI' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 24 'QueryXrayMatch' test.out

#- 25 QueryAcquiringDS
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDS \
    --namespace $AB_NAMESPACE \
    --matchPool '["ut32TpY2", "KpI2VC1y", "sLa440K6"]' \
    --endDate 'KI4BZHnY' \
    --startDate 'xTcNcYqR' \
    > test.out 2>&1
eval_tap $? 25 'QueryAcquiringDS' test.out

#- 26 QueryAcquiringDSWaitTimeAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDSWaitTimeAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["h1g5Szkm", "SDpCw82D", "kCYktzKL"]' \
    --endDate 'sjIjWkch' \
    --startDate 'Nr70vs6W' \
    > test.out 2>&1
eval_tap $? 26 'QueryAcquiringDSWaitTimeAvg' test.out

#- 27 QueryMatchLengthDurationpAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationpAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["s4zsi9ET", "YT6XHfRA", "HWM0MEjv"]' \
    --endDate '2tO6yg2C' \
    --startDate 'zuoez2de' \
    > test.out 2>&1
eval_tap $? 27 'QueryMatchLengthDurationpAvg' test.out

#- 28 QueryMatchLengthDurationp99
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationp99 \
    --namespace $AB_NAMESPACE \
    --matchPool '["9VKqyM1o", "gYFoY7Xc", "XWrXbVx7"]' \
    --endDate 'p4lSxVTs' \
    --startDate 'ScjGMmHT' \
    > test.out 2>&1
eval_tap $? 28 'QueryMatchLengthDurationp99' test.out

#- 29 QueryTotalActiveSession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalActiveSession \
    --namespace $AB_NAMESPACE \
    --matchPool '["urmB6R0l", "ZYrEoeMa", "oKzdrtZm"]' \
    --region '5RHsjBU4' \
    --endDate 'tEC80P9R' \
    --startDate 'FtLxH9zt' \
    > test.out 2>&1
eval_tap $? 29 'QueryTotalActiveSession' test.out

#- 30 QueryTotalMatchmakingMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatch \
    --namespace $AB_NAMESPACE \
    --matchPool '["Pgf4UnO1", "6deaCtjF", "kb849sQq"]' \
    --endDate 'JHvjzWRO' \
    --startDate '1AkvQIkS' \
    > test.out 2>&1
eval_tap $? 30 'QueryTotalMatchmakingMatch' test.out

#- 31 QueryTotalPlayerPersession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalPlayerPersession \
    --namespace $AB_NAMESPACE \
    --matchPool '["AwpIX28t", "mht8pynE", "xJXlCvWW"]' \
    --endDate 's6zmf7JL' \
    --startDate 'HfqNkCtD' \
    > test.out 2>&1
eval_tap $? 31 'QueryTotalPlayerPersession' test.out

#- 32 QueryTotalMatchmakingCanceled
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCanceled \
    --namespace $AB_NAMESPACE \
    --matchPool '["0sQLA50o", "jzpgdTVP", "4phanpNR"]' \
    --endDate 'h2H4stys' \
    --startDate '5l56h9r0' \
    > test.out 2>&1
eval_tap $? 32 'QueryTotalMatchmakingCanceled' test.out

#- 33 QueryTotalMatchmakingCreated
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCreated \
    --namespace $AB_NAMESPACE \
    --matchPool '["UcsVa5TE", "6zeycrfd", "GsYWhaE7"]' \
    --endDate 'FuKhUFit' \
    --startDate 'd8YKVZ3B' \
    > test.out 2>&1
eval_tap $? 33 'QueryTotalMatchmakingCreated' test.out

#- 34 QueryTotalMatchmakingExpired
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingExpired \
    --namespace $AB_NAMESPACE \
    --matchPool '["NWXahyKf", "oOIQ34xm", "zMikJknU"]' \
    --endDate 'EpHN1H0O' \
    --startDate 'iyldl624' \
    > test.out 2>&1
eval_tap $? 34 'QueryTotalMatchmakingExpired' test.out

#- 35 QueryTotalMatchmakingMatchTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatchTicket \
    --namespace $AB_NAMESPACE \
    --matchPool '["qlTMJKsc", "m7UgGzoZ", "Rpfu4dfI"]' \
    --endDate 'gLTvD3ob' \
    --startDate '1B30ns2C' \
    > test.out 2>&1
eval_tap $? 35 'QueryTotalMatchmakingMatchTicket' test.out

#- 36 CreateXrayTicketObservability
# body param: body
echo '{"action": "mmFthmYS", "activeAllianceRule": {"max_number": 98, "min_number": 19, "player_max_number": 49, "player_min_number": 67}, "activeMatchingRule": [{"attribute": "XrLC2qwK", "criteria": "B7ErOdSi", "reference": 0.9462849069040853}, {"attribute": "CpMhs8zN", "criteria": "fm1HSTn6", "reference": 0.6991112388013474}, {"attribute": "khcfIkrn", "criteria": "y9NkmaS0", "reference": 0.4518651051448853}], "function": "UU2PjVgZ", "gameMode": "hQRRcAmV", "isBackfillMatch": true, "isRuleSetFlexed": true, "iteration": 86, "matchID": "BRVkHM6U", "namespace": "UscuSQzL", "remainingPlayersPerTicket": [72, 60, 18], "remainingTickets": 24, "sessionTickID": "QhnHE0T4", "tickID": 18, "ticketID": "CNyivGTq", "timeToMatchSec": 0.30368999465124613, "timestamp": "1976-03-21T00:00:00Z", "unbackfillReason": "72H39HSg", "unmatchReason": "P5Qc9End"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 36 'CreateXrayTicketObservability' test.out

#- 37 CreateXrayBulkTicketObservability
# body param: body
echo '{"ticketObservabilities": [{"action": "ftJ0pIua", "activeAllianceRule": {"max_number": 4, "min_number": 10, "player_max_number": 2, "player_min_number": 91}, "activeMatchingRule": [{"attribute": "c7YjJAjD", "criteria": "9VAIyc1A", "reference": 0.6004997789041371}, {"attribute": "B4j1ANps", "criteria": "9U9O9zTF", "reference": 0.8080820148725497}, {"attribute": "G15r7MkA", "criteria": "otZ2S99j", "reference": 0.29875148134580076}], "function": "TYKJbjh1", "gameMode": "lQJfzcBL", "isBackfillMatch": false, "isRuleSetFlexed": false, "iteration": 92, "matchID": "6WluVpiZ", "namespace": "I3m3vlvw", "remainingPlayersPerTicket": [11, 20, 48], "remainingTickets": 41, "sessionTickID": "hWDQilpD", "tickID": 4, "ticketID": "LH0aoE5f", "timeToMatchSec": 0.34031924859400475, "timestamp": "1980-03-19T00:00:00Z", "unbackfillReason": "8cpaaPM7", "unmatchReason": "s2BVQs8Y"}, {"action": "zntMGovG", "activeAllianceRule": {"max_number": 58, "min_number": 96, "player_max_number": 85, "player_min_number": 66}, "activeMatchingRule": [{"attribute": "YGMdw8Vy", "criteria": "Otg1BHlT", "reference": 0.10007745602287199}, {"attribute": "y2rTkC7X", "criteria": "4pV6NMCA", "reference": 0.5826224888004119}, {"attribute": "tVXAauyl", "criteria": "JjBtetJk", "reference": 0.6872968199722026}], "function": "H1VY5FVb", "gameMode": "0nsovYZF", "isBackfillMatch": false, "isRuleSetFlexed": true, "iteration": 47, "matchID": "8oaaxRaX", "namespace": "Fzhs04Kp", "remainingPlayersPerTicket": [10, 88, 94], "remainingTickets": 69, "sessionTickID": "JJXtjG6x", "tickID": 99, "ticketID": "jEsn4k9J", "timeToMatchSec": 0.8511855562232231, "timestamp": "1978-04-04T00:00:00Z", "unbackfillReason": "hCOwX4Wc", "unmatchReason": "vE90FP6m"}, {"action": "FuotxiOT", "activeAllianceRule": {"max_number": 70, "min_number": 33, "player_max_number": 60, "player_min_number": 24}, "activeMatchingRule": [{"attribute": "dRz15e96", "criteria": "Fwv1YxZb", "reference": 0.30448660911848835}, {"attribute": "l6K9PcEr", "criteria": "o7pGtIq7", "reference": 0.7265600397019784}, {"attribute": "88mq07oc", "criteria": "bqcidf7p", "reference": 0.7698503826213657}], "function": "moU5GuA8", "gameMode": "2ZeqyHaT", "isBackfillMatch": true, "isRuleSetFlexed": false, "iteration": 20, "matchID": "jjXBbccT", "namespace": "Q3SkCmbk", "remainingPlayersPerTicket": [7, 0, 10], "remainingTickets": 32, "sessionTickID": "W07ViPxW", "tickID": 90, "ticketID": "Ngauxllp", "timeToMatchSec": 0.5458287134008668, "timestamp": "1988-12-02T00:00:00Z", "unbackfillReason": "dVXgsVri", "unmatchReason": "E4kDCCWG"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayBulkTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 37 'CreateXrayBulkTicketObservability' test.out

#- 38 QueryXrayTimelineByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'Nx5G3aGW' \
    --limit '96' \
    --offset '10' \
    --endDate 'D3S8stKU' \
    --startDate 'T4xOvJ7i' \
    > test.out 2>&1
eval_tap $? 38 'QueryXrayTimelineByTicketID' test.out

#- 39 QueryXrayTimelineByUserID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByUserID \
    --namespace $AB_NAMESPACE \
    --userId '4IYyF7Ei' \
    --limit '14' \
    --offset '30' \
    --order 'quuX99oW' \
    --orderBy 'MjEZrZRl' \
    --endDate '5pzhVVRS' \
    --startDate 'BprKzOFO' \
    > test.out 2>&1
eval_tap $? 39 'QueryXrayTimelineByUserID' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE