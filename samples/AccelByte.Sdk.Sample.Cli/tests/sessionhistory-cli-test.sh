#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..37"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 GetHealthcheckInfoV1
$CLI_EXE \
    --sn sessionhistory \
    --op GetHealthcheckInfoV1 \
    > test.out 2>&1
eval_tap $? 3 'GetHealthcheckInfoV1' test.out

#- 4 AdminGetLogConfig
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetLogConfig \
    > test.out 2>&1
eval_tap $? 4 'AdminGetLogConfig' test.out

#- 5 AdminPatchUpdateLogConfig
# body param: body
echo '{"logLevel": "debug"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op AdminPatchUpdateLogConfig \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'AdminPatchUpdateLogConfig' test.out

#- 6 AdminQueryGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --endDate 'YfS6c2lC' \
    --gameSessionID 'xfnl2JGz' \
    --limit '59' \
    --offset '81' \
    --order 'ptY3mMre' \
    --orderBy 'kjB4ksyn' \
    --startDate '2tje4bwG' \
    --userID 'qX7eoIBo' \
    > test.out 2>&1
eval_tap $? 6 'AdminQueryGameSessionDetail' test.out

#- 7 GetGameSessionDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetGameSessionDetail \
    --namespace $AB_NAMESPACE \
    --sessionId '1RqB9iJ2' \
    > test.out 2>&1
eval_tap $? 7 'GetGameSessionDetail' test.out

#- 8 AdminQueryMatchmakingDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryMatchmakingDetail \
    --namespace $AB_NAMESPACE \
    --gameSessionID '05hR2fdI' \
    --limit '26' \
    --offset '37' \
    --order 'e4Tj0KUJ' \
    --orderBy 'tPo6Fm7e' \
    --ticketID 'lK0HEpYi' \
    --userID 'bJUS1Le7' \
    > test.out 2>&1
eval_tap $? 8 'AdminQueryMatchmakingDetail' test.out

#- 9 AdminGetMatchmakingDetailBySessionID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailBySessionID \
    --namespace $AB_NAMESPACE \
    --sessionId 'JayDiy63' \
    > test.out 2>&1
eval_tap $? 9 'AdminGetMatchmakingDetailBySessionID' test.out

#- 10 AdminGetMatchmakingDetailByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminGetMatchmakingDetailByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'uEYv8A1n' \
    > test.out 2>&1
eval_tap $? 10 'AdminGetMatchmakingDetailByTicketID' test.out

#- 11 AdminQueryPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryPartyDetail \
    --namespace $AB_NAMESPACE \
    --limit '95' \
    --offset '79' \
    --order 'd2LGEDbX' \
    --orderBy 'IVnq8MEb' \
    --partyID 'wvmHVf42' \
    --userID 'PsLD7A0L' \
    > test.out 2>&1
eval_tap $? 11 'AdminQueryPartyDetail' test.out

#- 12 GetPartyDetail
$CLI_EXE \
    --sn sessionhistory \
    --op GetPartyDetail \
    --namespace $AB_NAMESPACE \
    --sessionId 'f7oKFVN4' \
    > test.out 2>&1
eval_tap $? 12 'GetPartyDetail' test.out

#- 13 AdminQueryTicketDetail
$CLI_EXE \
    --sn sessionhistory \
    --op AdminQueryTicketDetail \
    --namespace $AB_NAMESPACE \
    --endDate '7DK2Loiw' \
    --gameMode 'cdFX8BAk' \
    --limit '29' \
    --offset '42' \
    --order 'BqNzD27I' \
    --partyID '5XUtIOT6' \
    --region 'CnYwJ1sq' \
    --startDate 'tcOe4z6x' \
    --userIDs 'sLqQsRAi' \
    > test.out 2>&1
eval_tap $? 13 'AdminQueryTicketDetail' test.out

#- 14 AdminTicketDetailGetByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op AdminTicketDetailGetByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'T0VyvMVQ' \
    > test.out 2>&1
eval_tap $? 14 'AdminTicketDetailGetByTicketID' test.out

#- 15 PublicQueryGameSessionMe
$CLI_EXE \
    --sn sessionhistory \
    --op PublicQueryGameSessionMe \
    --namespace $AB_NAMESPACE \
    --limit '27' \
    --offset '90' \
    --order 'nmjxKh91' \
    > test.out 2>&1
eval_tap $? 15 'PublicQueryGameSessionMe' test.out

#- 16 QueryXrayMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatchPool \
    --namespace $AB_NAMESPACE \
    --poolName '["IzOZ3y3Z", "n4Dt4RqF", "sXP4JkmW"]' \
    --endDate 'EYS46Dlx' \
    --startDate 'jOjiDHq4' \
    > test.out 2>&1
eval_tap $? 16 'QueryXrayMatchPool' test.out

#- 17 QueryDetailTickMatchPool
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPool \
    --namespace $AB_NAMESPACE \
    --podName 'aPzX7u2T' \
    --poolName 'HGLLcgNz' \
    --all 'true' \
    --limit '33' \
    --offset '72' \
    --endDate 'l8b2Qnix' \
    --startDate '2diPmon2' \
    > test.out 2>&1
eval_tap $? 17 'QueryDetailTickMatchPool' test.out

#- 18 QueryDetailTickMatchPoolMatches
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolMatches \
    --namespace $AB_NAMESPACE \
    --podName 'uDEC0W8j' \
    --poolName 'M0uMcsh8' \
    --tickId 'FE9gM5SX' \
    > test.out 2>&1
eval_tap $? 18 'QueryDetailTickMatchPoolMatches' test.out

#- 19 QueryDetailTickMatchPoolTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryDetailTickMatchPoolTicket \
    --namespace $AB_NAMESPACE \
    --podName 'Zykbim68' \
    --poolName '0hxGKccw' \
    --tickId 'FnL0WOrs' \
    > test.out 2>&1
eval_tap $? 19 'QueryDetailTickMatchPoolTicket' test.out

#- 20 QueryMatchHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchHistories \
    --matchId 'HeHLbZWj' \
    --namespace $AB_NAMESPACE \
    --limit '5' \
    --offset '95' \
    > test.out 2>&1
eval_tap $? 20 'QueryMatchHistories' test.out

#- 21 QueryMatchTicketHistories
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchTicketHistories \
    --matchId 'ndpfphOe' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'QueryMatchTicketHistories' test.out

#- 22 QueryXrayMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayMatch \
    --matchId '33HkUuep' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'QueryXrayMatch' test.out

#- 23 QueryAcquiringDS
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDS \
    --namespace $AB_NAMESPACE \
    --matchPool '["NCtRpDX1", "zloBoIos", "qlMFpJQ9"]' \
    --endDate 'I5c0AITU' \
    --startDate 'YCJblXaZ' \
    > test.out 2>&1
eval_tap $? 23 'QueryAcquiringDS' test.out

#- 24 QueryAcquiringDSWaitTimeAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryAcquiringDSWaitTimeAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["1Nr44xSe", "9f0speM2", "12ItZhUp"]' \
    --endDate 'RZw3856S' \
    --startDate 'V6g2tcmq' \
    > test.out 2>&1
eval_tap $? 24 'QueryAcquiringDSWaitTimeAvg' test.out

#- 25 QueryMatchLengthDurationpAvg
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationpAvg \
    --namespace $AB_NAMESPACE \
    --matchPool '["VJeCfOIV", "FF9bblj2", "qBgmxcYJ"]' \
    --endDate 'QLreZmj0' \
    --startDate 'FcZjmBrD' \
    > test.out 2>&1
eval_tap $? 25 'QueryMatchLengthDurationpAvg' test.out

#- 26 QueryMatchLengthDurationp99
$CLI_EXE \
    --sn sessionhistory \
    --op QueryMatchLengthDurationp99 \
    --namespace $AB_NAMESPACE \
    --matchPool '["7TfxQKaD", "lVZNpesE", "XpunJFXB"]' \
    --endDate 'wJBg9U32' \
    --startDate 'BU9B3pQO' \
    > test.out 2>&1
eval_tap $? 26 'QueryMatchLengthDurationp99' test.out

#- 27 QueryTotalActiveSession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalActiveSession \
    --namespace $AB_NAMESPACE \
    --matchPool '["Mx8BObZb", "KAiB3eQu", "gOrNQaZG"]' \
    --region 'HEZuHGO6' \
    --endDate 'MfstYpsE' \
    --startDate 'vcBcnsVe' \
    > test.out 2>&1
eval_tap $? 27 'QueryTotalActiveSession' test.out

#- 28 QueryTotalMatchmakingMatch
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatch \
    --namespace $AB_NAMESPACE \
    --matchPool '["XRu8RW5t", "56aHQvxq", "YvrUfpds"]' \
    --endDate 'y3ZAskTL' \
    --startDate 'ZxLL92Yn' \
    > test.out 2>&1
eval_tap $? 28 'QueryTotalMatchmakingMatch' test.out

#- 29 QueryTotalPlayerPersession
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalPlayerPersession \
    --namespace $AB_NAMESPACE \
    --matchPool '["I0gTNc4Q", "QBvqmXZ9", "9F3Szitv"]' \
    --endDate 'rlRLmp5J' \
    --startDate 'FwEtMJXs' \
    > test.out 2>&1
eval_tap $? 29 'QueryTotalPlayerPersession' test.out

#- 30 QueryTotalMatchmakingCanceled
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCanceled \
    --namespace $AB_NAMESPACE \
    --matchPool '["XVCAqjLl", "RnD0dGSS", "WtIMNSPn"]' \
    --endDate 'OqC9u2PR' \
    --startDate '5Huwlj6J' \
    > test.out 2>&1
eval_tap $? 30 'QueryTotalMatchmakingCanceled' test.out

#- 31 QueryTotalMatchmakingCreated
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingCreated \
    --namespace $AB_NAMESPACE \
    --matchPool '["1U8ID3O2", "fbLD8lI8", "NVmyS9yl"]' \
    --endDate 'v1K2nUT8' \
    --startDate 'r0rYf613' \
    > test.out 2>&1
eval_tap $? 31 'QueryTotalMatchmakingCreated' test.out

#- 32 QueryTotalMatchmakingExpired
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingExpired \
    --namespace $AB_NAMESPACE \
    --matchPool '["x1h2AjsK", "QUgUaByH", "zX49GwHD"]' \
    --endDate 'KNArYlGf' \
    --startDate 'GdXxuCY0' \
    > test.out 2>&1
eval_tap $? 32 'QueryTotalMatchmakingExpired' test.out

#- 33 QueryTotalMatchmakingMatchTicket
$CLI_EXE \
    --sn sessionhistory \
    --op QueryTotalMatchmakingMatchTicket \
    --namespace $AB_NAMESPACE \
    --matchPool '["3Uttu7lU", "OGUG21J1", "XDUjvjOp"]' \
    --endDate 'xAcvl9oz' \
    --startDate 'TxaCKyYd' \
    > test.out 2>&1
eval_tap $? 33 'QueryTotalMatchmakingMatchTicket' test.out

#- 34 CreateXrayTicketObservability
# body param: body
echo '{"action": "nEiYlpYi", "activeAllianceRule": {"max_number": 22, "min_number": 4, "player_max_number": 47, "player_min_number": 57}, "activeMatchingRule": [{"attribute": "6U4Qdg7R", "criteria": "5pNkXG3t", "reference": 0.3396047498982676}, {"attribute": "EEuqTgjq", "criteria": "3jct2sQS", "reference": 0.0458251596603062}, {"attribute": "n12lP7Ih", "criteria": "Dstk5N4b", "reference": 0.6996819541152938}], "function": "SXvnUpyE", "gameMode": "4Y1raC7i", "isBackfillMatch": false, "isRuleSetFlexed": true, "iteration": 98, "matchID": "od9VCokb", "namespace": "NMFfMIFo", "remainingPlayersPerTicket": [20, 65, 51], "remainingTickets": 9, "sessionTickID": "qTCXMDJg", "tickID": 33, "ticketID": "cwxM9sA1", "timeToMatchSec": 0.14762294908128937, "timestamp": "1977-03-27T00:00:00Z", "unbackfillReason": "oGFIB9F0", "unmatchReason": "YRRR3S4d"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 34 'CreateXrayTicketObservability' test.out

#- 35 CreateXrayBulkTicketObservability
# body param: body
echo '{"ticketObservabilities": [{"action": "6yqt2yXE", "activeAllianceRule": {"max_number": 46, "min_number": 46, "player_max_number": 96, "player_min_number": 34}, "activeMatchingRule": [{"attribute": "ged8XWrt", "criteria": "yM0h85jE", "reference": 0.7958459123162109}, {"attribute": "PZWm2Nmg", "criteria": "1EOmNuOA", "reference": 0.36739670314323003}, {"attribute": "uVR0ngMF", "criteria": "pabRn1HF", "reference": 0.7049908134372032}], "function": "KJgWRsFP", "gameMode": "FgtjKd9v", "isBackfillMatch": true, "isRuleSetFlexed": true, "iteration": 59, "matchID": "kv7TXiBc", "namespace": "spa4rcYp", "remainingPlayersPerTicket": [28, 69, 89], "remainingTickets": 47, "sessionTickID": "HyX4cDxi", "tickID": 62, "ticketID": "l7XduYL0", "timeToMatchSec": 0.4480292538354851, "timestamp": "1998-07-24T00:00:00Z", "unbackfillReason": "uequvjG7", "unmatchReason": "4uYWMB2E"}, {"action": "FWzs1U96", "activeAllianceRule": {"max_number": 8, "min_number": 40, "player_max_number": 78, "player_min_number": 10}, "activeMatchingRule": [{"attribute": "ofnXDQyA", "criteria": "tANkMuj0", "reference": 0.0906455274704272}, {"attribute": "ejEAEq5V", "criteria": "D8sK7muZ", "reference": 0.4598174576770375}, {"attribute": "PDnM0OPj", "criteria": "cAlKbpld", "reference": 0.839369200044919}], "function": "Ie8W6SN8", "gameMode": "dmZNmWqh", "isBackfillMatch": false, "isRuleSetFlexed": false, "iteration": 5, "matchID": "upbLWR7c", "namespace": "1hcCe2cA", "remainingPlayersPerTicket": [14, 97, 79], "remainingTickets": 99, "sessionTickID": "ifA8fXJQ", "tickID": 27, "ticketID": "ZeE2DB2b", "timeToMatchSec": 0.9370372895270288, "timestamp": "1974-12-23T00:00:00Z", "unbackfillReason": "mxaONrdw", "unmatchReason": "qOsdwXKP"}, {"action": "xto44mb5", "activeAllianceRule": {"max_number": 74, "min_number": 100, "player_max_number": 18, "player_min_number": 41}, "activeMatchingRule": [{"attribute": "VZYAfAeA", "criteria": "6B6Yce99", "reference": 0.8557769081530928}, {"attribute": "Eh1XEk25", "criteria": "oYmsgWXW", "reference": 0.07681051679452999}, {"attribute": "A5T4OmCN", "criteria": "bjADsAnI", "reference": 0.4227784968323389}], "function": "hvkfptFX", "gameMode": "Yvakvbrr", "isBackfillMatch": true, "isRuleSetFlexed": true, "iteration": 32, "matchID": "0SECoZVk", "namespace": "HSmQoJwF", "remainingPlayersPerTicket": [96, 5, 94], "remainingTickets": 43, "sessionTickID": "3IFrxHxz", "tickID": 20, "ticketID": "h3CMWn1W", "timeToMatchSec": 0.6900616329824295, "timestamp": "1996-12-27T00:00:00Z", "unbackfillReason": "oVOYIiFX", "unmatchReason": "ioIQOOCF"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn sessionhistory \
    --op CreateXrayBulkTicketObservability \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 35 'CreateXrayBulkTicketObservability' test.out

#- 36 QueryXrayTimelineByTicketID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByTicketID \
    --namespace $AB_NAMESPACE \
    --ticketId 'fMrebDzR' \
    --limit '38' \
    --offset '100' \
    --endDate 'VeCjJPl6' \
    --startDate 'Zdn8yXKo' \
    > test.out 2>&1
eval_tap $? 36 'QueryXrayTimelineByTicketID' test.out

#- 37 QueryXrayTimelineByUserID
$CLI_EXE \
    --sn sessionhistory \
    --op QueryXrayTimelineByUserID \
    --namespace $AB_NAMESPACE \
    --userId 'PwCggfry' \
    --limit '45' \
    --offset '96' \
    --endDate 'E8tBCc82' \
    --startDate 'L0Ylru2x' \
    > test.out 2>&1
eval_tap $? 37 'QueryXrayTimelineByUserID' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE