#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..38"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 AdminGetChallenges
$CLI_EXE \
    --sn challenge \
    --op AdminGetChallenges \
    --namespace $AB_NAMESPACE \
    --keyword 'X4uAo0G5' \
    --limit '75' \
    --offset '8' \
    --sortBy 'updatedAt' \
    --status 'INIT' \
    --tags '["W7qnxwWD", "NYX4Ss7F", "l4umk0FT"]' \
    > test.out 2>&1
eval_tap $? 2 'AdminGetChallenges' test.out

#- 3 AdminCreateChallenge
# body param: body
echo '{"activeGoalsPerRotation": 0, "assignmentRule": "UNSCHEDULED", "code": "ZFLWJeh8", "description": "FaH4pWh0", "endAfter": 43, "endDate": "1982-03-05T00:00:00Z", "goalsVisibility": "SHOWALL", "name": "2BriATF3", "randomizedPerRotation": true, "repeatAfter": 88, "resetConfig": {"resetDate": 42, "resetDay": 61, "resetTime": "HJrVbqSr"}, "rotation": "MONTHLY", "startDate": "1980-01-29T00:00:00Z", "tags": ["ULdj4gvC", "jMpUWKJQ", "iWkFgByR"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminCreateChallenge \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 3 'AdminCreateChallenge' test.out

#- 4 AdminGetActiveChallenges
$CLI_EXE \
    --sn challenge \
    --op AdminGetActiveChallenges \
    --namespace $AB_NAMESPACE \
    --userId 'e33azysK' \
    --limit '55' \
    --offset '84' \
    > test.out 2>&1
eval_tap $? 4 'AdminGetActiveChallenges' test.out

#- 5 AdminGetChallenge
$CLI_EXE \
    --sn challenge \
    --op AdminGetChallenge \
    --challengeCode 'HGsLr9P1' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 5 'AdminGetChallenge' test.out

#- 6 AdminUpdateChallenge
# body param: body
echo '{"activeGoalsPerRotation": 64, "assignmentRule": "CUSTOM", "description": "GGPq2qy7", "endAfter": 86, "endDate": "1979-11-18T00:00:00Z", "goalsVisibility": "PERIODONLY", "name": "UsDE8aGC", "randomizedPerRotation": true, "repeatAfter": 24, "resetConfig": {"resetDate": 40, "resetDay": 16, "resetTime": "0gc9RLHk"}, "rotation": "DAILY", "startDate": "1991-11-08T00:00:00Z", "tags": ["dynJ3skx", "hJhGfoXN", "LkNJJcCh"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminUpdateChallenge \
    --challengeCode '6J1tiOkF' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 6 'AdminUpdateChallenge' test.out

#- 7 AdminDeleteChallenge
$CLI_EXE \
    --sn challenge \
    --op AdminDeleteChallenge \
    --challengeCode 'kuhfoh3b' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'AdminDeleteChallenge' test.out

#- 8 AdminGetGoals
$CLI_EXE \
    --sn challenge \
    --op AdminGetGoals \
    --challengeCode 'j8ESO0QI' \
    --namespace $AB_NAMESPACE \
    --limit '99' \
    --offset '64' \
    --sortBy 'updatedAt:desc' \
    > test.out 2>&1
eval_tap $? 8 'AdminGetGoals' test.out

#- 9 AdminCreateGoal
# body param: body
echo '{"code": "L0aGULeO", "description": "ujLVpQRi", "isActive": false, "name": "Zybo22aE", "requirementGroups": [{"operator": "AND", "predicates": [{"matcher": "EQUAL", "parameterName": "YUXXV76n", "parameterType": "STATISTIC_CYCLE", "statCycleId": "uL4q3rXr", "targetValue": 0.19909053846168734}, {"matcher": "EQUAL", "parameterName": "bdAN6EAJ", "parameterType": "USERACCOUNT", "statCycleId": "335UBg1E", "targetValue": 0.4061845249916257}, {"matcher": "GREATER_THAN_EQUAL", "parameterName": "dpFMOMZR", "parameterType": "USERACCOUNT", "statCycleId": "AD5Vt9WH", "targetValue": 0.2025190134902528}]}, {"operator": "AND", "predicates": [{"matcher": "GREATER_THAN_EQUAL", "parameterName": "Jw5j3gNH", "parameterType": "USERACCOUNT", "statCycleId": "56IoqgA4", "targetValue": 0.5390015835852948}, {"matcher": "GREATER_THAN_EQUAL", "parameterName": "xgh5qKfy", "parameterType": "ENTITLEMENT", "statCycleId": "4qrzx1rZ", "targetValue": 0.43068562377704467}, {"matcher": "GREATER_THAN", "parameterName": "QbL47Tav", "parameterType": "STATISTIC", "statCycleId": "8mx9pLEs", "targetValue": 0.22620385219699235}]}, {"operator": "AND", "predicates": [{"matcher": "EQUAL", "parameterName": "HE8x9SXW", "parameterType": "ENTITLEMENT", "statCycleId": "V7jpPdhq", "targetValue": 0.24343127915468477}, {"matcher": "LESS_THAN_EQUAL", "parameterName": "jvUmHm5S", "parameterType": "STATISTIC_CYCLE", "statCycleId": "v50oZRzA", "targetValue": 0.7159087316222843}, {"matcher": "GREATER_THAN_EQUAL", "parameterName": "kA1qUX3J", "parameterType": "ENTITLEMENT", "statCycleId": "XbGPduNX", "targetValue": 0.2306826769125525}]}], "rewards": [{"itemId": "fID8Izka", "itemName": "4j3DqyLm", "qty": 0.8630456310007625, "type": "ENTITLEMENT"}, {"itemId": "zwhx05lq", "itemName": "4PwMOSeL", "qty": 0.5932556763498956, "type": "ENTITLEMENT"}, {"itemId": "ad6sQYI5", "itemName": "rlP2gK5u", "qty": 0.3213976646728576, "type": "ENTITLEMENT"}], "schedule": {"endTime": "1989-03-15T00:00:00Z", "order": 11, "startTime": "1976-05-29T00:00:00Z"}, "tags": ["BLTFQZB6", "PbIsYyuf", "stEVNKhx"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminCreateGoal \
    --challengeCode 'mToo0IlR' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'AdminCreateGoal' test.out

#- 10 AdminGetGoal
$CLI_EXE \
    --sn challenge \
    --op AdminGetGoal \
    --challengeCode 'aBwtSaiH' \
    --code 'bWwzI0lS' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 10 'AdminGetGoal' test.out

#- 11 AdminUpdateGoals
# body param: body
echo '{"description": "Albsr9lW", "isActive": true, "name": "9RQi7hbM", "requirementGroups": [{"operator": "AND", "predicates": [{"matcher": "LESS_THAN_EQUAL", "parameterName": "o1p4WXBb", "parameterType": "ACHIEVEMENT", "statCycleId": "6snrTrvX", "targetValue": 0.6356334375385664}, {"matcher": "EQUAL", "parameterName": "i6aYMTLX", "parameterType": "STATISTIC", "statCycleId": "kwtRgxyQ", "targetValue": 0.3511647854555754}, {"matcher": "LESS_THAN", "parameterName": "fK6JfYS8", "parameterType": "ENTITLEMENT", "statCycleId": "iFCta3CY", "targetValue": 0.7327749685870744}]}, {"operator": "AND", "predicates": [{"matcher": "GREATER_THAN_EQUAL", "parameterName": "0Sis16d0", "parameterType": "STATISTIC_CYCLE", "statCycleId": "8jGnfxi3", "targetValue": 0.2488312787539324}, {"matcher": "EQUAL", "parameterName": "4ejnSc2p", "parameterType": "ENTITLEMENT", "statCycleId": "S9gCEy19", "targetValue": 0.8796373556446294}, {"matcher": "LESS_THAN_EQUAL", "parameterName": "Aoxkfp2j", "parameterType": "ACHIEVEMENT", "statCycleId": "m2jwmnj1", "targetValue": 0.8900723000615012}]}, {"operator": "AND", "predicates": [{"matcher": "EQUAL", "parameterName": "zkJ89cz2", "parameterType": "STATISTIC", "statCycleId": "kSzz6M8P", "targetValue": 0.7900644413080037}, {"matcher": "EQUAL", "parameterName": "wTFvHBOW", "parameterType": "USERACCOUNT", "statCycleId": "vyVRqhGk", "targetValue": 0.1478159370443266}, {"matcher": "GREATER_THAN", "parameterName": "XYzMqOic", "parameterType": "STATISTIC_CYCLE", "statCycleId": "6DjnCKEZ", "targetValue": 0.5182503755149376}]}], "rewards": [{"itemId": "zDdqlkrt", "itemName": "0ElW4t2e", "qty": 0.5888154449666573, "type": "STATISTIC"}, {"itemId": "AL72JIFK", "itemName": "gHwpe5s4", "qty": 0.20460078043225793, "type": "ENTITLEMENT"}, {"itemId": "clZ8zGU4", "itemName": "XYZqr9Ta", "qty": 0.9238083040236132, "type": "ENTITLEMENT"}], "schedule": {"endTime": "1994-09-23T00:00:00Z", "order": 90, "startTime": "1989-08-14T00:00:00Z"}, "tags": ["WEeukbI4", "boEsidZI", "Zisoijwd"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminUpdateGoals \
    --challengeCode 'mZaDv5MU' \
    --code 'ncYMdAf7' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'AdminUpdateGoals' test.out

#- 12 AdminDeleteGoal
$CLI_EXE \
    --sn challenge \
    --op AdminDeleteGoal \
    --challengeCode 'B6VbuRv7' \
    --code 'Llr5QOxs' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'AdminDeleteGoal' test.out

#- 13 AdminListSchedulesByGoal
$CLI_EXE \
    --sn challenge \
    --op AdminListSchedulesByGoal \
    --challengeCode '8b8ltY8M' \
    --code 'DoFMxLrC' \
    --namespace $AB_NAMESPACE \
    --limit '15' \
    --offset '1' \
    --userId 'wYrNv0jc' \
    > test.out 2>&1
eval_tap $? 13 'AdminListSchedulesByGoal' test.out

#- 14 AdminGetPeriods
$CLI_EXE \
    --sn challenge \
    --op AdminGetPeriods \
    --challengeCode 'jQtVAhjs' \
    --namespace $AB_NAMESPACE \
    --limit '76' \
    --offset '75' \
    > test.out 2>&1
eval_tap $? 14 'AdminGetPeriods' test.out

#- 15 AdminRandomizeChallenge
$CLI_EXE \
    --sn challenge \
    --op AdminRandomizeChallenge \
    --challengeCode 'r9MaDIPw' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 15 'AdminRandomizeChallenge' test.out

#- 16 AdminListSchedules
$CLI_EXE \
    --sn challenge \
    --op AdminListSchedules \
    --challengeCode 'xAJdDeHD' \
    --namespace $AB_NAMESPACE \
    --dateTime '1985-01-04T00:00:00Z' \
    --limit '69' \
    --offset '24' \
    --userId 'wcPqcQdG' \
    > test.out 2>&1
eval_tap $? 16 'AdminListSchedules' test.out

#- 17 AdminDeleteTiedChallenge
$CLI_EXE \
    --sn challenge \
    --op AdminDeleteTiedChallenge \
    --challengeCode 'v9jFKABU' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 17 'AdminDeleteTiedChallenge' test.out

#- 18 AdminUpdateTiedChallengeSchedule
# body param: body
echo '{"action": "ACCELERATE", "endDate": "1987-03-02T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminUpdateTiedChallengeSchedule \
    --challengeCode 'wNlscovY' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 18 'AdminUpdateTiedChallengeSchedule' test.out

#- 19 AdminGetAssignmentPlugin
$CLI_EXE \
    --sn challenge \
    --op AdminGetAssignmentPlugin \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 19 'AdminGetAssignmentPlugin' test.out

#- 20 AdminUpdateAssignmentPlugin
# body param: body
echo '{"appName": "oYZA2kMb", "extendType": "APP", "grpcServerAddress": "WDkfl4WT"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminUpdateAssignmentPlugin \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 20 'AdminUpdateAssignmentPlugin' test.out

#- 21 AdminCreateAssignmentPlugin
# body param: body
echo '{"appName": "ttoDuwlF", "extendType": "APP", "grpcServerAddress": "gIJWYcEk"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminCreateAssignmentPlugin \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 21 'AdminCreateAssignmentPlugin' test.out

#- 22 AdminDeleteAssignmentPlugin
$CLI_EXE \
    --sn challenge \
    --op AdminDeleteAssignmentPlugin \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'AdminDeleteAssignmentPlugin' test.out

#- 23 AdminEvaluateProgress
# body param: body
echo '{"userIds": ["AuBQ9N7C", "88iujXgr", "eRWZb5ba"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminEvaluateProgress \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 23 'AdminEvaluateProgress' test.out

#- 24 AdminClaimUsersRewards
# body param: body
echo '[{"rewardIds": ["FLt81Qk7", "4poGyd29", "3Bfj3OAi"], "userId": "243orHxh"}, {"rewardIds": ["kSTsduzA", "NoTECQOa", "7fdl4BVY"], "userId": "4hBaVUDy"}, {"rewardIds": ["cW5FUoch", "DKv3aTZd", "oUzMZkrN"], "userId": "LGlnFAFF"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminClaimUsersRewards \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'AdminClaimUsersRewards' test.out

#- 25 AdminClaimUserRewardsByGoalCode
# body param: body
echo '{"goalCode": "sx8lOcnp"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminClaimUserRewardsByGoalCode \
    --challengeCode 'zQJi2v8c' \
    --namespace $AB_NAMESPACE \
    --userId '3xoSz1Dn' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'AdminClaimUserRewardsByGoalCode' test.out

#- 26 AdminGetUserProgression
$CLI_EXE \
    --sn challenge \
    --op AdminGetUserProgression \
    --challengeCode 'j4dCvd19' \
    --namespace $AB_NAMESPACE \
    --userId 'K7varfKH' \
    --dateTime '1999-06-08T00:00:00Z' \
    --goalCode 'u3cl7hbh' \
    --limit '38' \
    --offset '79' \
    --tags '["uFHJZpIz", "IuRP4nEe", "pnzLPIG9"]' \
    > test.out 2>&1
eval_tap $? 26 'AdminGetUserProgression' test.out

#- 27 AdminGetUserRewards
$CLI_EXE \
    --sn challenge \
    --op AdminGetUserRewards \
    --namespace $AB_NAMESPACE \
    --userId 'mBEstK0l' \
    --challengeCode 'hXZyVJr8' \
    --goalProgressionId 'eJeVnxGc' \
    --limit '45' \
    --offset '76' \
    --sortBy 'updatedAt' \
    --status 'UNCLAIMED' \
    > test.out 2>&1
eval_tap $? 27 'AdminGetUserRewards' test.out

#- 28 AdminClaimUserRewards
# body param: body
echo '{"rewardIDs": ["OxmXOWBI", "NlkgEb0z", "h1GE8k4x"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminClaimUserRewards \
    --namespace $AB_NAMESPACE \
    --userId 'E88ocQp1' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 28 'AdminClaimUserRewards' test.out

#- 29 GetChallenges
$CLI_EXE \
    --sn challenge \
    --op GetChallenges \
    --namespace $AB_NAMESPACE \
    --keyword 'BWHNl2BG' \
    --limit '40' \
    --offset '80' \
    --sortBy 'createdAt:desc' \
    --status 'TIED' \
    --tags '["0KRmIUVz", "95BWT2O7", "UM5vW8sQ"]' \
    > test.out 2>&1
eval_tap $? 29 'GetChallenges' test.out

#- 30 PublicGetScheduledGoals
$CLI_EXE \
    --sn challenge \
    --op PublicGetScheduledGoals \
    --challengeCode '16f02GfR' \
    --namespace $AB_NAMESPACE \
    --limit '75' \
    --offset '54' \
    --tags '["1CKohNb6", "DzKFceCf", "THhaKpwl"]' \
    > test.out 2>&1
eval_tap $? 30 'PublicGetScheduledGoals' test.out

#- 31 PublicListSchedulesByGoal
$CLI_EXE \
    --sn challenge \
    --op PublicListSchedulesByGoal \
    --challengeCode 'MsmBQLWA' \
    --code 'mLSBrvCw' \
    --namespace $AB_NAMESPACE \
    --limit '92' \
    --offset '13' \
    > test.out 2>&1
eval_tap $? 31 'PublicListSchedulesByGoal' test.out

#- 32 PublicListSchedules
$CLI_EXE \
    --sn challenge \
    --op PublicListSchedules \
    --challengeCode 'jc6ruT4W' \
    --namespace $AB_NAMESPACE \
    --dateTime '1991-06-07T00:00:00Z' \
    --limit '18' \
    --offset '48' \
    > test.out 2>&1
eval_tap $? 32 'PublicListSchedules' test.out

#- 33 PublicClaimUserRewardsByGoalCode
# body param: body
echo '{"goalCode": "pyqYzbGk"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op PublicClaimUserRewardsByGoalCode \
    --challengeCode 'Sd5yURWF' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 33 'PublicClaimUserRewardsByGoalCode' test.out

#- 34 EvaluateMyProgress
$CLI_EXE \
    --sn challenge \
    --op EvaluateMyProgress \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 34 'EvaluateMyProgress' test.out

#- 35 PublicGetUserProgression
$CLI_EXE \
    --sn challenge \
    --op PublicGetUserProgression \
    --challengeCode 'ARiXWfht' \
    --namespace $AB_NAMESPACE \
    --dateTime '1973-04-08T00:00:00Z' \
    --goalCode 'tZxEBC56' \
    --limit '22' \
    --offset '72' \
    --tags '["Vu0WJjRA", "2TfR6eCb", "kM8anjty"]' \
    > test.out 2>&1
eval_tap $? 35 'PublicGetUserProgression' test.out

#- 36 PublicGetPastUserProgression
$CLI_EXE \
    --sn challenge \
    --op PublicGetPastUserProgression \
    --challengeCode 'ij7zmKdb' \
    --index '40' \
    --namespace $AB_NAMESPACE \
    --goalCode '3U86hE81' \
    --limit '66' \
    --offset '22' \
    --tags '["redl40IN", "45D8Oi6Q", "cTuSGfJd"]' \
    > test.out 2>&1
eval_tap $? 36 'PublicGetPastUserProgression' test.out

#- 37 PublicGetUserRewards
$CLI_EXE \
    --sn challenge \
    --op PublicGetUserRewards \
    --namespace $AB_NAMESPACE \
    --challengeCode 'F7mfD2NV' \
    --goalProgressionId 'sIDzxJxI' \
    --limit '45' \
    --offset '7' \
    --sortBy 'createdAt:desc' \
    --status 'CLAIMED' \
    > test.out 2>&1
eval_tap $? 37 'PublicGetUserRewards' test.out

#- 38 PublicClaimUserRewards
# body param: body
echo '{"rewardIDs": ["ttnFYfLO", "g40tkV2W", "Cu53QJAJ"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op PublicClaimUserRewards \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 38 'PublicClaimUserRewards' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE