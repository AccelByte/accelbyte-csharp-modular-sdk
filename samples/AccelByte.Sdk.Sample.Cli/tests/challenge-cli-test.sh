#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..29"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 AdminGetChallenges
$CLI_EXE \
    --sn challenge \
    --op AdminGetChallenges \
    --namespace $AB_NAMESPACE \
    --limit '2' \
    --offset '1' \
    --sortBy 'SK0M27OT' \
    --status 'RETIRED' \
    > test.out 2>&1
eval_tap $? 2 'AdminGetChallenges' test.out

#- 3 AdminCreateChallenge
# body param: body
echo '{"activeGoalsPerRotation": 38, "assignmentRule": "FIXED", "code": "8yqbksap", "description": "SbSaqeLN", "endAfter": 2, "endDate": "1980-08-25T00:00:00Z", "goalsVisibility": "SHOWALL", "name": "bhUvAcmn", "randomizedPerRotation": false, "repeatAfter": 54, "resetConfig": {"resetDate": 36, "resetDay": 79, "resetTime": "vjpIlegu"}, "rotation": "DAILY", "startDate": "1973-07-25T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminCreateChallenge \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 3 'AdminCreateChallenge' test.out

#- 4 AdminGetChallenge
$CLI_EXE \
    --sn challenge \
    --op AdminGetChallenge \
    --challengeCode '0N1Oyain' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 4 'AdminGetChallenge' test.out

#- 5 AdminUpdateChallenge
# body param: body
echo '{"activeGoalsPerRotation": 74, "assignmentRule": "UNSCHEDULED", "description": "HIjyYRwE", "endAfter": 75, "endDate": "1996-06-25T00:00:00Z", "goalsVisibility": "SHOWALL", "name": "cNmco7Mn", "randomizedPerRotation": false, "repeatAfter": 15, "resetConfig": {"resetDate": 4, "resetDay": 9, "resetTime": "Mi7Ll3ah"}, "rotation": "DAILY", "startDate": "1981-02-14T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminUpdateChallenge \
    --challengeCode 'Du7CZVBr' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'AdminUpdateChallenge' test.out

#- 6 AdminDeleteChallenge
$CLI_EXE \
    --sn challenge \
    --op AdminDeleteChallenge \
    --challengeCode 'SDYVY0fh' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'AdminDeleteChallenge' test.out

#- 7 AdminGetGoals
$CLI_EXE \
    --sn challenge \
    --op AdminGetGoals \
    --challengeCode 'zMsQPw8y' \
    --namespace $AB_NAMESPACE \
    --limit '74' \
    --offset '5' \
    --sortBy '3LdoxWRa' \
    > test.out 2>&1
eval_tap $? 7 'AdminGetGoals' test.out

#- 8 AdminCreateGoal
# body param: body
echo '{"code": "Uv4HY761", "description": "uIOHw8Q6", "isActive": false, "name": "gDniHdkk", "requirementGroups": [{"operator": "AND", "predicates": [{"matcher": "LESS_THAN_EQUAL", "parameterName": "1FtnHjbQ", "parameterType": "STATISTIC_CYCLE", "statCycleId": "d2UEEVFX", "targetValue": 0.8297520893985671}, {"matcher": "EQUAL", "parameterName": "3MZbI9mw", "parameterType": "ACHIEVEMENT", "statCycleId": "iRleNHQf", "targetValue": 0.874654275361664}, {"matcher": "LESS_THAN_EQUAL", "parameterName": "WVyUxPlx", "parameterType": "STATISTIC_CYCLE", "statCycleId": "QvMCbfWA", "targetValue": 0.6083734524852572}]}, {"operator": "AND", "predicates": [{"matcher": "LESS_THAN_EQUAL", "parameterName": "mTcdqwWf", "parameterType": "ACHIEVEMENT", "statCycleId": "Q3JbvrCN", "targetValue": 0.5457560627113502}, {"matcher": "GREATER_THAN", "parameterName": "UVqgpW8D", "parameterType": "ACHIEVEMENT", "statCycleId": "7hbomNfU", "targetValue": 0.8591698193659216}, {"matcher": "LESS_THAN_EQUAL", "parameterName": "tRAfN2rx", "parameterType": "ACHIEVEMENT", "statCycleId": "hnZoGRzc", "targetValue": 0.47649189102660705}]}, {"operator": "AND", "predicates": [{"matcher": "EQUAL", "parameterName": "JCGzTUpS", "parameterType": "USERACCOUNT", "statCycleId": "oiWi1v6e", "targetValue": 0.729951459440515}, {"matcher": "LESS_THAN_EQUAL", "parameterName": "Vkw7Vjxv", "parameterType": "USERACCOUNT", "statCycleId": "o90KlZrm", "targetValue": 0.5615347545890116}, {"matcher": "GREATER_THAN_EQUAL", "parameterName": "klfggYVP", "parameterType": "STATISTIC", "statCycleId": "9PtyQG6h", "targetValue": 0.006939720571274455}]}], "rewards": [{"itemId": "qhgFgWS9", "itemName": "5c8hNO4l", "qty": 0.15348995138663035, "type": "ENTITLEMENT"}, {"itemId": "Y0uc7osp", "itemName": "fFl2JqoR", "qty": 0.6180819630837338, "type": "STATISTIC"}, {"itemId": "NYtQ0cee", "itemName": "DUKQDhiH", "qty": 0.5359102074484872, "type": "ENTITLEMENT"}], "schedule": {"endTime": "1991-06-17T00:00:00Z", "order": 60, "startTime": "1976-12-20T00:00:00Z"}, "tags": ["AFFqOBnO", "2Tl554mr", "2Maglof6"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminCreateGoal \
    --challengeCode 'BmxdLjbn' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'AdminCreateGoal' test.out

#- 9 AdminGetGoal
$CLI_EXE \
    --sn challenge \
    --op AdminGetGoal \
    --challengeCode 'Q87Hi9gM' \
    --code 'tfnjgiZM' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 9 'AdminGetGoal' test.out

#- 10 AdminUpdateGoals
# body param: body
echo '{"description": "pw04vzxp", "isActive": false, "name": "jKhF1aW3", "requirementGroups": [{"operator": "AND", "predicates": [{"matcher": "GREATER_THAN", "parameterName": "TixNRSHN", "parameterType": "STATISTIC_CYCLE", "statCycleId": "cYoePq5g", "targetValue": 0.11719902640740365}, {"matcher": "LESS_THAN", "parameterName": "WrQO9a9W", "parameterType": "STATISTIC_CYCLE", "statCycleId": "mFW6CVAp", "targetValue": 0.796778093799465}, {"matcher": "EQUAL", "parameterName": "efsXVVS6", "parameterType": "USERACCOUNT", "statCycleId": "AYeTbXAY", "targetValue": 0.7059581096100623}]}, {"operator": "AND", "predicates": [{"matcher": "GREATER_THAN", "parameterName": "wnLiGm1U", "parameterType": "ACHIEVEMENT", "statCycleId": "YM1wrBTz", "targetValue": 0.05693695238552887}, {"matcher": "EQUAL", "parameterName": "RBt2ms81", "parameterType": "STATISTIC", "statCycleId": "xyPegKry", "targetValue": 0.6404350084136209}, {"matcher": "LESS_THAN", "parameterName": "r7vc78Ad", "parameterType": "ENTITLEMENT", "statCycleId": "5yI8C96H", "targetValue": 0.431220170727186}]}, {"operator": "AND", "predicates": [{"matcher": "LESS_THAN", "parameterName": "27QbGBEV", "parameterType": "ACHIEVEMENT", "statCycleId": "83c1SYzc", "targetValue": 0.4352760328662446}, {"matcher": "LESS_THAN", "parameterName": "gNwXJExG", "parameterType": "STATISTIC", "statCycleId": "1DgWj9ZB", "targetValue": 0.22004962622767588}, {"matcher": "LESS_THAN", "parameterName": "qZzJxB2s", "parameterType": "USERACCOUNT", "statCycleId": "crQasDMr", "targetValue": 0.5316638456342206}]}], "rewards": [{"itemId": "2rYc5QTO", "itemName": "J4BjYPgi", "qty": 0.8935192145635233, "type": "ENTITLEMENT"}, {"itemId": "kLomJy4T", "itemName": "K5XVABf1", "qty": 0.27461554332206073, "type": "ENTITLEMENT"}, {"itemId": "c0WxAQMr", "itemName": "PnLGWz9K", "qty": 0.4661116014017834, "type": "STATISTIC"}], "schedule": {"endTime": "1973-12-30T00:00:00Z", "order": 25, "startTime": "1975-08-15T00:00:00Z"}, "tags": ["NxECN7e7", "f65WIjXH", "hyEgj2JB"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminUpdateGoals \
    --challengeCode 'vTztJJPv' \
    --code 'j8GbWAwK' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'AdminUpdateGoals' test.out

#- 11 AdminDeleteGoal
$CLI_EXE \
    --sn challenge \
    --op AdminDeleteGoal \
    --challengeCode 'pltKh3fo' \
    --code 'HVi8pjlX' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 11 'AdminDeleteGoal' test.out

#- 12 AdminGetPeriods
$CLI_EXE \
    --sn challenge \
    --op AdminGetPeriods \
    --challengeCode 'xZAPPs9W' \
    --namespace $AB_NAMESPACE \
    --limit '63' \
    --offset '1' \
    > test.out 2>&1
eval_tap $? 12 'AdminGetPeriods' test.out

#- 13 AdminRandomizeChallenge
$CLI_EXE \
    --sn challenge \
    --op AdminRandomizeChallenge \
    --challengeCode '1ypYMOHO' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 13 'AdminRandomizeChallenge' test.out

#- 14 AdminDeleteTiedChallenge
$CLI_EXE \
    --sn challenge \
    --op AdminDeleteTiedChallenge \
    --challengeCode 'OuBin4Xr' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'AdminDeleteTiedChallenge' test.out

#- 15 AdminGetAssignmentPlugin
$CLI_EXE \
    --sn challenge \
    --op AdminGetAssignmentPlugin \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 15 'AdminGetAssignmentPlugin' test.out

#- 16 AdminUpdateAssignmentPlugin
# body param: body
echo '{"appName": "bQnFWy2a", "extendType": "CUSTOM", "grpcServerAddress": "ESAj6Btd"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminUpdateAssignmentPlugin \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 16 'AdminUpdateAssignmentPlugin' test.out

#- 17 AdminCreateAssignmentPlugin
# body param: body
echo '{"appName": "Yoieu0Fv", "extendType": "APP", "grpcServerAddress": "RuW9MZr7"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminCreateAssignmentPlugin \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 17 'AdminCreateAssignmentPlugin' test.out

#- 18 AdminDeleteAssignmentPlugin
$CLI_EXE \
    --sn challenge \
    --op AdminDeleteAssignmentPlugin \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'AdminDeleteAssignmentPlugin' test.out

#- 19 AdminEvaluateProgress
# body param: body
echo '{"userIds": ["Nm3HqRn9", "vblErNNT", "War67dzt"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminEvaluateProgress \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'AdminEvaluateProgress' test.out

#- 20 AdminClaimUsersRewards
# body param: body
echo '[{"rewardIds": ["BtWKnoiV", "WasXVJgA", "2Mip2Mas"], "userId": "fA3t8lwW"}, {"rewardIds": ["CR3Kix3m", "cwJzTyU5", "QtA90pPR"], "userId": "fDSxTmAR"}, {"rewardIds": ["5jya9piK", "rcBz0ps8", "vBN16SDa"], "userId": "zpyTPgvI"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminClaimUsersRewards \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 20 'AdminClaimUsersRewards' test.out

#- 21 AdminGetUserRewards
$CLI_EXE \
    --sn challenge \
    --op AdminGetUserRewards \
    --namespace $AB_NAMESPACE \
    --userId 'pLt1AkkK' \
    --limit '45' \
    --offset '31' \
    --sortBy 'nZcJsUQ6' \
    --status 'CLAIMED' \
    > test.out 2>&1
eval_tap $? 21 'AdminGetUserRewards' test.out

#- 22 AdminClaimUserRewards
# body param: body
echo '{"rewardIDs": ["htAqEfR8", "9cmxLkOs", "zIP2ONhR"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op AdminClaimUserRewards \
    --namespace $AB_NAMESPACE \
    --userId 'Bt6GTQBo' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'AdminClaimUserRewards' test.out

#- 23 GetChallenges
$CLI_EXE \
    --sn challenge \
    --op GetChallenges \
    --namespace $AB_NAMESPACE \
    --limit '91' \
    --offset '67' \
    --sortBy 'yCCUGmhT' \
    --status 'TIED' \
    > test.out 2>&1
eval_tap $? 23 'GetChallenges' test.out

#- 24 PublicGetScheduledGoals
$CLI_EXE \
    --sn challenge \
    --op PublicGetScheduledGoals \
    --challengeCode 'z7K6LLOc' \
    --namespace $AB_NAMESPACE \
    --limit '88' \
    --offset '61' \
    --tags '["T0diRQGq", "dMdy1Pyx", "f1IbBzwP"]' \
    > test.out 2>&1
eval_tap $? 24 'PublicGetScheduledGoals' test.out

#- 25 EvaluateMyProgress
$CLI_EXE \
    --sn challenge \
    --op EvaluateMyProgress \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 25 'EvaluateMyProgress' test.out

#- 26 PublicGetUserProgression
$CLI_EXE \
    --sn challenge \
    --op PublicGetUserProgression \
    --challengeCode 'd3xPSCIh' \
    --namespace $AB_NAMESPACE \
    --dateTime '1972-04-11T00:00:00Z' \
    --goalCode 'qMANIdy5' \
    --limit '97' \
    --offset '97' \
    --tags '["y8LcDM5Q", "swp8HSIM", "m6WdVyhW"]' \
    > test.out 2>&1
eval_tap $? 26 'PublicGetUserProgression' test.out

#- 27 PublicGetPastUserProgression
$CLI_EXE \
    --sn challenge \
    --op PublicGetPastUserProgression \
    --challengeCode 'v7XIYTdE' \
    --index '33' \
    --namespace $AB_NAMESPACE \
    --goalCode 'k8IYiikG' \
    --limit '65' \
    --offset '64' \
    --tags '["ScXpNJfJ", "JrzglCma", "uGH7S42p"]' \
    > test.out 2>&1
eval_tap $? 27 'PublicGetPastUserProgression' test.out

#- 28 PublicGetUserRewards
$CLI_EXE \
    --sn challenge \
    --op PublicGetUserRewards \
    --namespace $AB_NAMESPACE \
    --limit '26' \
    --offset '88' \
    --sortBy 'qpWcRgb3' \
    --status 'UNCLAIMED' \
    > test.out 2>&1
eval_tap $? 28 'PublicGetUserRewards' test.out

#- 29 PublicClaimUserRewards
# body param: body
echo '{"rewardIDs": ["Ma2850Q3", "5Zhje3jE", "fKo6jTSa"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn challenge \
    --op PublicClaimUserRewards \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'PublicClaimUserRewards' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE