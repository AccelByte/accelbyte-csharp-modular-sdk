#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '77' \
    --offset '91' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCannotMatch", "deployment": "c0Cw3O7p", "description": "S2yhVhju", "find_match_timeout_seconds": 81, "game_mode": "dFAEgWD2", "joinable": true, "max_delay_ms": 100, "region_expansion_range_ms": 28, "region_expansion_rate_ms": 71, "region_latency_initial_range_ms": 52, "region_latency_max_ms": 59, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 64, "min": 27, "name": "MSoSyYRn"}, {"max": 32, "min": 36, "name": "bvzkVz8Z"}, {"max": 38, "min": 100, "name": "TeAUNJBK"}], [{"max": 48, "min": 91, "name": "47Waa1T3"}, {"max": 0, "min": 0, "name": "Fn2Tr3mX"}, {"max": 63, "min": 96, "name": "GXI9yDls"}], [{"max": 69, "min": 83, "name": "V4nx8Vg7"}, {"max": 64, "min": 8, "name": "jCocZe6P"}, {"max": 45, "min": 61, "name": "paJP7U7h"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 18, "role_flexing_second": 17}, "max_number": 0, "min_number": 77, "player_max_number": 24, "player_min_number": 95}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 36, "min": 38, "name": "nNf9sEs3"}, {"max": 16, "min": 76, "name": "AoL1bgtS"}, {"max": 51, "min": 62, "name": "3MfxCYjS"}], [{"max": 47, "min": 44, "name": "aI6u6xuk"}, {"max": 78, "min": 25, "name": "xGxENxPG"}, {"max": 46, "min": 6, "name": "Kzw5sPdY"}], [{"max": 18, "min": 32, "name": "DSYXmGmM"}, {"max": 51, "min": 19, "name": "sEaGqYCW"}, {"max": 83, "min": 74, "name": "p6XOWCze"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 94, "role_flexing_second": 29}, "duration": 83, "max_number": 0, "min_number": 15, "player_max_number": 7, "player_min_number": 48}, {"combination": {"alliances": [[{"max": 23, "min": 22, "name": "mwj5XJPT"}, {"max": 45, "min": 55, "name": "t9ZoL4By"}, {"max": 92, "min": 26, "name": "orSEduuX"}], [{"max": 37, "min": 67, "name": "3XQzGxcw"}, {"max": 96, "min": 65, "name": "ZpSXSnvr"}, {"max": 19, "min": 18, "name": "BuGLbYG1"}], [{"max": 25, "min": 0, "name": "eSkz3Jq4"}, {"max": 36, "min": 34, "name": "ib2u1yYc"}, {"max": 17, "min": 11, "name": "v1cOyPeu"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 52, "role_flexing_second": 92}, "duration": 53, "max_number": 95, "min_number": 71, "player_max_number": 83, "player_min_number": 65}, {"combination": {"alliances": [[{"max": 15, "min": 89, "name": "oKhXDhWf"}, {"max": 28, "min": 16, "name": "0Kqh5q7A"}, {"max": 73, "min": 74, "name": "I8F4Cafx"}], [{"max": 84, "min": 12, "name": "eAKkGXVx"}, {"max": 31, "min": 86, "name": "375h1T45"}, {"max": 28, "min": 69, "name": "s9wVr8HD"}], [{"max": 6, "min": 48, "name": "BC1HofUf"}, {"max": 70, "min": 9, "name": "SrQyEntC"}, {"max": 49, "min": 50, "name": "ARAEK1SG"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 10, "role_flexing_second": 59}, "duration": 87, "max_number": 39, "min_number": 85, "player_max_number": 69, "player_min_number": 79}], "batch_size": 64, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 25, "flex_flat_step_range": 72, "flex_immunity_count": 67, "flex_range_max": 85, "flex_rate_ms": 98, "flex_step_max": 49, "force_authority_match": false, "initial_step_range": 57, "mmr_max": 63, "mmr_mean": 4, "mmr_min": 53, "mmr_std_dev": 36, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "IIONGkdr", "criteria": "KY8IRiis", "duration": 70, "reference": 0.9918101715036202}, {"attribute": "N3IIXu39", "criteria": "LzsRhSn0", "duration": 37, "reference": 0.7697827543962017}, {"attribute": "FZ3ZE4dp", "criteria": "i3OikXFy", "duration": 31, "reference": 0.6560018619248087}], "match_options": {"options": [{"name": "GpFk9ZvN", "type": "TUDqYoUM"}, {"name": "LZSIABMI", "type": "Kn8FprKL"}, {"name": "X42JK3vj", "type": "yu6OgwuR"}]}, "matching_rule": [{"attribute": "ne5eElvm", "criteria": "66QwwsIP", "reference": 0.9953215217869269}, {"attribute": "HhdIkteK", "criteria": "PzIqCXAN", "reference": 0.6719347493617162}, {"attribute": "QwnMrD51", "criteria": "OxuivVOK", "reference": 0.19248991693346051}], "rebalance_enable": true, "sort_ticket": {"search_result": "random", "ticket_queue": "distance"}, "sort_tickets": [{"search_result": "none", "threshold": 78, "ticket_queue": "none"}, {"search_result": "oldestTicketAge", "threshold": 79, "ticket_queue": "oldestTicketAge"}, {"search_result": "random", "threshold": 96, "ticket_queue": "distance"}], "sub_game_modes": {"aev2KYP3": {"alliance": {"combination": {"alliances": [[{"max": 32, "min": 75, "name": "3c3ooB7b"}, {"max": 9, "min": 95, "name": "hlmOQD1O"}, {"max": 3, "min": 46, "name": "5jo454Jg"}], [{"max": 77, "min": 98, "name": "1wlUp9CV"}, {"max": 75, "min": 39, "name": "wEv9vkF7"}, {"max": 89, "min": 86, "name": "jFqQQlXa"}], [{"max": 62, "min": 10, "name": "RNUTZDlP"}, {"max": 29, "min": 66, "name": "GjM3T6dK"}, {"max": 94, "min": 21, "name": "lR4mAo4i"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 77, "role_flexing_second": 53}, "max_number": 3, "min_number": 25, "player_max_number": 67, "player_min_number": 83}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 5, "min": 9, "name": "fU5bha0Z"}, {"max": 12, "min": 36, "name": "CjVKLowl"}, {"max": 36, "min": 79, "name": "cPWq7gGN"}], [{"max": 79, "min": 73, "name": "vqUdIYbP"}, {"max": 92, "min": 49, "name": "DeVh1GCx"}, {"max": 55, "min": 55, "name": "NUoSZQDy"}], [{"max": 24, "min": 89, "name": "H95B2TZ5"}, {"max": 24, "min": 30, "name": "4vmcY6tD"}, {"max": 27, "min": 20, "name": "r4dAjZej"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 47, "role_flexing_second": 14}, "duration": 1, "max_number": 48, "min_number": 50, "player_max_number": 100, "player_min_number": 51}, {"combination": {"alliances": [[{"max": 49, "min": 88, "name": "g0vnJJMs"}, {"max": 88, "min": 37, "name": "JOdPjkBA"}, {"max": 34, "min": 90, "name": "12gg8sXD"}], [{"max": 35, "min": 36, "name": "C34LK2uD"}, {"max": 27, "min": 55, "name": "EukuQy44"}, {"max": 96, "min": 29, "name": "tCOZUkB4"}], [{"max": 95, "min": 48, "name": "dwoBqxck"}, {"max": 37, "min": 72, "name": "nFMvhTdJ"}, {"max": 15, "min": 78, "name": "N1luoDEu"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 76, "role_flexing_second": 2}, "duration": 5, "max_number": 1, "min_number": 89, "player_max_number": 29, "player_min_number": 60}, {"combination": {"alliances": [[{"max": 30, "min": 42, "name": "4HQApAIm"}, {"max": 58, "min": 2, "name": "peMCHzOW"}, {"max": 92, "min": 15, "name": "ZmQfSrc3"}], [{"max": 82, "min": 30, "name": "oVjPbO7I"}, {"max": 30, "min": 88, "name": "83xFxvBs"}, {"max": 45, "min": 47, "name": "eJ7sdFgT"}], [{"max": 52, "min": 30, "name": "OuZvAUIF"}, {"max": 64, "min": 23, "name": "9Oa3VkDz"}, {"max": 5, "min": 12, "name": "YWPOqmDM"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 6, "role_flexing_second": 10}, "duration": 73, "max_number": 77, "min_number": 19, "player_max_number": 93, "player_min_number": 48}], "name": "SkEGozow"}, "x93RSg9E": {"alliance": {"combination": {"alliances": [[{"max": 25, "min": 23, "name": "rhlMOatU"}, {"max": 12, "min": 25, "name": "iZrVyy6Q"}, {"max": 89, "min": 41, "name": "TGk5gJZu"}], [{"max": 90, "min": 91, "name": "zhM19UFw"}, {"max": 34, "min": 37, "name": "0Fsy2uzq"}, {"max": 100, "min": 19, "name": "t4PKcA4Y"}], [{"max": 78, "min": 19, "name": "GhHMRpR0"}, {"max": 33, "min": 27, "name": "0p1gpQRm"}, {"max": 92, "min": 65, "name": "PSOl3HSi"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 18, "role_flexing_second": 35}, "max_number": 0, "min_number": 21, "player_max_number": 41, "player_min_number": 69}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 77, "min": 22, "name": "fbHsbF1p"}, {"max": 66, "min": 31, "name": "gjgc0jvC"}, {"max": 27, "min": 17, "name": "7jE3Uyvp"}], [{"max": 91, "min": 29, "name": "TvGlgnGX"}, {"max": 15, "min": 30, "name": "0rLPfIhT"}, {"max": 61, "min": 23, "name": "thFpwKhm"}], [{"max": 34, "min": 44, "name": "neDbYaYs"}, {"max": 71, "min": 64, "name": "EaL5Tegu"}, {"max": 82, "min": 2, "name": "elWIFWah"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 39, "role_flexing_second": 3}, "duration": 87, "max_number": 95, "min_number": 12, "player_max_number": 90, "player_min_number": 9}, {"combination": {"alliances": [[{"max": 38, "min": 35, "name": "eOu4wvcb"}, {"max": 6, "min": 22, "name": "NDSr11C8"}, {"max": 18, "min": 38, "name": "kKOkpo3h"}], [{"max": 95, "min": 25, "name": "OI6UqYNK"}, {"max": 6, "min": 73, "name": "Jz82uyL9"}, {"max": 52, "min": 42, "name": "jXsrgBL7"}], [{"max": 19, "min": 92, "name": "OlJXAEWN"}, {"max": 89, "min": 59, "name": "JPswbHwa"}, {"max": 21, "min": 83, "name": "2vzsSgTQ"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 38, "role_flexing_second": 20}, "duration": 21, "max_number": 14, "min_number": 19, "player_max_number": 12, "player_min_number": 2}, {"combination": {"alliances": [[{"max": 84, "min": 15, "name": "KNLDJltX"}, {"max": 27, "min": 54, "name": "Dxk2OY3p"}, {"max": 85, "min": 1, "name": "MbgqaeSg"}], [{"max": 5, "min": 90, "name": "Utfhk8kz"}, {"max": 22, "min": 3, "name": "Thjit1WD"}, {"max": 73, "min": 67, "name": "3gwL7Wrh"}], [{"max": 45, "min": 14, "name": "GaNVjpvc"}, {"max": 71, "min": 35, "name": "uqICV4PZ"}, {"max": 19, "min": 34, "name": "Czk92qq3"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 10, "role_flexing_second": 61}, "duration": 24, "max_number": 56, "min_number": 85, "player_max_number": 70, "player_min_number": 5}], "name": "i7BQT3FR"}, "GTomJSjI": {"alliance": {"combination": {"alliances": [[{"max": 38, "min": 89, "name": "qYvX0CPN"}, {"max": 78, "min": 7, "name": "usiVD2Hs"}, {"max": 82, "min": 25, "name": "ERiL89nn"}], [{"max": 97, "min": 64, "name": "G4hB9uuK"}, {"max": 76, "min": 85, "name": "RjUaTZNz"}, {"max": 24, "min": 89, "name": "4mLu8eIM"}], [{"max": 21, "min": 32, "name": "kWRlR9LB"}, {"max": 24, "min": 82, "name": "R0zMrSl5"}, {"max": 27, "min": 90, "name": "0RaNbP0A"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 80, "role_flexing_second": 56}, "max_number": 44, "min_number": 6, "player_max_number": 70, "player_min_number": 42}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 63, "min": 4, "name": "ZfxYsXJK"}, {"max": 8, "min": 39, "name": "IS6Q0a00"}, {"max": 45, "min": 89, "name": "9z1u7jNt"}], [{"max": 90, "min": 51, "name": "BdIjGqba"}, {"max": 11, "min": 36, "name": "uORwEZtc"}, {"max": 67, "min": 64, "name": "naeHWYfo"}], [{"max": 36, "min": 51, "name": "OpEHaTih"}, {"max": 30, "min": 3, "name": "mdDWZhAP"}, {"max": 18, "min": 38, "name": "YhJw9PwU"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 72, "role_flexing_second": 60}, "duration": 66, "max_number": 54, "min_number": 44, "player_max_number": 41, "player_min_number": 24}, {"combination": {"alliances": [[{"max": 97, "min": 24, "name": "ksRLB46a"}, {"max": 25, "min": 90, "name": "NyFPVqBC"}, {"max": 27, "min": 6, "name": "PY70icu9"}], [{"max": 71, "min": 47, "name": "r8sjZTFz"}, {"max": 10, "min": 37, "name": "me7Syhw9"}, {"max": 48, "min": 51, "name": "bsNDynMp"}], [{"max": 61, "min": 25, "name": "aSOpHJq2"}, {"max": 66, "min": 3, "name": "PuypOG5h"}, {"max": 90, "min": 93, "name": "42z7ge2V"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 31, "role_flexing_second": 91}, "duration": 53, "max_number": 63, "min_number": 35, "player_max_number": 76, "player_min_number": 52}, {"combination": {"alliances": [[{"max": 88, "min": 51, "name": "vOBIlSh7"}, {"max": 88, "min": 9, "name": "18X0LUPH"}, {"max": 14, "min": 15, "name": "oL3LGhNc"}], [{"max": 29, "min": 62, "name": "FDveWYlm"}, {"max": 76, "min": 67, "name": "lWJWgqSR"}, {"max": 51, "min": 19, "name": "XhWGoVvT"}], [{"max": 77, "min": 75, "name": "0rxSrQOL"}, {"max": 50, "min": 44, "name": "ORtzvL9z"}, {"max": 52, "min": 25, "name": "lR2GUflJ"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 32, "role_flexing_second": 28}, "duration": 23, "max_number": 19, "min_number": 72, "player_max_number": 100, "player_min_number": 11}], "name": "JUF44lqf"}}, "ticket_flexing_selection": "pivot", "ticket_flexing_selections": [{"selection": "newest", "threshold": 26}, {"selection": "oldest", "threshold": 25}, {"selection": "random", "threshold": 86}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 47, "social_matchmaking": true, "ticket_observability_enable": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'VmZi71m7' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'YQ4S7LDL' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "d4fsToQF", "players": [{"results": [{"attribute": "p59vUyLq", "value": 0.7008425802730565}, {"attribute": "tWMqv90x", "value": 0.4776458136304794}, {"attribute": "aGMEYK8A", "value": 0.7218034023272764}], "user_id": "7L7Qcz31"}, {"results": [{"attribute": "XUFdHpr5", "value": 0.0050549710011986715}, {"attribute": "P3uivvEA", "value": 0.7947816132207371}, {"attribute": "4BS1Z0Ex", "value": 0.4795198620930856}], "user_id": "V4ADZNOX"}, {"results": [{"attribute": "lWca1t4t", "value": 0.3628013335423643}, {"attribute": "g2Fjz2Bi", "value": 0.12126575915246218}, {"attribute": "7txWut2H", "value": 0.4353487443880266}], "user_id": "CxCd35R9"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "8XYjTtz6"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "dT9cTGtg", "client_version": "uHu5psic", "deployment": "wqqfSzG9", "error_code": 18, "error_message": "FP6ztaSO", "game_mode": "zI2qjOvz", "is_mock": "bbHolCsx", "joinable": true, "match_id": "KaES4ELa", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 94, "party_attributes": {"9sMezI5D": {}, "EOkj4u8D": {}, "0VsaZEsF": {}}, "party_id": "5fvK88ix", "party_members": [{"extra_attributes": {"MFfxD1QG": {}, "NVsFwkdl": {}, "9h0hKQnh": {}}, "user_id": "xWHz0HAc"}, {"extra_attributes": {"Y7VUlJFM": {}, "bNNXN4Gv": {}, "iudTtNeV": {}}, "user_id": "TJylXcy9"}, {"extra_attributes": {"qTuDHFjm": {}, "WyV8EbiH": {}, "jWWeq2hi": {}}, "user_id": "nxtMnN30"}], "ticket_created_at": 53, "ticket_id": "jKskR1vD"}, {"first_ticket_created_at": 65, "party_attributes": {"Ou9aDqGj": {}, "jatw8Y7g": {}, "dXFtdpoS": {}}, "party_id": "WMRB2J2x", "party_members": [{"extra_attributes": {"89kI4QVA": {}, "EECSmAXe": {}, "0Ci8phTo": {}}, "user_id": "mBhBe9I6"}, {"extra_attributes": {"HNaUSLci": {}, "vUu9cDtJ": {}, "lAKy9D0Y": {}}, "user_id": "wi4Ia9C3"}, {"extra_attributes": {"WIOv3vaA": {}, "nQeBMv29": {}, "iTUPtAmn": {}}, "user_id": "hxj5V2X2"}], "ticket_created_at": 19, "ticket_id": "e8KAOLRx"}, {"first_ticket_created_at": 85, "party_attributes": {"XSoMJwBr": {}, "z713Lrad": {}, "sZjrIEZk": {}}, "party_id": "GR3moxl7", "party_members": [{"extra_attributes": {"IJN7RkV6": {}, "rW05RrbA": {}, "fI8WXP0X": {}}, "user_id": "tRzicH15"}, {"extra_attributes": {"7s0y1hV9": {}, "RuWzxI1w": {}, "sDp1rPn3": {}}, "user_id": "YNOQDDvx"}, {"extra_attributes": {"3uSDgNV8": {}, "MHgWIs7H": {}, "pVen5qdp": {}}, "user_id": "IewmTFPX"}], "ticket_created_at": 39, "ticket_id": "IQp9AVfZ"}]}, {"matching_parties": [{"first_ticket_created_at": 94, "party_attributes": {"AWW7oq5I": {}, "A3eeIoc9": {}, "8oFREWY1": {}}, "party_id": "QxeTxMKg", "party_members": [{"extra_attributes": {"WBTWZxOT": {}, "kN5hJDuL": {}, "dSEDWrL9": {}}, "user_id": "FAWt3rXR"}, {"extra_attributes": {"MyxBRugo": {}, "Lu2VJhpb": {}, "APZeJeyx": {}}, "user_id": "NmRB8Adj"}, {"extra_attributes": {"ldVd2lrI": {}, "ar85BqD9": {}, "39N0CKdR": {}}, "user_id": "nkm9sKb4"}], "ticket_created_at": 27, "ticket_id": "2MN62BrH"}, {"first_ticket_created_at": 42, "party_attributes": {"7IHokNlr": {}, "QNLfFoRg": {}, "BOK9RAO1": {}}, "party_id": "Ww4yBFQ4", "party_members": [{"extra_attributes": {"gxSE2xMZ": {}, "EwsULWTe": {}, "ViKvXkiu": {}}, "user_id": "iWexBXwk"}, {"extra_attributes": {"fiENSMUz": {}, "LbvKejol": {}, "Dxg0vsqq": {}}, "user_id": "XzKmpfZk"}, {"extra_attributes": {"9JtvCHPu": {}, "wOj4nd8M": {}, "BoZZHWMW": {}}, "user_id": "1P4TmL7d"}], "ticket_created_at": 12, "ticket_id": "FSkQ7Nm1"}, {"first_ticket_created_at": 32, "party_attributes": {"XUdajDdm": {}, "AIBShNtj": {}, "UObxRjy2": {}}, "party_id": "3hIZ55S3", "party_members": [{"extra_attributes": {"tUWxJyM1": {}, "Dh0C80nK": {}, "4sdLSyAE": {}}, "user_id": "seZAymae"}, {"extra_attributes": {"xW8ept8n": {}, "mFUkaIUj": {}, "IGTR0lMH": {}}, "user_id": "xEgzxRrx"}, {"extra_attributes": {"11467I90": {}, "sfbLvDt8": {}, "sps6RhAO": {}}, "user_id": "DDPL0SLt"}], "ticket_created_at": 15, "ticket_id": "8fJjDDQ4"}]}, {"matching_parties": [{"first_ticket_created_at": 14, "party_attributes": {"V2omP779": {}, "hBXq5MZb": {}, "fmeTsJAU": {}}, "party_id": "9hle5P2b", "party_members": [{"extra_attributes": {"QFCfZ8wP": {}, "fg3uQx09": {}, "Yo3cXy9x": {}}, "user_id": "LSS8p7Pz"}, {"extra_attributes": {"rCmNLp0I": {}, "pqJczdqD": {}, "UNAnTM6S": {}}, "user_id": "E7E5nh3p"}, {"extra_attributes": {"uRIW10wg": {}, "xCg1gshr": {}, "d71aywXc": {}}, "user_id": "8kOh9djA"}], "ticket_created_at": 46, "ticket_id": "CBuqmsxx"}, {"first_ticket_created_at": 83, "party_attributes": {"DN1XtYHg": {}, "wcof3IOg": {}, "MzGk4OBQ": {}}, "party_id": "tH1kNSp3", "party_members": [{"extra_attributes": {"EFtePEfE": {}, "ZsJJm1tu": {}, "AP2Ln8Ap": {}}, "user_id": "n0XFKqVI"}, {"extra_attributes": {"soRAt8vN": {}, "Ig4zhCuL": {}, "z4mdY5wC": {}}, "user_id": "pfTdViqu"}, {"extra_attributes": {"yzy0ahrY": {}, "cCQcnY35": {}, "MFvjk8uZ": {}}, "user_id": "urKNyTq2"}], "ticket_created_at": 54, "ticket_id": "rM53MRfx"}, {"first_ticket_created_at": 16, "party_attributes": {"tqLxZdoM": {}, "XxVApTpZ": {}, "JLUVDwg0": {}}, "party_id": "36ZrLuUA", "party_members": [{"extra_attributes": {"ZRsB1xYC": {}, "UP9umnyA": {}, "71TEOKhB": {}}, "user_id": "Gu8wYMxm"}, {"extra_attributes": {"pU9xJWaw": {}, "aCRgg09g": {}, "gvZkHu25": {}}, "user_id": "A8YX9aHR"}, {"extra_attributes": {"niWITrdM": {}, "9FEqkWo9": {}, "L4HHbhLq": {}}, "user_id": "yz1UQ5yO"}], "ticket_created_at": 28, "ticket_id": "S7oJMjVP"}]}], "namespace": "QSu1HpeF", "party_attributes": {"RHND51we": {}, "at0pALHt": {}, "PizR2t7h": {}}, "party_id": "5B6wCOmC", "queued_at": 81, "region": "SLmZ4IOw", "server_name": "byFz1g7f", "status": "x7GLsqlK", "ticket_id": "DG2Bq96G", "ticket_ids": ["fuPq3e0E", "cmkjHaUU", "QQXaPCxZ"], "updated_at": "1996-10-22T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "vCuCtUKo"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID '70gbaNK0' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 33, "userID": "qCKzYQCM", "weight": 0.3172342688054578}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'q24ScgpX' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'apMbASDw' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName '7zcMOO0b' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatchOnDifferentTeam", "deployment": "dqNoBN7u", "description": "vIKjTCEV", "findMatchTimeoutSeconds": 11, "joinable": false, "max_delay_ms": 61, "region_expansion_range_ms": 53, "region_expansion_rate_ms": 61, "region_latency_initial_range_ms": 8, "region_latency_max_ms": 2, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 100, "min": 31, "name": "WwTdOMxR"}, {"max": 17, "min": 39, "name": "mSmXk8er"}, {"max": 66, "min": 46, "name": "2UfiswkV"}], [{"max": 27, "min": 93, "name": "P33s6712"}, {"max": 52, "min": 49, "name": "zM8jKZFL"}, {"max": 90, "min": 18, "name": "xt7d7qCG"}], [{"max": 92, "min": 81, "name": "OIbfiFys"}, {"max": 6, "min": 50, "name": "ENwI5pEj"}, {"max": 87, "min": 73, "name": "38C3OaOj"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 45, "role_flexing_second": 94}, "maxNumber": 78, "minNumber": 76, "playerMaxNumber": 17, "playerMinNumber": 85}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 99, "min": 69, "name": "MbXbn9qi"}, {"max": 55, "min": 22, "name": "bDkZmKLy"}, {"max": 48, "min": 53, "name": "UUqXfT6L"}], [{"max": 61, "min": 94, "name": "b9YWqMd7"}, {"max": 85, "min": 5, "name": "q0DgEhu2"}, {"max": 59, "min": 36, "name": "9eQAgL3i"}], [{"max": 99, "min": 24, "name": "3ZzrtzcZ"}, {"max": 45, "min": 14, "name": "PiYwFWCB"}, {"max": 36, "min": 10, "name": "pT5LRBK3"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 65, "role_flexing_second": 66}, "duration": 36, "max_number": 79, "min_number": 14, "player_max_number": 69, "player_min_number": 39}, {"combination": {"alliances": [[{"max": 55, "min": 59, "name": "enQlVkxK"}, {"max": 49, "min": 46, "name": "M35D7gvG"}, {"max": 40, "min": 37, "name": "95mIB8mW"}], [{"max": 27, "min": 49, "name": "pAe7ayLt"}, {"max": 26, "min": 3, "name": "rA9px0Kl"}, {"max": 7, "min": 18, "name": "eEA3mhk2"}], [{"max": 6, "min": 85, "name": "XAItNbZl"}, {"max": 34, "min": 33, "name": "cCCn2dFn"}, {"max": 80, "min": 18, "name": "P7EQA08g"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 75, "role_flexing_second": 37}, "duration": 45, "max_number": 73, "min_number": 21, "player_max_number": 11, "player_min_number": 50}, {"combination": {"alliances": [[{"max": 42, "min": 2, "name": "8GSd5z7G"}, {"max": 9, "min": 44, "name": "k1BXoIPy"}, {"max": 79, "min": 8, "name": "k4bR9RXo"}], [{"max": 72, "min": 9, "name": "iPa5ghku"}, {"max": 22, "min": 15, "name": "MHcbdzyi"}, {"max": 38, "min": 61, "name": "b4rXDVLD"}], [{"max": 55, "min": 94, "name": "ne8j0Fcs"}, {"max": 14, "min": 100, "name": "tjw3B4vB"}, {"max": 98, "min": 29, "name": "kyrou8Sc"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 43, "role_flexing_second": 35}, "duration": 42, "max_number": 25, "min_number": 60, "player_max_number": 91, "player_min_number": 33}], "batch_size": 18, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 6, "flex_flat_step_range": 44, "flex_immunity_count": 25, "flex_range_max": 35, "flex_rate_ms": 67, "flex_step_max": 90, "force_authority_match": false, "initial_step_range": 5, "mmr_max": 79, "mmr_mean": 87, "mmr_min": 98, "mmr_std_dev": 87, "override_mmr_data": true, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexingRules": [{"attribute": "Q9woGzBr", "criteria": "02wAVdP0", "duration": 60, "reference": 0.211087290425636}, {"attribute": "s1JBPPPQ", "criteria": "hd2rMpEg", "duration": 10, "reference": 0.23177479133750378}, {"attribute": "a6OQO0cK", "criteria": "FRZ4qCpS", "duration": 81, "reference": 0.09935888442192042}], "match_options": {"options": [{"name": "7FvRRi55", "type": "eJQP6rOm"}, {"name": "XSS0tYKU", "type": "Xa5GtdXw"}, {"name": "diMb5t42", "type": "f1fZ9x89"}]}, "matchingRules": [{"attribute": "SEtVdxGe", "criteria": "glgdtHuA", "reference": 0.5672918634179982}, {"attribute": "AS1bFdPp", "criteria": "5mjWiD6F", "reference": 0.7109004960171172}, {"attribute": "WmUpd4Wp", "criteria": "TDNEAzUx", "reference": 0.1304218081591476}], "sort_ticket": {"search_result": "none", "ticket_queue": "random"}, "sort_tickets": [{"search_result": "oldestTicketAge", "threshold": 93, "ticket_queue": "random"}, {"search_result": "oldestTicketAge", "threshold": 43, "ticket_queue": "distance"}, {"search_result": "none", "threshold": 62, "ticket_queue": "largestPartySize"}], "sub_game_modes": {}, "ticket_flexing_selection": "random", "ticket_flexing_selections": [{"selection": "random", "threshold": 80}, {"selection": "oldest", "threshold": 58}, {"selection": "random", "threshold": 39}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 17, "socialMatchmaking": true, "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'XwR662lU' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'HadEhz3m' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'IcVPeuh0' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 59}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'X6Aw9cYN' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'yZ2JeM2Z' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "9Xi7Fquc", "count": 37, "mmrMax": 0.2732929774805064, "mmrMean": 0.9812948859165185, "mmrMin": 0.08368770567073103, "mmrStdDev": 0.27953749638468395}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'Vg6ybx0O' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 74, "party_attributes": {"rRp7wHft": {}, "3yBSF35N": {}, "sVSsZN1p": {}}, "party_id": "9EN3xulS", "party_members": [{"extra_attributes": {"QvdVM5HY": {}, "5CAxoUQk": {}, "IrhFCDcx": {}}, "user_id": "k2OIiDVk"}, {"extra_attributes": {"JJQohWBs": {}, "MnnqjHYr": {}, "IAqcKg12": {}}, "user_id": "ZMlSTsZ7"}, {"extra_attributes": {"nDuWc0nl": {}, "osBjothB": {}, "39ueaqPC": {}}, "user_id": "LzIpsU4Q"}], "ticket_created_at": 100, "ticket_id": "Le43D5ms"}, {"first_ticket_created_at": 75, "party_attributes": {"j6FX2o0d": {}, "67Hl9VhX": {}, "nhb56n2D": {}}, "party_id": "Jejn78N4", "party_members": [{"extra_attributes": {"YSJSqu7o": {}, "TkDYi3Xr": {}, "K625NERm": {}}, "user_id": "JFeAJa6M"}, {"extra_attributes": {"1MKnd2Uh": {}, "NsVJm6Fb": {}, "U1KYu4Nf": {}}, "user_id": "Pf9QUTKG"}, {"extra_attributes": {"QopbloUQ": {}, "PeSIBR9j": {}, "4pS8wG1y": {}}, "user_id": "RV9JiDMN"}], "ticket_created_at": 79, "ticket_id": "tM9TBu4a"}, {"first_ticket_created_at": 52, "party_attributes": {"yPGdTgUu": {}, "DYbBrBvm": {}, "rAjX3Gng": {}}, "party_id": "2CcZ65ZJ", "party_members": [{"extra_attributes": {"uBQO1JPB": {}, "gD1lNEpN": {}, "kgNBnXKu": {}}, "user_id": "hfTlQ11n"}, {"extra_attributes": {"qKXBfgX5": {}, "RLepfHj5": {}, "LZaFubBd": {}}, "user_id": "9N1HKBSP"}, {"extra_attributes": {"IBB0Rjxx": {}, "nHqJNQKS": {}, "FOuF1qNz": {}}, "user_id": "C8nHUrup"}], "ticket_created_at": 35, "ticket_id": "YuvmsV2L"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'NODSRl1E' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 47}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'M50Rv5ff' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'W34dDp46' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'M2mGNZHx' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["zOmwL81f", "OVseTtb1", "uSqiX6ky"], "party_id": "A1Gxat6t", "user_id": "crUQN9eq"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'kY06KS8b' \
    --matchID 'Q7BWlHKh' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'V3wYQlwj' \
    --matchID 'bzPeFXpi' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'wgvUbpXa' \
    --matchID 'nW6yXaWQ' \
    --namespace $AB_NAMESPACE \
    --userID 'olPU2KiR' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'eagjRmq6' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'rmeEE9Zp' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE