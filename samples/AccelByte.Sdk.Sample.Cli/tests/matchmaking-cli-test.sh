#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '62' \
    --offset '8' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatch", "deployment": "ZbaVTZ6a", "description": "Zy8Yn7QD", "find_match_timeout_seconds": 65, "game_mode": "LnLFHGhT", "joinable": false, "max_delay_ms": 42, "region_expansion_range_ms": 82, "region_expansion_rate_ms": 47, "region_latency_initial_range_ms": 80, "region_latency_max_ms": 75, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 21, "min": 22, "name": "baEDT3md"}, {"max": 53, "min": 68, "name": "6lwjYRVt"}, {"max": 2, "min": 87, "name": "1uFXe7t7"}], [{"max": 78, "min": 97, "name": "VAk7RVlY"}, {"max": 22, "min": 88, "name": "CYtnl8Bi"}, {"max": 77, "min": 28, "name": "PFEJkLAJ"}], [{"max": 74, "min": 44, "name": "me3KSg85"}, {"max": 94, "min": 35, "name": "ckAFSx7e"}, {"max": 43, "min": 29, "name": "SYSRx9TB"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 10, "role_flexing_second": 15}, "max_number": 50, "min_number": 91, "player_max_number": 91, "player_min_number": 30}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 4, "min": 52, "name": "kjR94mJY"}, {"max": 35, "min": 65, "name": "3Z9OKntA"}, {"max": 81, "min": 50, "name": "VT1m6ZcN"}], [{"max": 4, "min": 33, "name": "zqitALt2"}, {"max": 19, "min": 90, "name": "IiU3Unml"}, {"max": 43, "min": 46, "name": "lOmtZshx"}], [{"max": 11, "min": 11, "name": "UW9fGmrj"}, {"max": 52, "min": 70, "name": "GQVhHEYI"}, {"max": 25, "min": 53, "name": "WGkOLGRb"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 56, "role_flexing_second": 2}, "duration": 94, "max_number": 41, "min_number": 3, "player_max_number": 84, "player_min_number": 91}, {"combination": {"alliances": [[{"max": 3, "min": 27, "name": "AyATHvny"}, {"max": 14, "min": 69, "name": "3U7dblWU"}, {"max": 72, "min": 44, "name": "2fzWTCTj"}], [{"max": 54, "min": 14, "name": "63T4feYa"}, {"max": 29, "min": 0, "name": "yoq3BsJv"}, {"max": 29, "min": 88, "name": "pJwZLKv8"}], [{"max": 11, "min": 30, "name": "fBG0OvhZ"}, {"max": 58, "min": 56, "name": "RsDNyO9I"}, {"max": 19, "min": 80, "name": "TF4PBemP"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 9, "role_flexing_second": 77}, "duration": 72, "max_number": 10, "min_number": 90, "player_max_number": 4, "player_min_number": 7}, {"combination": {"alliances": [[{"max": 55, "min": 65, "name": "K1BZQXgw"}, {"max": 20, "min": 38, "name": "ZZvn4H3M"}, {"max": 22, "min": 82, "name": "8rRInAq8"}], [{"max": 3, "min": 52, "name": "EoV65vo0"}, {"max": 28, "min": 62, "name": "2uwKhgxz"}, {"max": 51, "min": 65, "name": "j7PThzTo"}], [{"max": 94, "min": 48, "name": "YO2eNsrV"}, {"max": 57, "min": 59, "name": "gbuL0uys"}, {"max": 7, "min": 69, "name": "1bLCNuwv"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 24, "role_flexing_second": 80}, "duration": 91, "max_number": 25, "min_number": 73, "player_max_number": 5, "player_min_number": 0}], "batch_size": 21, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 70, "flex_flat_step_range": 20, "flex_immunity_count": 99, "flex_range_max": 32, "flex_rate_ms": 5, "flex_step_max": 47, "force_authority_match": true, "initial_step_range": 72, "mmr_max": 19, "mmr_mean": 7, "mmr_min": 86, "mmr_std_dev": 16, "override_mmr_data": true, "use_bucket_mmr": false, "use_flat_flex_step": false}, "flexing_rule": [{"attribute": "f5xbU1Ob", "criteria": "nOHnXEBB", "duration": 95, "reference": 0.6946767076641691}, {"attribute": "uWK0JndL", "criteria": "cf53mKSh", "duration": 98, "reference": 0.537897937539256}, {"attribute": "TOv2251B", "criteria": "gRGXoJXb", "duration": 99, "reference": 0.29256848500670074}], "match_options": {"options": [{"name": "GfeMDLPE", "type": "DC9R40pb"}, {"name": "p3Pmuogb", "type": "cXFGO7Xk"}, {"name": "JHJ8X5ng", "type": "Nopvybee"}]}, "matching_rule": [{"attribute": "4qOIGx2Z", "criteria": "393jqGbb", "reference": 0.01838830764707733}, {"attribute": "z1L4APCe", "criteria": "qY7gbsAJ", "reference": 0.8127467831302555}, {"attribute": "3zvirRWt", "criteria": "FF6AwsAR", "reference": 0.7048562199472862}], "rebalance_enable": true, "sort_ticket": {"search_result": "oldestTicketAge", "ticket_queue": "none"}, "sort_tickets": [{"search_result": "distance", "threshold": 56, "ticket_queue": "none"}, {"search_result": "random", "threshold": 13, "ticket_queue": "none"}, {"search_result": "largestPartySize", "threshold": 95, "ticket_queue": "random"}], "sub_game_modes": {"foWymPRV": {"alliance": {"combination": {"alliances": [[{"max": 30, "min": 94, "name": "7vdiqfGP"}, {"max": 93, "min": 62, "name": "coLYaPKk"}, {"max": 74, "min": 89, "name": "O6HKhZAD"}], [{"max": 4, "min": 74, "name": "tEqHcBAa"}, {"max": 72, "min": 47, "name": "nXHp1mRl"}, {"max": 29, "min": 81, "name": "wYmX41en"}], [{"max": 33, "min": 90, "name": "y8s0oIHm"}, {"max": 85, "min": 9, "name": "VQLe6RtZ"}, {"max": 32, "min": 14, "name": "fIzQIhk1"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 66, "role_flexing_second": 61}, "max_number": 45, "min_number": 8, "player_max_number": 78, "player_min_number": 30}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 45, "min": 60, "name": "n0pGHxYv"}, {"max": 82, "min": 32, "name": "AQLq9jhK"}, {"max": 78, "min": 59, "name": "sSl0ScYg"}], [{"max": 70, "min": 28, "name": "gCczcGAd"}, {"max": 22, "min": 74, "name": "EpzZkCZO"}, {"max": 55, "min": 26, "name": "pQfVfcBx"}], [{"max": 98, "min": 5, "name": "knKfIvvw"}, {"max": 55, "min": 32, "name": "RIpJVAMH"}, {"max": 39, "min": 12, "name": "NKz21QqC"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 18, "role_flexing_second": 62}, "duration": 28, "max_number": 34, "min_number": 34, "player_max_number": 88, "player_min_number": 22}, {"combination": {"alliances": [[{"max": 29, "min": 14, "name": "BOOEA4bB"}, {"max": 72, "min": 64, "name": "j0stqBAj"}, {"max": 43, "min": 3, "name": "fpVDUepa"}], [{"max": 7, "min": 56, "name": "JDTmTO6A"}, {"max": 29, "min": 50, "name": "E6MHxVSo"}, {"max": 77, "min": 91, "name": "vydr7c3i"}], [{"max": 7, "min": 80, "name": "QWtOBC4u"}, {"max": 21, "min": 85, "name": "aYCrOhAC"}, {"max": 68, "min": 52, "name": "Fk6q2OLG"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 46, "role_flexing_second": 94}, "duration": 1, "max_number": 65, "min_number": 98, "player_max_number": 4, "player_min_number": 1}, {"combination": {"alliances": [[{"max": 66, "min": 11, "name": "SYzcZ4Ad"}, {"max": 22, "min": 30, "name": "eDb3Cdd8"}, {"max": 76, "min": 85, "name": "aFNYOY37"}], [{"max": 70, "min": 75, "name": "i1HSmrQL"}, {"max": 95, "min": 13, "name": "7UgRuUIN"}, {"max": 78, "min": 77, "name": "HWDlK1tm"}], [{"max": 73, "min": 20, "name": "r8Ni6gj0"}, {"max": 37, "min": 91, "name": "8JjIa9Wo"}, {"max": 67, "min": 75, "name": "PddNkcIq"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 63, "role_flexing_second": 66}, "duration": 81, "max_number": 78, "min_number": 50, "player_max_number": 42, "player_min_number": 52}], "name": "909pQkCQ"}, "3Qlj3tJe": {"alliance": {"combination": {"alliances": [[{"max": 89, "min": 49, "name": "lmsioFyu"}, {"max": 60, "min": 40, "name": "9twMTmxr"}, {"max": 3, "min": 21, "name": "Nl2zb7oX"}], [{"max": 29, "min": 14, "name": "8rfwiXIC"}, {"max": 29, "min": 17, "name": "Do05CBrl"}, {"max": 67, "min": 29, "name": "DEQZYMjY"}], [{"max": 35, "min": 60, "name": "rpWTDYlL"}, {"max": 63, "min": 4, "name": "GwlUMPI4"}, {"max": 32, "min": 63, "name": "V2jt46a5"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 39, "role_flexing_second": 76}, "max_number": 2, "min_number": 15, "player_max_number": 48, "player_min_number": 64}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 9, "min": 49, "name": "GEyl9oOK"}, {"max": 92, "min": 9, "name": "tcurSxq0"}, {"max": 74, "min": 39, "name": "OhgwKdqY"}], [{"max": 52, "min": 29, "name": "EfwPMynu"}, {"max": 71, "min": 52, "name": "3d0L63ir"}, {"max": 99, "min": 94, "name": "ELu3yMiX"}], [{"max": 12, "min": 23, "name": "u80dsnT8"}, {"max": 43, "min": 99, "name": "V5f2mUCd"}, {"max": 70, "min": 35, "name": "70mKTyI8"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 29, "role_flexing_second": 33}, "duration": 94, "max_number": 17, "min_number": 80, "player_max_number": 9, "player_min_number": 76}, {"combination": {"alliances": [[{"max": 21, "min": 74, "name": "9ddmcLkZ"}, {"max": 77, "min": 34, "name": "OGz7Cywn"}, {"max": 91, "min": 32, "name": "pLVHq8sG"}], [{"max": 80, "min": 69, "name": "3wDrQgq6"}, {"max": 95, "min": 85, "name": "NitvAzzz"}, {"max": 25, "min": 52, "name": "OOMMqxvA"}], [{"max": 50, "min": 35, "name": "qwV6Y3f7"}, {"max": 13, "min": 34, "name": "YTIqQ4Lf"}, {"max": 52, "min": 89, "name": "wzL1G2B7"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 98, "role_flexing_second": 2}, "duration": 99, "max_number": 24, "min_number": 85, "player_max_number": 100, "player_min_number": 76}, {"combination": {"alliances": [[{"max": 59, "min": 40, "name": "24oVDkC7"}, {"max": 17, "min": 32, "name": "8ZyJnCUS"}, {"max": 57, "min": 5, "name": "3fILeGg6"}], [{"max": 64, "min": 97, "name": "XPpbDCTf"}, {"max": 53, "min": 48, "name": "xeo8mwuD"}, {"max": 77, "min": 54, "name": "ksKk5Juy"}], [{"max": 8, "min": 39, "name": "oICt4fpO"}, {"max": 27, "min": 90, "name": "Z6NRDGJ5"}, {"max": 19, "min": 15, "name": "FYW2MwMg"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 75, "role_flexing_second": 86}, "duration": 88, "max_number": 89, "min_number": 63, "player_max_number": 72, "player_min_number": 80}], "name": "Ab9JDK9w"}, "o77OSnJX": {"alliance": {"combination": {"alliances": [[{"max": 35, "min": 61, "name": "E8nYowVg"}, {"max": 13, "min": 92, "name": "TBdu2pi3"}, {"max": 28, "min": 96, "name": "kAbvbcVJ"}], [{"max": 60, "min": 77, "name": "DjblvEIy"}, {"max": 49, "min": 70, "name": "0efEKODu"}, {"max": 30, "min": 44, "name": "qW8WGSbt"}], [{"max": 42, "min": 75, "name": "SaboB5RG"}, {"max": 29, "min": 14, "name": "pJYZffdI"}, {"max": 11, "min": 29, "name": "X1XASais"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 50, "role_flexing_second": 52}, "max_number": 35, "min_number": 24, "player_max_number": 34, "player_min_number": 35}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 62, "min": 75, "name": "A6m4CYwB"}, {"max": 40, "min": 51, "name": "MjjyE4vI"}, {"max": 19, "min": 65, "name": "Cxsu3Vue"}], [{"max": 23, "min": 78, "name": "lUKrYxyL"}, {"max": 95, "min": 12, "name": "MzaYqQsR"}, {"max": 42, "min": 63, "name": "4QGwz1sK"}], [{"max": 72, "min": 81, "name": "lSkGugkV"}, {"max": 70, "min": 39, "name": "6nlPAc4F"}, {"max": 92, "min": 34, "name": "32fimjvF"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 7, "role_flexing_second": 45}, "duration": 9, "max_number": 12, "min_number": 39, "player_max_number": 22, "player_min_number": 62}, {"combination": {"alliances": [[{"max": 64, "min": 22, "name": "1ZY8Buay"}, {"max": 84, "min": 90, "name": "O8H62Wst"}, {"max": 49, "min": 98, "name": "k7hG4I1C"}], [{"max": 99, "min": 7, "name": "2PkY3Adz"}, {"max": 84, "min": 75, "name": "303tjE6L"}, {"max": 54, "min": 84, "name": "fCPn3SQf"}], [{"max": 8, "min": 19, "name": "75egvxCp"}, {"max": 23, "min": 42, "name": "wy9B8szB"}, {"max": 93, "min": 83, "name": "HIdYAc1I"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 82, "role_flexing_second": 32}, "duration": 66, "max_number": 54, "min_number": 0, "player_max_number": 37, "player_min_number": 83}, {"combination": {"alliances": [[{"max": 3, "min": 45, "name": "c0XsRXSF"}, {"max": 4, "min": 93, "name": "erPnv2My"}, {"max": 64, "min": 4, "name": "NJHXHkWn"}], [{"max": 66, "min": 85, "name": "hjpISLsp"}, {"max": 88, "min": 0, "name": "L4e0Zspq"}, {"max": 62, "min": 68, "name": "TqUUgAsP"}], [{"max": 50, "min": 45, "name": "Wv0mptfx"}, {"max": 15, "min": 28, "name": "0ICXz0J9"}, {"max": 56, "min": 11, "name": "rsUPFVlz"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 61, "role_flexing_second": 40}, "duration": 31, "max_number": 72, "min_number": 57, "player_max_number": 22, "player_min_number": 21}], "name": "IILtC9YV"}}, "ticket_flexing_selection": "pivot", "ticket_flexing_selections": [{"selection": "pivot", "threshold": 62}, {"selection": "oldest", "threshold": 17}, {"selection": "random", "threshold": 22}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 32, "social_matchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'Dfbqe1uG' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'lKjsehF7' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "9tiRS4u2", "players": [{"results": [{"attribute": "6temYPnY", "value": 0.20977721839210717}, {"attribute": "RQpAyJk8", "value": 0.8078461959653169}, {"attribute": "OSYOXLmo", "value": 0.9112073646608919}], "user_id": "uDZiksMe"}, {"results": [{"attribute": "SaTlxurD", "value": 0.3571859310442024}, {"attribute": "G1s82CK2", "value": 0.10822992615196436}, {"attribute": "X3lX9cZl", "value": 0.20153487893429844}], "user_id": "U5KLBN9A"}, {"results": [{"attribute": "Oqqn5imB", "value": 0.7319043056189353}, {"attribute": "Pb5cg4m7", "value": 0.1287724903671451}, {"attribute": "IK5kvSth", "value": 0.29336265804624573}], "user_id": "jupeRQAq"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "MFgzqaCN"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "3E13f2ib", "client_version": "RRFJhoey", "deployment": "RkgF4JhB", "error_code": 79, "error_message": "HJMFeNeN", "game_mode": "gZhs2G1m", "is_mock": "StgjirBR", "joinable": true, "match_id": "ZbeV2VK1", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 35, "party_attributes": {"a4nC9oZw": {}, "4xyIDzt2": {}, "4GFpDyV8": {}}, "party_id": "1DiwZpD3", "party_members": [{"extra_attributes": {"cAc88lN4": {}, "84jildfC": {}, "0RYADrBN": {}}, "user_id": "7i3meIMS"}, {"extra_attributes": {"jTWiEWXC": {}, "C4FcbMQg": {}, "jKaiLkUO": {}}, "user_id": "qHu9564W"}, {"extra_attributes": {"Rljn6qsA": {}, "OPtILdg0": {}, "xnLc2YHP": {}}, "user_id": "zqee7xAN"}], "ticket_created_at": 93, "ticket_id": "EwMwICqE"}, {"first_ticket_created_at": 36, "party_attributes": {"nbYg49Uf": {}, "Dcej8h4V": {}, "rkpfJuAn": {}}, "party_id": "tv0V3ZYs", "party_members": [{"extra_attributes": {"J8rhkStw": {}, "biTX5s9e": {}, "caOFvZcz": {}}, "user_id": "t6LPglnW"}, {"extra_attributes": {"Dws5PGQa": {}, "6D23fo9j": {}, "eUTyM6dO": {}}, "user_id": "xpTxdPtB"}, {"extra_attributes": {"SQd2QHAG": {}, "c4zFyYFh": {}, "RvXaKvcb": {}}, "user_id": "kDlEgFQE"}], "ticket_created_at": 76, "ticket_id": "IdSutYSB"}, {"first_ticket_created_at": 31, "party_attributes": {"mRr0TgmP": {}, "kUyvjmEv": {}, "MbDubFQf": {}}, "party_id": "PH1WPlk5", "party_members": [{"extra_attributes": {"5iMTm9K5": {}, "bjlrOq8m": {}, "y24YBkGC": {}}, "user_id": "zybZVBYD"}, {"extra_attributes": {"aZCrK5bI": {}, "a1NuCmbw": {}, "9b5OrtxL": {}}, "user_id": "rFuU05MB"}, {"extra_attributes": {"O7hjv1gL": {}, "OroEdKQJ": {}, "1NYbDLgN": {}}, "user_id": "vofMZf1p"}], "ticket_created_at": 36, "ticket_id": "qPvjiZ3Q"}]}, {"matching_parties": [{"first_ticket_created_at": 68, "party_attributes": {"11EsAjck": {}, "qKTc46Lh": {}, "JlsuaPKg": {}}, "party_id": "TeF8nuYF", "party_members": [{"extra_attributes": {"b2tnNNAy": {}, "EsLmGwIT": {}, "T2OAEivt": {}}, "user_id": "Wotdps3C"}, {"extra_attributes": {"d15lGROw": {}, "2a0MirzQ": {}, "EdgnmBHZ": {}}, "user_id": "kKFd6gmY"}, {"extra_attributes": {"TYu5GkQK": {}, "sKzHNeaV": {}, "68gx2JFR": {}}, "user_id": "jlvrFyZk"}], "ticket_created_at": 59, "ticket_id": "331C7COD"}, {"first_ticket_created_at": 24, "party_attributes": {"3NhYjlBT": {}, "nHBV46N4": {}, "z6CEBEhI": {}}, "party_id": "ld8NdRao", "party_members": [{"extra_attributes": {"qeM9VHze": {}, "4I0pAqjt": {}, "Spg5w8VO": {}}, "user_id": "PaOETY5S"}, {"extra_attributes": {"gnjleRMw": {}, "cb2uIfoB": {}, "RP15Tp9x": {}}, "user_id": "sh6gxhks"}, {"extra_attributes": {"0RwJytT4": {}, "FzKMfhmw": {}, "NRZ3FNmm": {}}, "user_id": "eprvNYjH"}], "ticket_created_at": 51, "ticket_id": "HPmKLWCx"}, {"first_ticket_created_at": 69, "party_attributes": {"wEEXo9Xp": {}, "zDQltIOA": {}, "UWonUTjE": {}}, "party_id": "aHYSsju8", "party_members": [{"extra_attributes": {"EnD7HM8D": {}, "TDkeM5HS": {}, "YCbE9H0C": {}}, "user_id": "Krx0VzCJ"}, {"extra_attributes": {"TxPh32xZ": {}, "fWjlz4Yx": {}, "Rqu0aWGu": {}}, "user_id": "caGqivcp"}, {"extra_attributes": {"QUo1ySYe": {}, "pRw8RQRA": {}, "UTXGU5L6": {}}, "user_id": "GVUvRSJd"}], "ticket_created_at": 35, "ticket_id": "1ltTBt7a"}]}, {"matching_parties": [{"first_ticket_created_at": 84, "party_attributes": {"raHCiOoP": {}, "OBnRYKv3": {}, "PprFzT9X": {}}, "party_id": "KNG1E4tJ", "party_members": [{"extra_attributes": {"gu32pDwB": {}, "IP4pD2sZ": {}, "wpdziyBW": {}}, "user_id": "Z0C4eYCn"}, {"extra_attributes": {"WWxsxxJR": {}, "WXZZUaIk": {}, "IsWLvjPI": {}}, "user_id": "ytJZy6tm"}, {"extra_attributes": {"OXs7Mer1": {}, "gPpozwuo": {}, "i68PASMD": {}}, "user_id": "01AMMrU5"}], "ticket_created_at": 8, "ticket_id": "YvrMYQtv"}, {"first_ticket_created_at": 45, "party_attributes": {"ppbznsGW": {}, "yrWhDPkF": {}, "UW0AHifc": {}}, "party_id": "Npqbc0ZE", "party_members": [{"extra_attributes": {"cU7oIWs5": {}, "Etlq6MKW": {}, "As4Gpswk": {}}, "user_id": "YkBz62lF"}, {"extra_attributes": {"qOTIgoE0": {}, "B6Dqd5as": {}, "KEfVpbFq": {}}, "user_id": "uZ9FGgAn"}, {"extra_attributes": {"s53E1qVq": {}, "yulGtm4Z": {}, "amXKSV1A": {}}, "user_id": "VtBbNL0n"}], "ticket_created_at": 35, "ticket_id": "YBt8tFch"}, {"first_ticket_created_at": 38, "party_attributes": {"tsQLX7kt": {}, "5IoQbAKF": {}, "GI8Fl9mb": {}}, "party_id": "2k2yqp5t", "party_members": [{"extra_attributes": {"MIsnzVTv": {}, "ZvBvAEeh": {}, "BdpZjutW": {}}, "user_id": "S6AKX5ou"}, {"extra_attributes": {"umQ4YreK": {}, "6LiklQSJ": {}, "i7M11Lqd": {}}, "user_id": "RrJE9b3F"}, {"extra_attributes": {"hi26Xdve": {}, "W5kIw8nd": {}, "7kFgwSyy": {}}, "user_id": "i4mKEyrm"}], "ticket_created_at": 45, "ticket_id": "aTiBi0vI"}]}], "namespace": "wBkF03qf", "party_attributes": {"BxRIR77Q": {}, "TyWYp5A0": {}, "s9jhgXVW": {}}, "party_id": "wMkXcIeS", "queued_at": 80, "region": "FgEmJshU", "server_name": "spPleJHI", "status": "qaWo9wut", "ticket_id": "14xAqRAB", "ticket_ids": ["s1yKKOwv", "3xUdPewO", "IeqSrRTn"], "updated_at": "1974-10-14T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "VSqi1lsl"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID '4wfi5Aly' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 69, "userID": "8g2snPGG", "weight": 0.7093525223865623}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'RgiH4X33' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy 'wwIfIql8' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'sa5PbY5T' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatchOnDifferentTeam", "deployment": "l8hzGXtK", "description": "2r02dCvk", "findMatchTimeoutSeconds": 10, "joinable": true, "max_delay_ms": 49, "region_expansion_range_ms": 89, "region_expansion_rate_ms": 68, "region_latency_initial_range_ms": 73, "region_latency_max_ms": 62, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 23, "min": 95, "name": "ov53C9x4"}, {"max": 52, "min": 57, "name": "tXLFp7Zp"}, {"max": 49, "min": 39, "name": "qsFQz2Yw"}], [{"max": 46, "min": 64, "name": "urSiP6DD"}, {"max": 100, "min": 40, "name": "25BjY34q"}, {"max": 90, "min": 61, "name": "9ZHIcZYc"}], [{"max": 31, "min": 94, "name": "3cUWv5Kq"}, {"max": 2, "min": 27, "name": "YIblOdXc"}, {"max": 48, "min": 25, "name": "OxDepAYn"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 33, "role_flexing_second": 46}, "maxNumber": 12, "minNumber": 49, "playerMaxNumber": 21, "playerMinNumber": 35}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 16, "min": 16, "name": "LOCZvmug"}, {"max": 2, "min": 66, "name": "OBXdrjbs"}, {"max": 16, "min": 96, "name": "p17vQzVR"}], [{"max": 66, "min": 29, "name": "qCDtsKtg"}, {"max": 3, "min": 14, "name": "kN7DSKac"}, {"max": 37, "min": 45, "name": "cmFmMq6R"}], [{"max": 15, "min": 6, "name": "A1r2ZaI1"}, {"max": 39, "min": 21, "name": "zuTnHF37"}, {"max": 99, "min": 55, "name": "gJM4bmZq"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 49, "role_flexing_second": 83}, "duration": 36, "max_number": 27, "min_number": 25, "player_max_number": 40, "player_min_number": 72}, {"combination": {"alliances": [[{"max": 67, "min": 84, "name": "1UH0N1G5"}, {"max": 54, "min": 21, "name": "jXlMnOrS"}, {"max": 26, "min": 37, "name": "Rx3teWkp"}], [{"max": 51, "min": 20, "name": "hrOMqaDU"}, {"max": 59, "min": 19, "name": "E3PrCbGU"}, {"max": 34, "min": 53, "name": "EA42eyLq"}], [{"max": 41, "min": 34, "name": "B66qo2So"}, {"max": 24, "min": 81, "name": "edaiAGr5"}, {"max": 85, "min": 20, "name": "StFfiUvu"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 22, "role_flexing_second": 34}, "duration": 13, "max_number": 61, "min_number": 8, "player_max_number": 4, "player_min_number": 65}, {"combination": {"alliances": [[{"max": 31, "min": 68, "name": "nDcOvvov"}, {"max": 11, "min": 19, "name": "xPuGxXM8"}, {"max": 75, "min": 73, "name": "KliUgq4c"}], [{"max": 80, "min": 89, "name": "ADSAmEwm"}, {"max": 49, "min": 61, "name": "yDRVRQeK"}, {"max": 68, "min": 89, "name": "Fe4KSZJW"}], [{"max": 7, "min": 42, "name": "JQ8BJ3ww"}, {"max": 68, "min": 45, "name": "Dw6kMl9q"}, {"max": 30, "min": 1, "name": "1BfFCXBp"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 12, "role_flexing_second": 33}, "duration": 44, "max_number": 31, "min_number": 14, "player_max_number": 21, "player_min_number": 48}], "batch_size": 54, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 89, "flex_flat_step_range": 97, "flex_immunity_count": 93, "flex_range_max": 19, "flex_rate_ms": 75, "flex_step_max": 23, "force_authority_match": true, "initial_step_range": 35, "mmr_max": 31, "mmr_mean": 29, "mmr_min": 85, "mmr_std_dev": 79, "override_mmr_data": false, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "ULiCEzo0", "criteria": "KrqKFkx8", "duration": 85, "reference": 0.18712712671858422}, {"attribute": "5RPGn683", "criteria": "gpmgQb98", "duration": 21, "reference": 0.7005049831934698}, {"attribute": "P9KsChnr", "criteria": "My1P9e2U", "duration": 41, "reference": 0.18879005153973472}], "match_options": {"options": [{"name": "hSUfwDMf", "type": "3ptGLImd"}, {"name": "n1FzRQQf", "type": "UavhI06Z"}, {"name": "HAxmvEE0", "type": "PEtpLues"}]}, "matchingRules": [{"attribute": "vHqmdSv8", "criteria": "q074A8RE", "reference": 0.823821841220755}, {"attribute": "VZiRwjqk", "criteria": "sWmCCXJD", "reference": 0.8533176598039832}, {"attribute": "U25RhJSi", "criteria": "6dobgTCq", "reference": 0.4969809720554068}], "sort_ticket": {"search_result": "distance", "ticket_queue": "largestPartySize"}, "sort_tickets": [{"search_result": "largestPartySize", "threshold": 93, "ticket_queue": "distance"}, {"search_result": "largestPartySize", "threshold": 71, "ticket_queue": "oldestTicketAge"}, {"search_result": "largestPartySize", "threshold": 45, "ticket_queue": "oldestTicketAge"}], "sub_game_modes": {}, "ticket_flexing_selection": "newest", "ticket_flexing_selections": [{"selection": "oldest", "threshold": 22}, {"selection": "newest", "threshold": 59}, {"selection": "newest", "threshold": 93}], "use_newest_ticket_for_flexing": true}, "sessionQueueTimeoutSeconds": 65, "socialMatchmaking": true, "sub_gamemode_selection": "random", "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'shsBagwV' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'nsQY4ejT' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName '3Gap9XE0' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 30}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'y1mKi8Xa' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'PUAqgHDi' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "X51kHAos", "count": 68, "mmrMax": 0.9223120696455196, "mmrMean": 0.13742679014036896, "mmrMin": 0.5033729043594443, "mmrStdDev": 0.4849066277237696}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'HncpiEqe' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 43, "party_attributes": {"fA8WlyTv": {}, "mQqZKsc8": {}, "gScIqshW": {}}, "party_id": "QnqaC61C", "party_members": [{"extra_attributes": {"OvE5gYpi": {}, "0ZwvyV4s": {}, "DXeW9qQ7": {}}, "user_id": "Ixa9oiwS"}, {"extra_attributes": {"RcmUIZPy": {}, "MonRf3jj": {}, "LVz64gao": {}}, "user_id": "P4zGjGjU"}, {"extra_attributes": {"0fyiz9Ys": {}, "KT1aXgjL": {}, "2nxkhTwM": {}}, "user_id": "FghEGtHm"}], "ticket_created_at": 91, "ticket_id": "1sfp2rl2"}, {"first_ticket_created_at": 38, "party_attributes": {"UmnwOm1M": {}, "yxD2wGCF": {}, "S5VcIPeT": {}}, "party_id": "YM3MToAJ", "party_members": [{"extra_attributes": {"BYWQ4kHE": {}, "WiwqUF1D": {}, "KIVugUaA": {}}, "user_id": "wg25mmmr"}, {"extra_attributes": {"qCpGQf1b": {}, "nAJ6ou9w": {}, "xcwXS2A6": {}}, "user_id": "lFeDxiiw"}, {"extra_attributes": {"mmwNJgZe": {}, "ePd5ctKp": {}, "MJbWvaA5": {}}, "user_id": "TbsJqDrR"}], "ticket_created_at": 34, "ticket_id": "2cOtCY0J"}, {"first_ticket_created_at": 50, "party_attributes": {"bBpDEBR7": {}, "wRrA65S3": {}, "Mt4zowHL": {}}, "party_id": "wxf6xgT7", "party_members": [{"extra_attributes": {"UNMKiHrm": {}, "V6sduykb": {}, "IeyyHnhN": {}}, "user_id": "CN9mjtz0"}, {"extra_attributes": {"byywnuzx": {}, "enZtlmUv": {}, "Ko5d8aUR": {}}, "user_id": "1Rg9lh4u"}, {"extra_attributes": {"p1492R2G": {}, "hLMn7S0I": {}, "CVTiFqku": {}}, "user_id": "CsJO69RF"}], "ticket_created_at": 58, "ticket_id": "ML8de7DC"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'YX6L6Y6V' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 64}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'vmp1iVHN' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName '32Oj1WYM' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'pCaaynmA' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["KJ1RtMWO", "NHYZpjel", "DNwGr7t1"], "party_id": "d5DCPI21", "user_id": "InvyPiNN"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'dHzgTcjS' \
    --matchID 'enHKczKl' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'axxTNfph' \
    --matchID 'mfpGejuC' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'huHdvp5N' \
    --matchID 'Mm6El5he' \
    --namespace $AB_NAMESPACE \
    --userID 'x0luIJy4' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName '5Ypx8iGQ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'XkNZ1kqz' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE