#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '80' \
    --offset '69' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatch", "deployment": "EBlwXjsi", "description": "SkIhcLK5", "find_match_timeout_seconds": 16, "game_mode": "hsWNlEQ8", "joinable": true, "max_delay_ms": 7, "region_expansion_range_ms": 10, "region_expansion_rate_ms": 45, "region_latency_initial_range_ms": 1, "region_latency_max_ms": 22, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 44, "min": 66, "name": "jsuBxO4D"}, {"max": 29, "min": 0, "name": "5gTU77ys"}, {"max": 65, "min": 88, "name": "nhNTYEkX"}], [{"max": 49, "min": 72, "name": "f4XtuLvD"}, {"max": 31, "min": 1, "name": "r4egY0jM"}, {"max": 70, "min": 16, "name": "YJcDHQx0"}], [{"max": 68, "min": 93, "name": "UCM8rddE"}, {"max": 86, "min": 81, "name": "2hfczm8r"}, {"max": 90, "min": 53, "name": "9EDb1JiE"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 54, "role_flexing_second": 92}, "max_number": 58, "min_number": 2, "player_max_number": 20, "player_min_number": 68}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 38, "min": 1, "name": "TNRWp39t"}, {"max": 99, "min": 88, "name": "epFFovM5"}, {"max": 77, "min": 10, "name": "G0vK6Hp4"}], [{"max": 47, "min": 35, "name": "qfdB44y2"}, {"max": 28, "min": 66, "name": "Akv8gJoK"}, {"max": 8, "min": 7, "name": "GCAvbASY"}], [{"max": 4, "min": 44, "name": "PwhaHn24"}, {"max": 62, "min": 5, "name": "r2JDN7Bc"}, {"max": 70, "min": 86, "name": "OFVYKUtb"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 92, "role_flexing_second": 28}, "duration": 11, "max_number": 26, "min_number": 52, "player_max_number": 99, "player_min_number": 61}, {"combination": {"alliances": [[{"max": 6, "min": 71, "name": "coGGa3GF"}, {"max": 75, "min": 38, "name": "7bCNiEeO"}, {"max": 70, "min": 72, "name": "C5TWqnze"}], [{"max": 0, "min": 20, "name": "iuN2GaSa"}, {"max": 64, "min": 56, "name": "UeS61ztW"}, {"max": 86, "min": 25, "name": "GefcCiZw"}], [{"max": 24, "min": 15, "name": "oCXzjR9W"}, {"max": 67, "min": 79, "name": "2tdQevWf"}, {"max": 56, "min": 0, "name": "EXEz9jSJ"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 99, "role_flexing_second": 55}, "duration": 39, "max_number": 99, "min_number": 78, "player_max_number": 1, "player_min_number": 89}, {"combination": {"alliances": [[{"max": 70, "min": 31, "name": "snxL9Zo7"}, {"max": 2, "min": 72, "name": "CmwyeadT"}, {"max": 16, "min": 62, "name": "BmAZcqr6"}], [{"max": 80, "min": 39, "name": "gQqDbYhA"}, {"max": 18, "min": 20, "name": "xHOArW9g"}, {"max": 89, "min": 26, "name": "B0AW0WyV"}], [{"max": 94, "min": 98, "name": "KArCaZjQ"}, {"max": 87, "min": 31, "name": "y7pw34U8"}, {"max": 76, "min": 79, "name": "MS0SsKN0"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 44, "role_flexing_second": 68}, "duration": 11, "max_number": 53, "min_number": 47, "player_max_number": 50, "player_min_number": 99}], "batch_size": 39, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 10, "flex_flat_step_range": 34, "flex_immunity_count": 23, "flex_range_max": 43, "flex_rate_ms": 95, "flex_step_max": 23, "force_authority_match": true, "initial_step_range": 20, "mmr_max": 40, "mmr_mean": 54, "mmr_min": 89, "mmr_std_dev": 40, "override_mmr_data": false, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexing_rule": [{"attribute": "cnKPl3Zn", "criteria": "q9w1MBbi", "duration": 90, "reference": 0.49970913705732867}, {"attribute": "nwy77GEs", "criteria": "CQjXxwjL", "duration": 39, "reference": 0.23904818276777862}, {"attribute": "QsUBGpJm", "criteria": "TTLwY5HP", "duration": 85, "reference": 0.1035725606520147}], "match_options": {"options": [{"name": "sYi9Rta0", "type": "202ACh0Q"}, {"name": "NpYp3u81", "type": "OlR7a61W"}, {"name": "t0NSCWFL", "type": "7sK7AGdW"}]}, "matching_rule": [{"attribute": "MDk6HTW8", "criteria": "iTfZGFdS", "reference": 0.8359498981691871}, {"attribute": "103jlY3v", "criteria": "tXwjdl6b", "reference": 0.8445636361908627}, {"attribute": "vQud6QHj", "criteria": "JucVzkGv", "reference": 0.04640905821365893}], "rebalance_enable": false, "sort_ticket": {"search_result": "distance", "ticket_queue": "largestPartySize"}, "sort_tickets": [{"search_result": "none", "threshold": 24, "ticket_queue": "oldestTicketAge"}, {"search_result": "none", "threshold": 84, "ticket_queue": "random"}, {"search_result": "largestPartySize", "threshold": 32, "ticket_queue": "none"}], "sub_game_modes": {"IBkumfdm": {"alliance": {"combination": {"alliances": [[{"max": 79, "min": 62, "name": "qqwUyxGQ"}, {"max": 0, "min": 21, "name": "P2e8FmcL"}, {"max": 97, "min": 81, "name": "kB9zkzzn"}], [{"max": 61, "min": 35, "name": "QIEJH3fQ"}, {"max": 86, "min": 64, "name": "8cLeX7LV"}, {"max": 62, "min": 87, "name": "U6rUr5vZ"}], [{"max": 75, "min": 24, "name": "pqltas8O"}, {"max": 24, "min": 90, "name": "8Up8daGM"}, {"max": 18, "min": 22, "name": "XjG8EjYO"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 69, "role_flexing_second": 18}, "max_number": 100, "min_number": 86, "player_max_number": 45, "player_min_number": 35}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 20, "min": 24, "name": "f1q6JN79"}, {"max": 71, "min": 62, "name": "EMTxcXld"}, {"max": 55, "min": 97, "name": "oBGjYQQd"}], [{"max": 6, "min": 66, "name": "S1I84u2s"}, {"max": 83, "min": 55, "name": "gTrkPGR8"}, {"max": 12, "min": 44, "name": "JcWrxcZj"}], [{"max": 57, "min": 79, "name": "eotR8Ye0"}, {"max": 47, "min": 41, "name": "tmwqafho"}, {"max": 44, "min": 14, "name": "dkI63Pic"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 50, "role_flexing_second": 34}, "duration": 6, "max_number": 37, "min_number": 7, "player_max_number": 6, "player_min_number": 87}, {"combination": {"alliances": [[{"max": 26, "min": 22, "name": "O9MzOozI"}, {"max": 64, "min": 44, "name": "vdPAW7Hx"}, {"max": 55, "min": 21, "name": "ODiio0vY"}], [{"max": 51, "min": 29, "name": "e3GL76pO"}, {"max": 73, "min": 87, "name": "Yp8VIjFp"}, {"max": 30, "min": 61, "name": "3ahCzwCX"}], [{"max": 73, "min": 61, "name": "H74YFazG"}, {"max": 99, "min": 20, "name": "wvgamLbx"}, {"max": 50, "min": 3, "name": "WBHwvtXt"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 1, "role_flexing_second": 57}, "duration": 57, "max_number": 26, "min_number": 92, "player_max_number": 64, "player_min_number": 65}, {"combination": {"alliances": [[{"max": 36, "min": 33, "name": "pQjUiQRC"}, {"max": 8, "min": 77, "name": "doFdtIvF"}, {"max": 35, "min": 82, "name": "uBRF1umC"}], [{"max": 39, "min": 57, "name": "r68XTwFl"}, {"max": 76, "min": 0, "name": "i6OdMWRk"}, {"max": 79, "min": 84, "name": "krMjBXDy"}], [{"max": 68, "min": 67, "name": "Sl2ynf65"}, {"max": 6, "min": 58, "name": "V4P8SBqh"}, {"max": 83, "min": 86, "name": "tcPo0eEJ"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 74, "role_flexing_second": 47}, "duration": 59, "max_number": 68, "min_number": 47, "player_max_number": 55, "player_min_number": 35}], "name": "V9cbls1Z"}, "DuDFehmy": {"alliance": {"combination": {"alliances": [[{"max": 15, "min": 0, "name": "SCwnopwB"}, {"max": 47, "min": 40, "name": "9Gxt5Cf4"}, {"max": 54, "min": 67, "name": "Cqthac5S"}], [{"max": 44, "min": 37, "name": "QmrKwWZT"}, {"max": 82, "min": 44, "name": "wSXI0gLh"}, {"max": 96, "min": 9, "name": "QtE7nLk9"}], [{"max": 78, "min": 38, "name": "z5g0qqKV"}, {"max": 27, "min": 90, "name": "TTAcWNbO"}, {"max": 84, "min": 68, "name": "ahauaWv8"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 87, "role_flexing_second": 48}, "max_number": 8, "min_number": 87, "player_max_number": 63, "player_min_number": 85}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 13, "min": 16, "name": "MmxhyQso"}, {"max": 18, "min": 91, "name": "M97Kfysz"}, {"max": 31, "min": 26, "name": "kMFhTm2p"}], [{"max": 52, "min": 100, "name": "UI116P8F"}, {"max": 53, "min": 5, "name": "m7g62Igi"}, {"max": 87, "min": 75, "name": "6qEsZHbT"}], [{"max": 24, "min": 51, "name": "Qvp1QDW6"}, {"max": 38, "min": 30, "name": "tcdZVKm5"}, {"max": 11, "min": 13, "name": "j1oBPYIo"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 20, "role_flexing_second": 87}, "duration": 23, "max_number": 86, "min_number": 97, "player_max_number": 85, "player_min_number": 71}, {"combination": {"alliances": [[{"max": 89, "min": 64, "name": "oreW6L5T"}, {"max": 70, "min": 75, "name": "BDY0gqWE"}, {"max": 11, "min": 78, "name": "T2PdEprz"}], [{"max": 63, "min": 55, "name": "nJ0IGCDi"}, {"max": 69, "min": 8, "name": "6TpRNMqm"}, {"max": 14, "min": 98, "name": "ev96Cdnc"}], [{"max": 70, "min": 54, "name": "pZX4HYDe"}, {"max": 2, "min": 43, "name": "szuiiD1e"}, {"max": 53, "min": 53, "name": "hNUEQnIG"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 98, "role_flexing_second": 56}, "duration": 79, "max_number": 58, "min_number": 36, "player_max_number": 45, "player_min_number": 67}, {"combination": {"alliances": [[{"max": 11, "min": 83, "name": "tuvEF98f"}, {"max": 91, "min": 76, "name": "QiWTPenB"}, {"max": 100, "min": 70, "name": "L06GEeBP"}], [{"max": 4, "min": 45, "name": "zILIbFUW"}, {"max": 9, "min": 100, "name": "hdzC6j42"}, {"max": 73, "min": 59, "name": "p96fUnvY"}], [{"max": 78, "min": 44, "name": "5coSnRlv"}, {"max": 44, "min": 82, "name": "lwKXnCba"}, {"max": 9, "min": 28, "name": "QjAt2I7j"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 76, "role_flexing_second": 22}, "duration": 13, "max_number": 92, "min_number": 25, "player_max_number": 96, "player_min_number": 91}], "name": "wE2hy48u"}, "6xRYdecj": {"alliance": {"combination": {"alliances": [[{"max": 7, "min": 88, "name": "7QrwLmZA"}, {"max": 20, "min": 78, "name": "GvGoA8hB"}, {"max": 43, "min": 60, "name": "VGuvV4g5"}], [{"max": 25, "min": 4, "name": "54IHOnV6"}, {"max": 86, "min": 64, "name": "NmcdqQ5u"}, {"max": 38, "min": 94, "name": "r5Xk304u"}], [{"max": 44, "min": 17, "name": "ImVrP1al"}, {"max": 4, "min": 79, "name": "sd9FkLg1"}, {"max": 4, "min": 95, "name": "dkMDKorD"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 65, "role_flexing_second": 81}, "max_number": 7, "min_number": 83, "player_max_number": 5, "player_min_number": 56}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 64, "min": 99, "name": "UrOCmYzV"}, {"max": 32, "min": 7, "name": "GsqOBh0E"}, {"max": 75, "min": 54, "name": "eN8hevs6"}], [{"max": 17, "min": 80, "name": "y6RyWM4Q"}, {"max": 31, "min": 69, "name": "VbNZFRmx"}, {"max": 91, "min": 42, "name": "D0tQ8Gbx"}], [{"max": 96, "min": 89, "name": "PsxPtKxK"}, {"max": 45, "min": 87, "name": "ld16zRqn"}, {"max": 76, "min": 32, "name": "MeuDOses"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 58, "role_flexing_second": 94}, "duration": 70, "max_number": 16, "min_number": 83, "player_max_number": 52, "player_min_number": 22}, {"combination": {"alliances": [[{"max": 64, "min": 97, "name": "ZfdcW04p"}, {"max": 38, "min": 49, "name": "G6uVB8fb"}, {"max": 99, "min": 76, "name": "Wc2kWaxO"}], [{"max": 17, "min": 19, "name": "tJIC8fud"}, {"max": 96, "min": 16, "name": "u8ULBnjm"}, {"max": 70, "min": 82, "name": "nTCvVk5L"}], [{"max": 95, "min": 24, "name": "1FUVrG0B"}, {"max": 77, "min": 40, "name": "YgXojdin"}, {"max": 31, "min": 97, "name": "Wib5cIQ3"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 37, "role_flexing_second": 38}, "duration": 86, "max_number": 93, "min_number": 70, "player_max_number": 39, "player_min_number": 57}, {"combination": {"alliances": [[{"max": 82, "min": 76, "name": "WfY9froU"}, {"max": 16, "min": 97, "name": "OhsrGdds"}, {"max": 49, "min": 20, "name": "KmWSn1Ys"}], [{"max": 22, "min": 41, "name": "O50ILdK4"}, {"max": 76, "min": 5, "name": "w8xUv8fG"}, {"max": 29, "min": 46, "name": "bvndy17K"}], [{"max": 73, "min": 38, "name": "deS1Zyxu"}, {"max": 59, "min": 35, "name": "bCjdAs85"}, {"max": 17, "min": 38, "name": "PRfWitAK"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 27, "role_flexing_second": 75}, "duration": 61, "max_number": 16, "min_number": 18, "player_max_number": 76, "player_min_number": 23}], "name": "dsTKOFp2"}}, "ticket_flexing_selection": "newest", "ticket_flexing_selections": [{"selection": "random", "threshold": 39}, {"selection": "pivot", "threshold": 43}, {"selection": "random", "threshold": 0}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 87, "social_matchmaking": true, "sub_gamemode_selection": "random", "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'GjMwy2V3' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'jbC6W1h5' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "LSYzP0Vm", "players": [{"results": [{"attribute": "bSZaM7TO", "value": 0.6364119830161078}, {"attribute": "aDGuKooD", "value": 0.8220523613654644}, {"attribute": "1ej2HUsR", "value": 0.2993457985883259}], "user_id": "CeWWV8GB"}, {"results": [{"attribute": "jOyrDRED", "value": 0.9124090972923935}, {"attribute": "cruSp3D7", "value": 0.07936301409017421}, {"attribute": "l6xdP5AI", "value": 0.5090444122251268}], "user_id": "OyuQIBkd"}, {"results": [{"attribute": "dnnpx1gy", "value": 0.8847954120540188}, {"attribute": "X42mU3h2", "value": 0.6720614962403593}, {"attribute": "BFo3S899", "value": 0.938413530093164}], "user_id": "bY6eShFb"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "KGtvdQnr"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "beNGFTNF", "client_version": "oc3TKZQq", "deployment": "RgAnMHlr", "error_code": 57, "error_message": "akAUeHtw", "game_mode": "ip8ECoWs", "is_mock": "FOiEMdmh", "joinable": false, "match_id": "jDuj3jYk", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 23, "party_attributes": {"ivNnErdK": {}, "owDBjWd9": {}, "FwvdoTHW": {}}, "party_id": "1FqK4If3", "party_members": [{"extra_attributes": {"uJif7YhE": {}, "mSULvVSC": {}, "3sl6dx9L": {}}, "user_id": "wR6sPeuO"}, {"extra_attributes": {"hRQUFeUs": {}, "3YHqrJej": {}, "Z2DWumSi": {}}, "user_id": "UZ8El9IE"}, {"extra_attributes": {"sUeNTgnd": {}, "nouwYlWd": {}, "YZYoOhr2": {}}, "user_id": "cpcqnQcr"}], "ticket_created_at": 57, "ticket_id": "wDNSneZm"}, {"first_ticket_created_at": 84, "party_attributes": {"fpQZO0KF": {}, "rSSMvDB6": {}, "i0uK6Ewq": {}}, "party_id": "B4BMWmEI", "party_members": [{"extra_attributes": {"hrUE9GF0": {}, "Slx7dMgA": {}, "WPbXTrZy": {}}, "user_id": "kAiAt3Ft"}, {"extra_attributes": {"PD3KLkyS": {}, "bOfizgbw": {}, "U6tAKxUi": {}}, "user_id": "wYpiaNeu"}, {"extra_attributes": {"SQXXOjbz": {}, "D17jtlCI": {}, "PrNKPrIW": {}}, "user_id": "YzU3ihAH"}], "ticket_created_at": 50, "ticket_id": "oPtFG5rc"}, {"first_ticket_created_at": 87, "party_attributes": {"4Ndjhj8o": {}, "E2oGiJTh": {}, "pCRubiZa": {}}, "party_id": "1BCHXjw1", "party_members": [{"extra_attributes": {"o6dfkTIa": {}, "blaOE6wp": {}, "t6qSLgds": {}}, "user_id": "kQBtS7Cu"}, {"extra_attributes": {"xVMZcQ52": {}, "1RqCTXTE": {}, "eY6asZWN": {}}, "user_id": "inc6xoz1"}, {"extra_attributes": {"DNF46M83": {}, "qcM3cZKn": {}, "9wGkE6LW": {}}, "user_id": "M7M7oZpZ"}], "ticket_created_at": 4, "ticket_id": "OkWxqmKR"}]}, {"matching_parties": [{"first_ticket_created_at": 67, "party_attributes": {"AIG3JBMp": {}, "k2cJE0yq": {}, "95ZCp05b": {}}, "party_id": "UaAq6cNZ", "party_members": [{"extra_attributes": {"ue2Df3mw": {}, "VOlMRFJQ": {}, "SOT2IJwz": {}}, "user_id": "6uFejMzs"}, {"extra_attributes": {"La8sZ9Hk": {}, "H3DWxE4C": {}, "Bhk6c4hO": {}}, "user_id": "1McR6Ps0"}, {"extra_attributes": {"kInFCUqS": {}, "fsRNZ6nh": {}, "XH2nRZaL": {}}, "user_id": "s9n1TLZs"}], "ticket_created_at": 87, "ticket_id": "xxmHBlXW"}, {"first_ticket_created_at": 27, "party_attributes": {"aNHtel0D": {}, "NKVZEYLy": {}, "QnfxQlw8": {}}, "party_id": "SKaqpaxF", "party_members": [{"extra_attributes": {"NiU7WLGd": {}, "H5hDyvnV": {}, "J0KiJowW": {}}, "user_id": "EtHipVQM"}, {"extra_attributes": {"2wj1qZik": {}, "oNtnuFgo": {}, "e9n4QLCh": {}}, "user_id": "nVIfTHiO"}, {"extra_attributes": {"IH1hqEUI": {}, "GuxITYZ9": {}, "xWl3FwVi": {}}, "user_id": "mwWQqG3K"}], "ticket_created_at": 87, "ticket_id": "1upwedXM"}, {"first_ticket_created_at": 9, "party_attributes": {"xc5od8pM": {}, "AtsHbbUu": {}, "nkkVPuGu": {}}, "party_id": "eqvR4WoG", "party_members": [{"extra_attributes": {"rsVrOENK": {}, "DdvBieBB": {}, "G77ESA9C": {}}, "user_id": "rhftUp2c"}, {"extra_attributes": {"SulxXNNj": {}, "9fdYrNCt": {}, "DARk5TWS": {}}, "user_id": "EYs7EfZj"}, {"extra_attributes": {"uOFOli4B": {}, "2My6qofT": {}, "R1b4PVv0": {}}, "user_id": "tlxi7f8t"}], "ticket_created_at": 23, "ticket_id": "76nfD9Vu"}]}, {"matching_parties": [{"first_ticket_created_at": 62, "party_attributes": {"RW0lWQ6W": {}, "fesE5nNr": {}, "AlIiLGLU": {}}, "party_id": "uZNhYpTj", "party_members": [{"extra_attributes": {"91k2f6Cr": {}, "qK5yne8r": {}, "hk1GMM13": {}}, "user_id": "46H9bRFi"}, {"extra_attributes": {"DSyMlzyp": {}, "eVOBG4AU": {}, "7Rfqs2PN": {}}, "user_id": "NhvpGhPo"}, {"extra_attributes": {"Num8aYpb": {}, "dizFZXNg": {}, "sZdla1tK": {}}, "user_id": "4fxHZdaN"}], "ticket_created_at": 16, "ticket_id": "6MDvvuta"}, {"first_ticket_created_at": 20, "party_attributes": {"VeWQmEtk": {}, "yx9cjmOQ": {}, "QDb5Juir": {}}, "party_id": "RahQrp8y", "party_members": [{"extra_attributes": {"uaiOJy63": {}, "E6JCp88l": {}, "y4zZnIsG": {}}, "user_id": "Cftmul35"}, {"extra_attributes": {"1uB4jhu2": {}, "DUKSOUUm": {}, "wwoNZBjj": {}}, "user_id": "TZRr1WPY"}, {"extra_attributes": {"1EyXG4Uj": {}, "EX1QQMTn": {}, "6cnXZO0O": {}}, "user_id": "OraGCX80"}], "ticket_created_at": 50, "ticket_id": "mBP5qU8K"}, {"first_ticket_created_at": 29, "party_attributes": {"Yb76Tlqc": {}, "M2h0LWMg": {}, "OJJM73Nr": {}}, "party_id": "jvb4yi1n", "party_members": [{"extra_attributes": {"O8FQb10g": {}, "mDdeF3nX": {}, "3uPaXayv": {}}, "user_id": "yHylvqbQ"}, {"extra_attributes": {"ZlnYZjrH": {}, "hP4imJCO": {}, "U3VTc2GN": {}}, "user_id": "nZg2bKCQ"}, {"extra_attributes": {"0y9hRmDz": {}, "NiUWJzq1": {}, "wcJleTbf": {}}, "user_id": "Ob4xulBa"}], "ticket_created_at": 23, "ticket_id": "eHVMdHLg"}]}], "namespace": "c2ogbPdW", "party_attributes": {"TRMYOGaa": {}, "SsdLyrJG": {}, "QqeLwOhB": {}}, "party_id": "qViF6zKf", "queued_at": 82, "region": "jh4LQmJS", "server_name": "ejSTWWMv", "status": "RatEh6iM", "ticket_id": "JyTEBDlX", "ticket_ids": ["wgATwSGE", "W9Ae8x6o", "qPpmn5HB"], "updated_at": "1996-09-10T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "VO0JYfat"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID '6MS0knZu' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 31, "userID": "dDO0JmKn", "weight": 0.9418148448876642}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'ZpyZAZKM' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'mZWFlvrx' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'vc8sMZdt' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatchOnDifferentTeam", "deployment": "rc9Aahqh", "description": "Yk8t9YbB", "findMatchTimeoutSeconds": 52, "joinable": true, "max_delay_ms": 97, "region_expansion_range_ms": 59, "region_expansion_rate_ms": 0, "region_latency_initial_range_ms": 23, "region_latency_max_ms": 54, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 40, "min": 98, "name": "Xvceg6YJ"}, {"max": 60, "min": 79, "name": "oiBF4PqE"}, {"max": 88, "min": 13, "name": "DQlljgoP"}], [{"max": 5, "min": 52, "name": "IX0hRfca"}, {"max": 88, "min": 50, "name": "C5geSFr5"}, {"max": 47, "min": 46, "name": "lQMsEwF1"}], [{"max": 87, "min": 36, "name": "qmreciZJ"}, {"max": 25, "min": 93, "name": "kGehEQp5"}, {"max": 98, "min": 21, "name": "eGT8J4kg"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 90, "role_flexing_second": 7}, "maxNumber": 36, "minNumber": 77, "playerMaxNumber": 92, "playerMinNumber": 45}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 89, "min": 58, "name": "N0B45cbG"}, {"max": 78, "min": 66, "name": "eKaAak0W"}, {"max": 46, "min": 55, "name": "MvAWjWNI"}], [{"max": 48, "min": 96, "name": "fbIbWmWd"}, {"max": 80, "min": 15, "name": "Tnlcy538"}, {"max": 39, "min": 4, "name": "kxTuEVQY"}], [{"max": 17, "min": 1, "name": "N945XFpg"}, {"max": 42, "min": 74, "name": "qjiX1wIm"}, {"max": 80, "min": 69, "name": "yarsykAD"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 42, "role_flexing_second": 23}, "duration": 22, "max_number": 45, "min_number": 85, "player_max_number": 100, "player_min_number": 17}, {"combination": {"alliances": [[{"max": 48, "min": 14, "name": "trkXqeOT"}, {"max": 39, "min": 7, "name": "Qj2ytUQz"}, {"max": 69, "min": 32, "name": "v5dHeOoK"}], [{"max": 78, "min": 33, "name": "NVQvX2iV"}, {"max": 38, "min": 29, "name": "vMmxuGFJ"}, {"max": 98, "min": 72, "name": "XMr8dra9"}], [{"max": 9, "min": 11, "name": "7SyiHDvz"}, {"max": 66, "min": 32, "name": "nGFGRqJa"}, {"max": 7, "min": 96, "name": "rDyqp6F8"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 16, "role_flexing_second": 24}, "duration": 72, "max_number": 50, "min_number": 13, "player_max_number": 2, "player_min_number": 97}, {"combination": {"alliances": [[{"max": 13, "min": 62, "name": "SVEl4GSN"}, {"max": 17, "min": 87, "name": "lBf7k1h1"}, {"max": 0, "min": 24, "name": "tqz8FSa7"}], [{"max": 5, "min": 23, "name": "OQbIYnBe"}, {"max": 99, "min": 68, "name": "i057Qsr2"}, {"max": 45, "min": 70, "name": "IQUgvxwg"}], [{"max": 5, "min": 46, "name": "ZixUHQ3d"}, {"max": 59, "min": 90, "name": "jo9cXjFx"}, {"max": 86, "min": 84, "name": "A7bgggQl"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 80, "role_flexing_second": 47}, "duration": 3, "max_number": 27, "min_number": 46, "player_max_number": 95, "player_min_number": 27}], "batch_size": 82, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 0, "flex_flat_step_range": 44, "flex_immunity_count": 81, "flex_range_max": 92, "flex_rate_ms": 16, "flex_step_max": 100, "force_authority_match": true, "initial_step_range": 66, "mmr_max": 49, "mmr_mean": 23, "mmr_min": 29, "mmr_std_dev": 7, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexingRules": [{"attribute": "VeZdWLTZ", "criteria": "R7IfQWEr", "duration": 54, "reference": 0.6772637309413944}, {"attribute": "5ficegfs", "criteria": "HGJueNIG", "duration": 56, "reference": 0.8868875229135728}, {"attribute": "4OB29zBH", "criteria": "ZtTyK4rm", "duration": 43, "reference": 0.306641878022862}], "match_options": {"options": [{"name": "FOzsrNiD", "type": "JmwwlLsu"}, {"name": "UZIcZXIi", "type": "gnfHjmxk"}, {"name": "IE79lioP", "type": "6UiVVtnF"}]}, "matchingRules": [{"attribute": "xOWC2X0s", "criteria": "EVETiMEz", "reference": 0.5154494621740799}, {"attribute": "pIGki6W8", "criteria": "jPDZruLp", "reference": 0.22240886375445168}, {"attribute": "ScYYamvE", "criteria": "BwpFdE8Y", "reference": 0.6679133504562936}], "sort_ticket": {"search_result": "distance", "ticket_queue": "random"}, "sort_tickets": [{"search_result": "oldestTicketAge", "threshold": 93, "ticket_queue": "random"}, {"search_result": "oldestTicketAge", "threshold": 14, "ticket_queue": "random"}, {"search_result": "largestPartySize", "threshold": 16, "ticket_queue": "distance"}], "sub_game_modes": {}, "ticket_flexing_selection": "oldest", "ticket_flexing_selections": [{"selection": "oldest", "threshold": 23}, {"selection": "pivot", "threshold": 27}, {"selection": "pivot", "threshold": 1}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 97, "socialMatchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'VeoQMzRM' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName '2RowAZyN' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'UgiphqKB' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 70}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'eIkRwOGW' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'QHcpDwg6' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "wVy4EVDm", "count": 60, "mmrMax": 0.7291129846987296, "mmrMean": 0.47999870088745455, "mmrMin": 0.9498708132114254, "mmrStdDev": 0.384674382603331}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'NK6uxMSX' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 43, "party_attributes": {"gVf5OADB": {}, "v4U1f1fv": {}, "K3Vv0reP": {}}, "party_id": "QrLBJ8Ys", "party_members": [{"extra_attributes": {"tlu1gDVg": {}, "LcgpNsah": {}, "vCEv8vrc": {}}, "user_id": "a4b1q723"}, {"extra_attributes": {"PXYXOpWc": {}, "sQzl42NZ": {}, "JL8X5uUD": {}}, "user_id": "JBDJLGWM"}, {"extra_attributes": {"DagZALdu": {}, "Kgf3iU8T": {}, "moy4Hf9J": {}}, "user_id": "F1gbjwX2"}], "ticket_created_at": 66, "ticket_id": "Iz5FbWVZ"}, {"first_ticket_created_at": 89, "party_attributes": {"iz4lRWCe": {}, "PZILQMa0": {}, "UvRmSVkz": {}}, "party_id": "WLMaK7ho", "party_members": [{"extra_attributes": {"UEODzrgm": {}, "0CrS4vrm": {}, "szKTaPbH": {}}, "user_id": "IOQzlqqt"}, {"extra_attributes": {"HoVtIeoj": {}, "80opxvND": {}, "ZjufAcz7": {}}, "user_id": "upZUCpMK"}, {"extra_attributes": {"fSzrOkIO": {}, "LAKeW0mj": {}, "biMh187P": {}}, "user_id": "zIMQtjaF"}], "ticket_created_at": 58, "ticket_id": "Roaq9fEb"}, {"first_ticket_created_at": 56, "party_attributes": {"wGmXoKF4": {}, "0TTta8kR": {}, "N5ItXKuO": {}}, "party_id": "W36zvxAi", "party_members": [{"extra_attributes": {"EIOFd6xd": {}, "vFeFN1vH": {}, "wEgq16sS": {}}, "user_id": "EraeRVgC"}, {"extra_attributes": {"ixyOB6yb": {}, "TueI99ge": {}, "UzQXYs7u": {}}, "user_id": "hKCx02b3"}, {"extra_attributes": {"0OCx5Ers": {}, "rM313hK0": {}, "3iv2u5VZ": {}}, "user_id": "HatJvNsx"}], "ticket_created_at": 47, "ticket_id": "tTnIO7yq"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'b9Ka2wqR' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 66}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'uRHGB1Fr' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'xvJlgoB6' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'HjFmzNE5' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["xrxr7n9o", "IsxxMSoY", "xNgz3g0q"], "party_id": "u7w91A8Q", "user_id": "hx5fNnHH"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName '0J3gJBzh' \
    --matchID '3bfp7U09' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'IjRqfJQS' \
    --matchID 'Fw4aKrhS' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'ZTIQj1Cj' \
    --matchID '6GdCtTFI' \
    --namespace $AB_NAMESPACE \
    --userID 'ChDYJUvP' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'y7d3xNNQ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'I8tQo495' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE