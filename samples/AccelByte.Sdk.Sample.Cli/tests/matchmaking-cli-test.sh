#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '82' \
    --offset '29' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatchOnDifferentTeam", "deployment": "f0aeL9sH", "description": "ipdue2kw", "find_match_timeout_seconds": 15, "game_mode": "a2u3k3zR", "joinable": false, "max_delay_ms": 93, "region_expansion_range_ms": 64, "region_expansion_rate_ms": 77, "region_latency_initial_range_ms": 82, "region_latency_max_ms": 13, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 83, "min": 2, "name": "yphb2g5v"}, {"max": 66, "min": 31, "name": "uvnfn8eO"}, {"max": 87, "min": 41, "name": "LxK09qU9"}], [{"max": 12, "min": 93, "name": "FY9xAdTA"}, {"max": 49, "min": 35, "name": "KEsRl1Tl"}, {"max": 93, "min": 74, "name": "LEbviKDX"}], [{"max": 80, "min": 83, "name": "xqyo1JpV"}, {"max": 25, "min": 60, "name": "iBYvA9xQ"}, {"max": 63, "min": 78, "name": "VRZqliSA"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 14, "role_flexing_second": 2}, "max_number": 97, "min_number": 34, "player_max_number": 67, "player_min_number": 33}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 94, "min": 26, "name": "Kkxdsvyg"}, {"max": 83, "min": 74, "name": "MCLFSSk3"}, {"max": 28, "min": 84, "name": "vjIINf6o"}], [{"max": 94, "min": 50, "name": "dYnuN6C5"}, {"max": 85, "min": 63, "name": "DDluLVzm"}, {"max": 90, "min": 28, "name": "AOEqyYbY"}], [{"max": 45, "min": 91, "name": "20WXTodP"}, {"max": 28, "min": 54, "name": "3K0UiVTP"}, {"max": 94, "min": 28, "name": "7voNqF3t"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 15, "role_flexing_second": 63}, "duration": 70, "max_number": 87, "min_number": 7, "player_max_number": 98, "player_min_number": 11}, {"combination": {"alliances": [[{"max": 33, "min": 73, "name": "HNDhp2DP"}, {"max": 74, "min": 26, "name": "blm0s6An"}, {"max": 79, "min": 79, "name": "toyUmGRa"}], [{"max": 48, "min": 34, "name": "eli6CDZ1"}, {"max": 73, "min": 41, "name": "gFLrikKB"}, {"max": 58, "min": 92, "name": "xE2ozVOP"}], [{"max": 0, "min": 67, "name": "9qEgmaQ3"}, {"max": 68, "min": 81, "name": "3d4a5FkJ"}, {"max": 55, "min": 34, "name": "WZcbspC0"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 11, "role_flexing_second": 80}, "duration": 48, "max_number": 75, "min_number": 88, "player_max_number": 78, "player_min_number": 21}, {"combination": {"alliances": [[{"max": 11, "min": 73, "name": "SfIeCXSs"}, {"max": 24, "min": 40, "name": "TxGfUS5Z"}, {"max": 59, "min": 79, "name": "MDUUiDia"}], [{"max": 34, "min": 12, "name": "DKgp5MFu"}, {"max": 70, "min": 45, "name": "Joj7wHEB"}, {"max": 44, "min": 49, "name": "4iMzJPDg"}], [{"max": 63, "min": 19, "name": "GpaKl81N"}, {"max": 90, "min": 1, "name": "6nzfuXwb"}, {"max": 52, "min": 90, "name": "O3mxntya"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 65, "role_flexing_second": 29}, "duration": 76, "max_number": 80, "min_number": 66, "player_max_number": 93, "player_min_number": 90}], "batch_size": 38, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 22, "flex_flat_step_range": 58, "flex_immunity_count": 79, "flex_range_max": 6, "flex_rate_ms": 4, "flex_step_max": 95, "force_authority_match": true, "initial_step_range": 70, "mmr_max": 83, "mmr_mean": 57, "mmr_min": 26, "mmr_std_dev": 70, "override_mmr_data": true, "use_bucket_mmr": true, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "wSqfKXqI", "criteria": "gLkzLVLD", "duration": 57, "reference": 0.2501628999871234}, {"attribute": "iKwMSI3d", "criteria": "uENNSbsG", "duration": 67, "reference": 0.22433913252992244}, {"attribute": "hM5QSuOX", "criteria": "bqDn59wm", "duration": 55, "reference": 0.2158556626000534}], "match_options": {"options": [{"name": "Fjykkf5W", "type": "DbSZKHrG"}, {"name": "eldc8lhA", "type": "KFkimLy7"}, {"name": "c8e0T0hn", "type": "hdl3OHjA"}]}, "matching_rule": [{"attribute": "yBCzKHPO", "criteria": "g0blprfR", "reference": 0.18722415163582196}, {"attribute": "pkvIhMgi", "criteria": "WEYzGSny", "reference": 0.7354570134109323}, {"attribute": "Wd33yBS3", "criteria": "8FV3T8SA", "reference": 0.7895001537030675}], "rebalance_enable": true, "sort_ticket": {"search_result": "IEqL3Nzh", "ticket_queue": "VMYrC6Bb"}, "sort_tickets": [{"search_result": "qVnw7qBm", "threshold": 51, "ticket_queue": "huySqPxF"}, {"search_result": "OqAD3JOy", "threshold": 72, "ticket_queue": "kkxfxkTl"}, {"search_result": "k1fgQq87", "threshold": 24, "ticket_queue": "AolGfLHa"}], "sub_game_modes": {"Eqi3pCnL": {"alliance": {"combination": {"alliances": [[{"max": 67, "min": 78, "name": "jINy483z"}, {"max": 8, "min": 88, "name": "rX07hob2"}, {"max": 76, "min": 83, "name": "tVNXZzkQ"}], [{"max": 73, "min": 47, "name": "wlnHc3GV"}, {"max": 44, "min": 92, "name": "UXNSNAPf"}, {"max": 66, "min": 18, "name": "QMc0nVGp"}], [{"max": 67, "min": 37, "name": "GiyuRg5w"}, {"max": 82, "min": 95, "name": "yTnymist"}, {"max": 76, "min": 96, "name": "0z5X30RE"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 42, "role_flexing_second": 32}, "max_number": 62, "min_number": 100, "player_max_number": 96, "player_min_number": 68}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 84, "min": 88, "name": "ZIabjssj"}, {"max": 70, "min": 97, "name": "Z3IH1h6z"}, {"max": 54, "min": 88, "name": "g7KBnlPg"}], [{"max": 1, "min": 99, "name": "gq1TV60y"}, {"max": 26, "min": 52, "name": "SlTqh7xo"}, {"max": 88, "min": 61, "name": "fms8KRtQ"}], [{"max": 58, "min": 30, "name": "UCzTOiiW"}, {"max": 35, "min": 72, "name": "boy6db3U"}, {"max": 36, "min": 81, "name": "j2uO0DNB"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 21, "role_flexing_second": 28}, "duration": 23, "max_number": 80, "min_number": 30, "player_max_number": 89, "player_min_number": 90}, {"combination": {"alliances": [[{"max": 0, "min": 15, "name": "H7TXzkqN"}, {"max": 55, "min": 56, "name": "42drqIKD"}, {"max": 62, "min": 88, "name": "JN4SElpT"}], [{"max": 49, "min": 14, "name": "O1heWNpT"}, {"max": 24, "min": 53, "name": "cvm5Dwsl"}, {"max": 95, "min": 52, "name": "LvClB2FQ"}], [{"max": 81, "min": 99, "name": "gkHuG9IZ"}, {"max": 47, "min": 39, "name": "mBAb6nKI"}, {"max": 69, "min": 80, "name": "ZEG1U0wC"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 39, "role_flexing_second": 21}, "duration": 51, "max_number": 57, "min_number": 76, "player_max_number": 25, "player_min_number": 50}, {"combination": {"alliances": [[{"max": 7, "min": 45, "name": "HmXRLPwt"}, {"max": 60, "min": 61, "name": "P3An0aFH"}, {"max": 58, "min": 71, "name": "awgYasFC"}], [{"max": 42, "min": 83, "name": "xh57GlW1"}, {"max": 69, "min": 37, "name": "dmQGBR0Q"}, {"max": 82, "min": 98, "name": "FiHAIVCi"}], [{"max": 52, "min": 72, "name": "4TSBrttD"}, {"max": 51, "min": 46, "name": "jMuef22q"}, {"max": 35, "min": 0, "name": "uZopmvhU"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 54, "role_flexing_second": 2}, "duration": 49, "max_number": 9, "min_number": 6, "player_max_number": 7, "player_min_number": 18}], "name": "6bp77J4Q"}, "7F805jyZ": {"alliance": {"combination": {"alliances": [[{"max": 41, "min": 89, "name": "xaV4hha8"}, {"max": 95, "min": 19, "name": "wWslTMOa"}, {"max": 34, "min": 29, "name": "K4CZKXj1"}], [{"max": 71, "min": 23, "name": "of9cRIWj"}, {"max": 37, "min": 59, "name": "m2H2BPx0"}, {"max": 75, "min": 100, "name": "FJlF3s3q"}], [{"max": 81, "min": 93, "name": "lNelO1VD"}, {"max": 92, "min": 60, "name": "FzBc8pHS"}, {"max": 42, "min": 98, "name": "pcRSOZmK"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 18, "role_flexing_second": 52}, "max_number": 14, "min_number": 74, "player_max_number": 64, "player_min_number": 26}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 25, "min": 92, "name": "psRPtIZw"}, {"max": 92, "min": 4, "name": "miJEPsPw"}, {"max": 78, "min": 70, "name": "XTGPHy9I"}], [{"max": 38, "min": 24, "name": "JjaIrnSn"}, {"max": 38, "min": 62, "name": "zwr6K89R"}, {"max": 91, "min": 12, "name": "eTBY9jBj"}], [{"max": 26, "min": 47, "name": "WKO2ikAM"}, {"max": 71, "min": 90, "name": "hwZpUDIt"}, {"max": 27, "min": 24, "name": "PqcZdKuj"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 34, "role_flexing_second": 67}, "duration": 55, "max_number": 45, "min_number": 98, "player_max_number": 96, "player_min_number": 91}, {"combination": {"alliances": [[{"max": 8, "min": 10, "name": "KdcPluLK"}, {"max": 64, "min": 14, "name": "dODaqLyA"}, {"max": 70, "min": 81, "name": "0ldgRI4x"}], [{"max": 78, "min": 5, "name": "DfhoHOrJ"}, {"max": 92, "min": 64, "name": "NG2irV2j"}, {"max": 37, "min": 50, "name": "IcvbcRda"}], [{"max": 16, "min": 12, "name": "t20UbOAp"}, {"max": 52, "min": 44, "name": "5oJ9qFIO"}, {"max": 58, "min": 23, "name": "MtGWGvq1"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 19, "role_flexing_second": 6}, "duration": 27, "max_number": 90, "min_number": 43, "player_max_number": 48, "player_min_number": 20}, {"combination": {"alliances": [[{"max": 32, "min": 15, "name": "OC3k2tZ6"}, {"max": 2, "min": 17, "name": "IpURo1QI"}, {"max": 0, "min": 79, "name": "JvtQKREU"}], [{"max": 82, "min": 93, "name": "3Fay4zSU"}, {"max": 19, "min": 79, "name": "UfnNg2A6"}, {"max": 71, "min": 98, "name": "1gBTpVmQ"}], [{"max": 81, "min": 80, "name": "usJ8U0wQ"}, {"max": 85, "min": 67, "name": "2nSzgFGy"}, {"max": 57, "min": 67, "name": "E5HH9aYV"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 15, "role_flexing_second": 29}, "duration": 53, "max_number": 88, "min_number": 36, "player_max_number": 49, "player_min_number": 56}], "name": "mU3wP9WE"}, "qDddp6tZ": {"alliance": {"combination": {"alliances": [[{"max": 1, "min": 99, "name": "k5e6LhOc"}, {"max": 42, "min": 36, "name": "NgMHHUac"}, {"max": 57, "min": 97, "name": "j2envAc4"}], [{"max": 66, "min": 33, "name": "cG7hWHRj"}, {"max": 86, "min": 40, "name": "oSip8MO7"}, {"max": 33, "min": 52, "name": "kAOA1Jmb"}], [{"max": 58, "min": 83, "name": "FgJqzAaU"}, {"max": 32, "min": 90, "name": "7WeNmw69"}, {"max": 84, "min": 0, "name": "MgJ9c4x4"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 66, "role_flexing_second": 70}, "max_number": 80, "min_number": 96, "player_max_number": 41, "player_min_number": 14}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 26, "min": 98, "name": "jrwQu6Jp"}, {"max": 72, "min": 70, "name": "oDjv97zS"}, {"max": 82, "min": 32, "name": "uml1zeWS"}], [{"max": 53, "min": 88, "name": "LN7hu0Qv"}, {"max": 52, "min": 53, "name": "afemsIEX"}, {"max": 95, "min": 77, "name": "6Kjp155S"}], [{"max": 68, "min": 4, "name": "bvE0xdSS"}, {"max": 5, "min": 21, "name": "KWo6TV5u"}, {"max": 78, "min": 27, "name": "VJOf7kPn"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 37, "role_flexing_second": 28}, "duration": 56, "max_number": 30, "min_number": 81, "player_max_number": 53, "player_min_number": 51}, {"combination": {"alliances": [[{"max": 70, "min": 23, "name": "NEjZ6bWV"}, {"max": 92, "min": 1, "name": "9cQXubiq"}, {"max": 2, "min": 91, "name": "VVP9QZwY"}], [{"max": 36, "min": 49, "name": "mePKe2Cr"}, {"max": 42, "min": 84, "name": "RSDzljsl"}, {"max": 27, "min": 64, "name": "LEg6ufD5"}], [{"max": 28, "min": 5, "name": "Yu9MfCUW"}, {"max": 49, "min": 76, "name": "InuJhKMi"}, {"max": 33, "min": 84, "name": "J3nwDMpl"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 43, "role_flexing_second": 3}, "duration": 50, "max_number": 16, "min_number": 93, "player_max_number": 99, "player_min_number": 53}, {"combination": {"alliances": [[{"max": 67, "min": 96, "name": "tM371Giv"}, {"max": 24, "min": 68, "name": "g9b3afdr"}, {"max": 74, "min": 59, "name": "WWcZiQx5"}], [{"max": 66, "min": 20, "name": "vuSiURLR"}, {"max": 99, "min": 75, "name": "9paBhd0C"}, {"max": 40, "min": 39, "name": "VHud21Ut"}], [{"max": 50, "min": 7, "name": "eG5OKPZJ"}, {"max": 91, "min": 85, "name": "b6y7WeDg"}, {"max": 66, "min": 83, "name": "EzcQsVap"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 51, "role_flexing_second": 95}, "duration": 70, "max_number": 7, "min_number": 99, "player_max_number": 82, "player_min_number": 99}], "name": "QnHX2eQT"}}, "ticket_flexing_selection": "rblm6tNH", "ticket_flexing_selections": [{"selection": "MYENpdIm", "threshold": 66}, {"selection": "Sta7IE8h", "threshold": 73}, {"selection": "IK7Vjsr8", "threshold": 49}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 47, "social_matchmaking": true, "sub_gamemode_selection": "random", "ticket_observability_enable": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'yi1J1O4o' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel '4V4ewCpA' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "jfs7dsuz", "players": [{"results": [{"attribute": "IHCUiTOU", "value": 0.5350553327576993}, {"attribute": "FThahLpt", "value": 0.8902272296838935}, {"attribute": "qOXTon1U", "value": 0.1627311358975565}], "user_id": "dPn2KsYf"}, {"results": [{"attribute": "yap6EXlM", "value": 0.5486389725435521}, {"attribute": "tpPtQpys", "value": 0.9958993916955828}, {"attribute": "nCikYXKT", "value": 0.2740328285130902}], "user_id": "TiFdRdel"}, {"results": [{"attribute": "nDQoaOvH", "value": 0.7241585666359106}, {"attribute": "jjQPU3K2", "value": 0.9152176725766149}, {"attribute": "dvwoyxdQ", "value": 0.6214701995122399}], "user_id": "qgRQPf2P"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "Q0drECtp"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "n0qIgOBD", "client_version": "Xr65AQHO", "deployment": "PJKgIJlr", "error_code": 36, "error_message": "yzjRTnwT", "game_mode": "VsKAlDMN", "is_mock": "pJNsaOMs", "joinable": true, "match_id": "xHffi4D9", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 48, "party_attributes": {"payF7f72": {}, "py1zJ4q9": {}, "mapP5hpv": {}}, "party_id": "qlbFQuea", "party_members": [{"extra_attributes": {"AfmvEiiX": {}, "c1FFIfAM": {}, "lSDwko0v": {}}, "user_id": "SI1UJHiG"}, {"extra_attributes": {"3dYFrEKJ": {}, "TryJ79H9": {}, "4x7uQhz6": {}}, "user_id": "sEkOTQ57"}, {"extra_attributes": {"7geiFGP8": {}, "fdOp5NOu": {}, "OMQ6XSle": {}}, "user_id": "8flYOJX3"}], "ticket_created_at": 27, "ticket_id": "RgeKfSTr"}, {"first_ticket_created_at": 92, "party_attributes": {"27fUSgF7": {}, "ZyQ7izTB": {}, "C63xrGIG": {}}, "party_id": "lCYYjIcm", "party_members": [{"extra_attributes": {"sMfvxx2D": {}, "6Tmndo3Z": {}, "cGeL5b5Z": {}}, "user_id": "3gDepJvq"}, {"extra_attributes": {"czKkqMcd": {}, "AONqXJKw": {}, "563DQ2Si": {}}, "user_id": "C0BMJu02"}, {"extra_attributes": {"ubnOw9K7": {}, "wjvz9vrt": {}, "50jGniWK": {}}, "user_id": "5yAzCtlW"}], "ticket_created_at": 90, "ticket_id": "a2ZNlZnH"}, {"first_ticket_created_at": 5, "party_attributes": {"NU6ty3D2": {}, "zIbu9VO1": {}, "2kaCQ7S4": {}}, "party_id": "gTKFuZrs", "party_members": [{"extra_attributes": {"99nUX2lA": {}, "vntRXAjz": {}, "WBBJgd84": {}}, "user_id": "QqwId2HY"}, {"extra_attributes": {"Xmu7NRnI": {}, "6SgxrHRC": {}, "NUxzjTEM": {}}, "user_id": "gftAISUT"}, {"extra_attributes": {"JT83hyZI": {}, "dxLpgKma": {}, "zeOG3nkm": {}}, "user_id": "NuiO7Q2q"}], "ticket_created_at": 20, "ticket_id": "CxbNNyDv"}]}, {"matching_parties": [{"first_ticket_created_at": 65, "party_attributes": {"cViZXG3v": {}, "h5u0XBBn": {}, "Y4If2lkb": {}}, "party_id": "JypVExVn", "party_members": [{"extra_attributes": {"D5sXa8Lg": {}, "WNwF1gw8": {}, "GOyJf5i9": {}}, "user_id": "2fSUAos5"}, {"extra_attributes": {"WWVCeY2B": {}, "CyzwohU6": {}, "NluXrXMk": {}}, "user_id": "iCnIhNiQ"}, {"extra_attributes": {"T5gftPmZ": {}, "sPKA5PAw": {}, "Bh2hzlQp": {}}, "user_id": "bLfC9EFq"}], "ticket_created_at": 38, "ticket_id": "qjX58oGZ"}, {"first_ticket_created_at": 49, "party_attributes": {"0aElQNwM": {}, "c0PpIXK5": {}, "SaLssxxw": {}}, "party_id": "QoX0MW8N", "party_members": [{"extra_attributes": {"t6WZcJsd": {}, "GAGpPeXy": {}, "8UDwkQtK": {}}, "user_id": "1wgvcg7r"}, {"extra_attributes": {"wt8Ycdcx": {}, "65T6kXGC": {}, "5oVuUjLR": {}}, "user_id": "EW74RGP0"}, {"extra_attributes": {"D6Gwxzme": {}, "v7GVP4He": {}, "D2qeJJH6": {}}, "user_id": "4RvfBihZ"}], "ticket_created_at": 24, "ticket_id": "eDrWoqT3"}, {"first_ticket_created_at": 80, "party_attributes": {"07rqWJn3": {}, "EtHepWDJ": {}, "7ViMP1yY": {}}, "party_id": "CwgJNYKT", "party_members": [{"extra_attributes": {"3NO75O7j": {}, "EIGuuoZQ": {}, "5R3e8CHA": {}}, "user_id": "N2hwOCsI"}, {"extra_attributes": {"HqBExhm3": {}, "6pGhoe7D": {}, "B25AOQTN": {}}, "user_id": "OlmkOv3w"}, {"extra_attributes": {"J4TfPGzn": {}, "g6giXkKe": {}, "IKcQjUhq": {}}, "user_id": "h96FxhLE"}], "ticket_created_at": 57, "ticket_id": "4zwfJ7P3"}]}, {"matching_parties": [{"first_ticket_created_at": 98, "party_attributes": {"BvCuWnY1": {}, "GFuCYTwi": {}, "6qCHI9dm": {}}, "party_id": "u46VdvKA", "party_members": [{"extra_attributes": {"u7QeejDe": {}, "ilGSjiXu": {}, "s11o6vb3": {}}, "user_id": "iZPlP4SF"}, {"extra_attributes": {"3U6gL9kg": {}, "cmEO3cOj": {}, "Edkn5tlr": {}}, "user_id": "WK79bhC7"}, {"extra_attributes": {"RvMn9wvC": {}, "PE8HmTxT": {}, "h10sSXRg": {}}, "user_id": "K0jhDR1n"}], "ticket_created_at": 88, "ticket_id": "VHSPnsFa"}, {"first_ticket_created_at": 70, "party_attributes": {"C9QnHa8A": {}, "oIQ0JBaW": {}, "C5dQQMie": {}}, "party_id": "D8kUIblc", "party_members": [{"extra_attributes": {"j2jTyYpe": {}, "VLNVsKDI": {}, "HWRSqtM9": {}}, "user_id": "P1gQD4xc"}, {"extra_attributes": {"44V9qFCP": {}, "ldXAcWw8": {}, "OLNC6U4m": {}}, "user_id": "sWdFrFem"}, {"extra_attributes": {"TvIrY7hc": {}, "mUAkAqPz": {}, "S9K1Vvgm": {}}, "user_id": "ZCB8impc"}], "ticket_created_at": 53, "ticket_id": "1JJ3qS18"}, {"first_ticket_created_at": 58, "party_attributes": {"ZSIp9K8X": {}, "2PTUlhDY": {}, "8RBoSROB": {}}, "party_id": "DWCiSmht", "party_members": [{"extra_attributes": {"rwz1r74Z": {}, "n3Kromut": {}, "NZ323JH5": {}}, "user_id": "yHEm9suR"}, {"extra_attributes": {"O2d2vvZy": {}, "ARt4r0Ut": {}, "It4h2xdq": {}}, "user_id": "nnkiA322"}, {"extra_attributes": {"70DiIrdA": {}, "NFG4aI8Z": {}, "ezHmuw80": {}}, "user_id": "hSVQGMQN"}], "ticket_created_at": 64, "ticket_id": "Z2Qtp5i6"}]}], "namespace": "mdoNteE7", "party_attributes": {"jkLgT2FG": {}, "NaOoAG0C": {}, "zLb0sJLT": {}}, "party_id": "AXOViyVs", "queued_at": 59, "region": "jqWLkoE9", "server_name": "vEdwXUqu", "status": "Byjmrl3p", "ticket_id": "K2Ejhu0m", "ticket_ids": ["7NBousxq", "WVQ9ehb2", "VUbBdm69"], "updated_at": "1974-11-22T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "g1OZbkXM"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'eNP2b6Ql' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 82, "userID": "K0XObbMY", "weight": 0.5237386401813643}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'uEYpPyTB' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy '1yIaqs1r' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'qu0L2JJQ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatchOnDifferentTeam", "deployment": "qT4ig39e", "description": "lE9zTfsc", "findMatchTimeoutSeconds": 0, "joinable": false, "max_delay_ms": 87, "region_expansion_range_ms": 69, "region_expansion_rate_ms": 93, "region_latency_initial_range_ms": 61, "region_latency_max_ms": 3, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 15, "min": 99, "name": "yMXIsPTU"}, {"max": 35, "min": 83, "name": "7LOqbl3b"}, {"max": 6, "min": 14, "name": "qFQBtqmB"}], [{"max": 35, "min": 26, "name": "gRxTVLxt"}, {"max": 41, "min": 60, "name": "KafJlVcn"}, {"max": 56, "min": 2, "name": "sxTQoaD4"}], [{"max": 46, "min": 61, "name": "V6YYUGiS"}, {"max": 37, "min": 49, "name": "eL7pnsPV"}, {"max": 17, "min": 99, "name": "0AY9XPU4"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 91, "role_flexing_second": 87}, "maxNumber": 30, "minNumber": 91, "playerMaxNumber": 84, "playerMinNumber": 98}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 23, "min": 52, "name": "danZJluz"}, {"max": 17, "min": 19, "name": "2vSCHcI8"}, {"max": 20, "min": 50, "name": "T6zRK2vd"}], [{"max": 45, "min": 50, "name": "l9tDidix"}, {"max": 71, "min": 0, "name": "zsu3lzwr"}, {"max": 36, "min": 87, "name": "uqufnA6R"}], [{"max": 37, "min": 70, "name": "kx1CyZrn"}, {"max": 13, "min": 55, "name": "d8JhtuXw"}, {"max": 87, "min": 100, "name": "4gNkBNBl"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 57, "role_flexing_second": 86}, "duration": 17, "max_number": 43, "min_number": 76, "player_max_number": 28, "player_min_number": 7}, {"combination": {"alliances": [[{"max": 71, "min": 85, "name": "Gc6QMprr"}, {"max": 68, "min": 37, "name": "usAp2EVq"}, {"max": 90, "min": 14, "name": "bZ1dvRag"}], [{"max": 13, "min": 33, "name": "v3oy3jHN"}, {"max": 30, "min": 89, "name": "TYSFx4kB"}, {"max": 11, "min": 37, "name": "GhaUurFN"}], [{"max": 30, "min": 24, "name": "XWPTJIOB"}, {"max": 93, "min": 5, "name": "5fO5hVgh"}, {"max": 92, "min": 57, "name": "TY2lArQL"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 33, "role_flexing_second": 35}, "duration": 97, "max_number": 8, "min_number": 96, "player_max_number": 78, "player_min_number": 59}, {"combination": {"alliances": [[{"max": 64, "min": 94, "name": "3nQdmCLx"}, {"max": 66, "min": 53, "name": "RWPXlV0k"}, {"max": 66, "min": 26, "name": "8dwubhHM"}], [{"max": 36, "min": 64, "name": "uAY80cuO"}, {"max": 45, "min": 61, "name": "jPJQVxuG"}, {"max": 100, "min": 7, "name": "JelvjK2W"}], [{"max": 36, "min": 24, "name": "GuEcIZZL"}, {"max": 88, "min": 35, "name": "Vz1nUsCh"}, {"max": 77, "min": 47, "name": "Qjj0aaO0"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 53, "role_flexing_second": 98}, "duration": 35, "max_number": 55, "min_number": 66, "player_max_number": 16, "player_min_number": 54}], "batch_size": 7, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 28, "flex_flat_step_range": 92, "flex_immunity_count": 84, "flex_range_max": 86, "flex_rate_ms": 12, "flex_step_max": 5, "force_authority_match": false, "initial_step_range": 21, "mmr_max": 44, "mmr_mean": 84, "mmr_min": 70, "mmr_std_dev": 59, "override_mmr_data": false, "use_bucket_mmr": true, "use_flat_flex_step": true}, "flexingRules": [{"attribute": "35Z7xvSf", "criteria": "DV1or7sj", "duration": 25, "reference": 0.5052483117614587}, {"attribute": "9FTmyzM7", "criteria": "202DRc2B", "duration": 77, "reference": 0.4589200854272901}, {"attribute": "9RnZwnmv", "criteria": "3OiPoIp9", "duration": 8, "reference": 0.9371259597887537}], "match_options": {"options": [{"name": "QUO3e8j3", "type": "kq0DuNDO"}, {"name": "RuiOcQE4", "type": "JzqQyvRa"}, {"name": "R6im4hv4", "type": "7z356bse"}]}, "matchingRules": [{"attribute": "BheIErM8", "criteria": "S1DSotI5", "reference": 0.33555739720798894}, {"attribute": "TDjfJ1xD", "criteria": "UWm0LbZx", "reference": 0.11562756064584478}, {"attribute": "oYbLWH09", "criteria": "HlfIZ4lx", "reference": 0.8322311655074177}], "sort_ticket": {"search_result": "Dicw0VH7", "ticket_queue": "y1ph2Tjl"}, "sort_tickets": [{"search_result": "GJRK5sIT", "threshold": 66, "ticket_queue": "H8x24IG3"}, {"search_result": "cFZnzarJ", "threshold": 61, "ticket_queue": "569jpzMh"}, {"search_result": "SHBlRVfx", "threshold": 70, "ticket_queue": "zQvweniO"}], "sub_game_modes": {}, "ticket_flexing_selection": "DutKdzyq", "ticket_flexing_selections": [{"selection": "vvwoqcD9", "threshold": 62}, {"selection": "ezByja7F", "threshold": 29}, {"selection": "EDptqeXI", "threshold": 58}], "use_newest_ticket_for_flexing": true}, "sessionQueueTimeoutSeconds": 41, "socialMatchmaking": false, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'pnBeMcCk' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName '4tAGxZTM' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'qPEA54pO' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 82}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName '7POpDnlx' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'VqFepPc1' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "vYZnXfTS", "count": 79, "mmrMax": 0.24362819891880227, "mmrMean": 0.9557655261839636, "mmrMin": 0.36754689335993973, "mmrStdDev": 0.6808734753200721}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'aTfWqNkC' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 21, "party_attributes": {"2Yxc7udd": {}, "Jxt8tHeh": {}, "0qe5Fqot": {}}, "party_id": "YGc1Mkkp", "party_members": [{"extra_attributes": {"T62pWOJu": {}, "yzsxNJtq": {}, "EhcF5N1o": {}}, "user_id": "IY2kgX8J"}, {"extra_attributes": {"Q8NVSTBk": {}, "OKYjoISC": {}, "5C0IQvm1": {}}, "user_id": "f7oy4ayd"}, {"extra_attributes": {"CZlgrKRU": {}, "UGJWAYZR": {}, "jZ4aCqBU": {}}, "user_id": "yzQWAfJk"}], "ticket_created_at": 27, "ticket_id": "Y0fcv4fN"}, {"first_ticket_created_at": 61, "party_attributes": {"SQXuoemz": {}, "qdf0O6bQ": {}, "g3WmJoKS": {}}, "party_id": "DIHyWcmA", "party_members": [{"extra_attributes": {"Lt81Is2r": {}, "633oNltz": {}, "v391Vow2": {}}, "user_id": "i1VVwtvR"}, {"extra_attributes": {"IEK8UxDk": {}, "nm2mVz96": {}, "wAwHas8Q": {}}, "user_id": "THGk8Xjm"}, {"extra_attributes": {"bqyVLsYG": {}, "8c27D5UG": {}, "63fn5DMj": {}}, "user_id": "6NmnVK6p"}], "ticket_created_at": 10, "ticket_id": "pWh55uYU"}, {"first_ticket_created_at": 88, "party_attributes": {"CFtp2cAy": {}, "DMNtTL2Q": {}, "wXbKS60s": {}}, "party_id": "khOkMb0A", "party_members": [{"extra_attributes": {"8DBr321l": {}, "TTOLpWST": {}, "Md1iy7lm": {}}, "user_id": "sOyRZrlQ"}, {"extra_attributes": {"XPc2ak1x": {}, "gFA6xqca": {}, "140Yia6l": {}}, "user_id": "dsBrj4ph"}, {"extra_attributes": {"irbji3Bg": {}, "98MkERrw": {}, "yCeAfcaN": {}}, "user_id": "uYL7Iqks"}], "ticket_created_at": 88, "ticket_id": "ilWkTllp"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'PUo51QS9' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 76}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'A1SLWiNk' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'U7BLLQy2' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'DoeCQpgi' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["9sI5jgqZ", "zOQP6FKQ", "7PSf1RlX"], "party_id": "r7Jn2fwv", "user_id": "ySLcsCsG"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName '5iklg5S0' \
    --matchID 'JPZY1zNt' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'HnAr4sZp' \
    --matchID 'Qt3sSsM2' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'wRcTgBgi' \
    --matchID 'wLiLRv4p' \
    --namespace $AB_NAMESPACE \
    --userID 'NZXgVxwI' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'MgmeVAEB' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'LCc6Tx1v' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE