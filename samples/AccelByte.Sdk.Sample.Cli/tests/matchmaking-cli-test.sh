#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '55' \
    --offset '6' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCannotMatch", "deployment": "4Rx50kiG", "description": "f2mGBQno", "find_match_timeout_seconds": 8, "game_mode": "XmzK3ynm", "joinable": false, "max_delay_ms": 100, "region_expansion_range_ms": 37, "region_expansion_rate_ms": 37, "region_latency_initial_range_ms": 52, "region_latency_max_ms": 8, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 74, "min": 56, "name": "s053PIcB"}, {"max": 24, "min": 47, "name": "JTUdL3i8"}, {"max": 90, "min": 6, "name": "15UfriZ8"}], [{"max": 98, "min": 73, "name": "trSBdDub"}, {"max": 54, "min": 8, "name": "zTgrbVnU"}, {"max": 60, "min": 2, "name": "pqWUPQgo"}], [{"max": 46, "min": 39, "name": "AWAd7es4"}, {"max": 80, "min": 72, "name": "cRMUukdT"}, {"max": 37, "min": 87, "name": "oIIp3BGu"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 45, "role_flexing_second": 30}, "max_number": 3, "min_number": 96, "player_max_number": 46, "player_min_number": 4}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 72, "min": 94, "name": "dn7FSm8Q"}, {"max": 32, "min": 93, "name": "8X89veGx"}, {"max": 57, "min": 45, "name": "Pxjh1WlL"}], [{"max": 44, "min": 2, "name": "SnFTWoXM"}, {"max": 5, "min": 55, "name": "G4BAVZbc"}, {"max": 69, "min": 7, "name": "tyY2oEmE"}], [{"max": 7, "min": 48, "name": "N6VBq0gx"}, {"max": 66, "min": 40, "name": "QCaITV3h"}, {"max": 38, "min": 4, "name": "2esu3ydi"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 21, "role_flexing_second": 44}, "duration": 67, "max_number": 12, "min_number": 2, "player_max_number": 85, "player_min_number": 22}, {"combination": {"alliances": [[{"max": 73, "min": 87, "name": "kun3QA6D"}, {"max": 82, "min": 3, "name": "VKz8NyER"}, {"max": 100, "min": 43, "name": "3gCpkBnk"}], [{"max": 60, "min": 62, "name": "cZ5COyZW"}, {"max": 11, "min": 5, "name": "q3Hkh4On"}, {"max": 66, "min": 71, "name": "brOGPuzx"}], [{"max": 2, "min": 96, "name": "MjvUZYa5"}, {"max": 2, "min": 19, "name": "U52s3bce"}, {"max": 78, "min": 18, "name": "VbcAHX3Q"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 20, "role_flexing_second": 36}, "duration": 87, "max_number": 92, "min_number": 9, "player_max_number": 55, "player_min_number": 12}, {"combination": {"alliances": [[{"max": 30, "min": 69, "name": "9GDeeXFr"}, {"max": 16, "min": 10, "name": "vVWOTvLM"}, {"max": 11, "min": 5, "name": "UlCcP5as"}], [{"max": 15, "min": 60, "name": "TEJMGMAt"}, {"max": 90, "min": 69, "name": "BtvEjFTk"}, {"max": 67, "min": 91, "name": "JXF4qXtW"}], [{"max": 19, "min": 96, "name": "ufFag06D"}, {"max": 39, "min": 17, "name": "JhIp2uzj"}, {"max": 75, "min": 0, "name": "6VmXe1QF"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 15, "role_flexing_second": 97}, "duration": 78, "max_number": 24, "min_number": 23, "player_max_number": 38, "player_min_number": 73}], "batch_size": 92, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 25, "flex_flat_step_range": 40, "flex_immunity_count": 58, "flex_range_max": 87, "flex_rate_ms": 30, "flex_step_max": 100, "force_authority_match": false, "initial_step_range": 32, "mmr_max": 47, "mmr_mean": 10, "mmr_min": 81, "mmr_std_dev": 44, "override_mmr_data": false, "use_bucket_mmr": true, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "qq5hTgj0", "criteria": "DfEs6yZp", "duration": 5, "reference": 0.701026844955989}, {"attribute": "9kzO47iC", "criteria": "xwsKvxKM", "duration": 55, "reference": 0.1944347763678682}, {"attribute": "DEk1jjpm", "criteria": "PmTTSY5X", "duration": 84, "reference": 0.679370490703418}], "match_options": {"options": [{"name": "fsFdXuUx", "type": "w8EgiRBs"}, {"name": "Y0jgLEfT", "type": "1DC6XK9j"}, {"name": "XbBcenUD", "type": "NjV0IdvC"}]}, "matching_rule": [{"attribute": "3AEcxAxU", "criteria": "wCF8L6Gn", "reference": 0.4872676041048484}, {"attribute": "JraYhBxn", "criteria": "SrXuhloN", "reference": 0.5415445934894172}, {"attribute": "CO1BHrbt", "criteria": "xwX41jh1", "reference": 0.8659651224775547}], "rebalance_enable": true, "sort_ticket": {"search_result": "m0Sffjxv", "ticket_queue": "sxZUmYUw"}, "sort_tickets": [{"search_result": "3RsbAYRA", "threshold": 46, "ticket_queue": "stJQt335"}, {"search_result": "YLCstgbx", "threshold": 36, "ticket_queue": "HAEtHgT0"}, {"search_result": "2B0CgGyI", "threshold": 27, "ticket_queue": "fblqdIDQ"}], "sub_game_modes": {"mTxDqmwy": {"alliance": {"combination": {"alliances": [[{"max": 84, "min": 62, "name": "sFULNj2o"}, {"max": 70, "min": 61, "name": "SahTYxTj"}, {"max": 8, "min": 100, "name": "XcdHx7b7"}], [{"max": 40, "min": 85, "name": "ZOaEvSRK"}, {"max": 97, "min": 99, "name": "Fe5p85cN"}, {"max": 51, "min": 78, "name": "21RkZnPK"}], [{"max": 46, "min": 33, "name": "o7yXka50"}, {"max": 29, "min": 63, "name": "4YCDJ53w"}, {"max": 66, "min": 91, "name": "tV049zD3"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 71, "role_flexing_second": 44}, "max_number": 39, "min_number": 37, "player_max_number": 11, "player_min_number": 36}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 78, "min": 26, "name": "O2ZSWVPn"}, {"max": 96, "min": 38, "name": "BJ8miaGq"}, {"max": 31, "min": 7, "name": "WWi5wOSl"}], [{"max": 60, "min": 33, "name": "VKeNxlbI"}, {"max": 61, "min": 43, "name": "Yqs762Us"}, {"max": 43, "min": 91, "name": "ViadcJ64"}], [{"max": 33, "min": 21, "name": "mGJrUcSK"}, {"max": 97, "min": 57, "name": "c0JoUnzu"}, {"max": 0, "min": 57, "name": "XUbqTOHW"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 13, "role_flexing_second": 0}, "duration": 36, "max_number": 29, "min_number": 52, "player_max_number": 33, "player_min_number": 51}, {"combination": {"alliances": [[{"max": 81, "min": 67, "name": "fiwmwDxm"}, {"max": 85, "min": 71, "name": "46Dq3k5a"}, {"max": 40, "min": 14, "name": "tD7YPSsQ"}], [{"max": 56, "min": 98, "name": "QDBkEZQm"}, {"max": 33, "min": 0, "name": "xF1P1gSQ"}, {"max": 92, "min": 29, "name": "4T7OeKlu"}], [{"max": 85, "min": 15, "name": "Ti0BJLuO"}, {"max": 62, "min": 21, "name": "IPF14XWg"}, {"max": 53, "min": 10, "name": "wqoeyPol"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 62, "role_flexing_second": 86}, "duration": 100, "max_number": 50, "min_number": 14, "player_max_number": 93, "player_min_number": 95}, {"combination": {"alliances": [[{"max": 94, "min": 69, "name": "Fh7186Ry"}, {"max": 56, "min": 15, "name": "jL2Yrwxi"}, {"max": 27, "min": 15, "name": "N3ZPljB6"}], [{"max": 21, "min": 80, "name": "IKcyk1Io"}, {"max": 29, "min": 59, "name": "kVB2fOY1"}, {"max": 70, "min": 19, "name": "3ptoUASB"}], [{"max": 13, "min": 59, "name": "GeJmDKL0"}, {"max": 54, "min": 44, "name": "3bdimsu6"}, {"max": 29, "min": 26, "name": "gwcEfYLb"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 97, "role_flexing_second": 40}, "duration": 56, "max_number": 76, "min_number": 80, "player_max_number": 81, "player_min_number": 76}], "name": "Dt1YWgDV"}, "M8VrVnz1": {"alliance": {"combination": {"alliances": [[{"max": 39, "min": 64, "name": "QHDgab50"}, {"max": 50, "min": 78, "name": "vNbVvg96"}, {"max": 7, "min": 18, "name": "DjjYMcko"}], [{"max": 25, "min": 17, "name": "3kaggqP0"}, {"max": 27, "min": 52, "name": "bzrabKjr"}, {"max": 71, "min": 44, "name": "IiMI4HI1"}], [{"max": 15, "min": 14, "name": "rRfZMPCX"}, {"max": 28, "min": 30, "name": "KSch6n5t"}, {"max": 60, "min": 32, "name": "qsRYFjT1"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 32, "role_flexing_second": 59}, "max_number": 1, "min_number": 70, "player_max_number": 68, "player_min_number": 47}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 92, "min": 100, "name": "v8D2vgSt"}, {"max": 35, "min": 19, "name": "BCTJmj33"}, {"max": 27, "min": 19, "name": "QDfJBcN4"}], [{"max": 75, "min": 84, "name": "UDL8Dlzv"}, {"max": 47, "min": 94, "name": "nVJcK2wf"}, {"max": 58, "min": 76, "name": "jx0CtNAL"}], [{"max": 72, "min": 35, "name": "xQueCjNz"}, {"max": 86, "min": 15, "name": "GaTz1H9r"}, {"max": 9, "min": 70, "name": "TwjEZUvy"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 44, "role_flexing_second": 99}, "duration": 46, "max_number": 34, "min_number": 45, "player_max_number": 37, "player_min_number": 40}, {"combination": {"alliances": [[{"max": 85, "min": 46, "name": "A0vsmXYm"}, {"max": 91, "min": 21, "name": "9IjGBf6R"}, {"max": 27, "min": 99, "name": "Trj7wGVq"}], [{"max": 23, "min": 21, "name": "W5UiPJE6"}, {"max": 88, "min": 77, "name": "jEDIh77A"}, {"max": 39, "min": 17, "name": "dSave5e0"}], [{"max": 58, "min": 84, "name": "dZClijSP"}, {"max": 95, "min": 83, "name": "hNLMp6Rs"}, {"max": 22, "min": 45, "name": "wZ93Gj9I"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 52, "role_flexing_second": 1}, "duration": 72, "max_number": 20, "min_number": 59, "player_max_number": 69, "player_min_number": 91}, {"combination": {"alliances": [[{"max": 95, "min": 78, "name": "KoGXBm4A"}, {"max": 22, "min": 81, "name": "zODpbrPY"}, {"max": 22, "min": 81, "name": "8ychMdAH"}], [{"max": 11, "min": 36, "name": "Q0cydMHz"}, {"max": 75, "min": 7, "name": "wsWG4Z2V"}, {"max": 75, "min": 8, "name": "vmtmE8ez"}], [{"max": 83, "min": 96, "name": "F1thdbCJ"}, {"max": 77, "min": 90, "name": "349eC0EJ"}, {"max": 63, "min": 1, "name": "bjU2KmNV"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 69, "role_flexing_second": 52}, "duration": 82, "max_number": 18, "min_number": 60, "player_max_number": 84, "player_min_number": 52}], "name": "NhfnPWVG"}, "JWQroR4Z": {"alliance": {"combination": {"alliances": [[{"max": 84, "min": 44, "name": "JWDN5Gye"}, {"max": 62, "min": 6, "name": "THF9giwv"}, {"max": 75, "min": 3, "name": "mtsg0djX"}], [{"max": 33, "min": 41, "name": "rIs7GDCQ"}, {"max": 87, "min": 45, "name": "hPscXLaN"}, {"max": 31, "min": 10, "name": "u2IrXPYk"}], [{"max": 93, "min": 91, "name": "2dZrO6b9"}, {"max": 83, "min": 3, "name": "bCFVicek"}, {"max": 2, "min": 51, "name": "YCzJyJvo"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 25, "role_flexing_second": 24}, "max_number": 21, "min_number": 1, "player_max_number": 43, "player_min_number": 58}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 42, "min": 55, "name": "ADBB4Trh"}, {"max": 7, "min": 64, "name": "EhMNDBpm"}, {"max": 4, "min": 0, "name": "05E1f9RX"}], [{"max": 66, "min": 55, "name": "yGUskTIC"}, {"max": 0, "min": 30, "name": "jQ9ns2Fc"}, {"max": 84, "min": 49, "name": "y0fbZQeH"}], [{"max": 63, "min": 33, "name": "PZukZfog"}, {"max": 57, "min": 36, "name": "90l6kdHp"}, {"max": 43, "min": 33, "name": "IgLbjXXx"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 5, "role_flexing_second": 56}, "duration": 35, "max_number": 29, "min_number": 73, "player_max_number": 22, "player_min_number": 82}, {"combination": {"alliances": [[{"max": 81, "min": 43, "name": "ZaflK1YL"}, {"max": 12, "min": 20, "name": "axS4V5Ig"}, {"max": 6, "min": 15, "name": "sDo3Nolx"}], [{"max": 71, "min": 38, "name": "DFoebALg"}, {"max": 50, "min": 16, "name": "CQd5sYdX"}, {"max": 48, "min": 94, "name": "Zy6LXH1X"}], [{"max": 14, "min": 99, "name": "jLHJrKSV"}, {"max": 99, "min": 29, "name": "aP655p37"}, {"max": 65, "min": 47, "name": "QFNiymzt"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 22, "role_flexing_second": 28}, "duration": 62, "max_number": 77, "min_number": 35, "player_max_number": 75, "player_min_number": 62}, {"combination": {"alliances": [[{"max": 86, "min": 57, "name": "708ZPtu8"}, {"max": 3, "min": 14, "name": "emKwQkKZ"}, {"max": 77, "min": 36, "name": "V2ncrLHw"}], [{"max": 38, "min": 82, "name": "1VtwbHkr"}, {"max": 42, "min": 78, "name": "wtMdSlEm"}, {"max": 97, "min": 4, "name": "vE4U114y"}], [{"max": 42, "min": 16, "name": "DRlhEHjq"}, {"max": 13, "min": 86, "name": "3pRpMJm9"}, {"max": 85, "min": 5, "name": "MnmIY1YX"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 48, "role_flexing_second": 66}, "duration": 64, "max_number": 7, "min_number": 78, "player_max_number": 40, "player_min_number": 44}], "name": "uu5OaIIC"}}, "ticket_flexing_selection": "XU3xqPxP", "ticket_flexing_selections": [{"selection": "1LRHxHKD", "threshold": 40}, {"selection": "je32We81", "threshold": 91}, {"selection": "abdPOITj", "threshold": 20}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 39, "social_matchmaking": false, "sub_gamemode_selection": "random", "ticket_observability_enable": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'dOnsiZjC' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'aP9QLYqL' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "p8EPIE1P", "players": [{"results": [{"attribute": "L9FR47RC", "value": 0.3903513936857792}, {"attribute": "r3HspXHE", "value": 0.48845710933397}, {"attribute": "12eopMGz", "value": 0.49703280009427053}], "user_id": "xconBrWu"}, {"results": [{"attribute": "SuQErEiT", "value": 0.5713934054880241}, {"attribute": "PZicxhU3", "value": 0.7888319179015183}, {"attribute": "P96OYXCW", "value": 0.2726828437266188}], "user_id": "eIGN4Rlm"}, {"results": [{"attribute": "VErmroDB", "value": 0.31951821929715885}, {"attribute": "mgMdGOb5", "value": 0.27868720470677777}, {"attribute": "4GHAd2oz", "value": 0.80814591329902}], "user_id": "4GPEPG18"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "QMXAr7Uc"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "nGaswahC", "client_version": "8jVpSJrf", "deployment": "UVbE1vg2", "error_code": 73, "error_message": "gQ5VfNIq", "game_mode": "EbOvIqBy", "is_mock": "OgM2TyL6", "joinable": false, "match_id": "at5bVQdD", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 40, "party_attributes": {"OjMA5VEp": {}, "DNP2PdBu": {}, "tXDeJRTX": {}}, "party_id": "xmdVjguM", "party_members": [{"extra_attributes": {"M3ttTHZ8": {}, "uhsCoTyo": {}, "9ZxmxNGu": {}}, "user_id": "AcAhg7oM"}, {"extra_attributes": {"N5E5igRT": {}, "53l4qNmL": {}, "vPLJmnwm": {}}, "user_id": "I5qN68Wt"}, {"extra_attributes": {"uotCBaHp": {}, "wtFPmifp": {}, "rq9WUFdh": {}}, "user_id": "jkJPqo3r"}], "ticket_created_at": 34, "ticket_id": "1USvjSAe"}, {"first_ticket_created_at": 11, "party_attributes": {"12SmHz70": {}, "O5srTi5A": {}, "2H6aLBC1": {}}, "party_id": "ycG3ECLK", "party_members": [{"extra_attributes": {"VivfPbS4": {}, "YIx6PcRL": {}, "ojkWUdRJ": {}}, "user_id": "fpEKdI9o"}, {"extra_attributes": {"s6oI4P7a": {}, "bMHF3Klf": {}, "JDAvhyq2": {}}, "user_id": "WLoN9qYZ"}, {"extra_attributes": {"EwlivACJ": {}, "fK9kaL6o": {}, "cnXKDQWG": {}}, "user_id": "yaQJREH9"}], "ticket_created_at": 40, "ticket_id": "d3rHJnt9"}, {"first_ticket_created_at": 79, "party_attributes": {"6JP9EBfb": {}, "uFFb8Nfe": {}, "jU3uNbSo": {}}, "party_id": "8AJ3x9Wv", "party_members": [{"extra_attributes": {"11zzANoI": {}, "T2YRWW1D": {}, "3uIaec6P": {}}, "user_id": "zCwnQ8nf"}, {"extra_attributes": {"817TiECW": {}, "3oEDKnWR": {}, "IFX0J0Bi": {}}, "user_id": "V3txlJdB"}, {"extra_attributes": {"ye24TazF": {}, "5MV8r2M8": {}, "a7CTycZa": {}}, "user_id": "E1tyMVuC"}], "ticket_created_at": 99, "ticket_id": "PmRd2F1N"}]}, {"matching_parties": [{"first_ticket_created_at": 95, "party_attributes": {"M47BcDzT": {}, "hKwte7dh": {}, "u4ncV08s": {}}, "party_id": "Uf2UMWHl", "party_members": [{"extra_attributes": {"JPmHtvGB": {}, "8u45uuoZ": {}, "3Omrk7x4": {}}, "user_id": "DQ9w7bEB"}, {"extra_attributes": {"kHbP5hY8": {}, "jOjvoOd3": {}, "1d06Nneh": {}}, "user_id": "2rlF10zt"}, {"extra_attributes": {"RdZctnwK": {}, "f6E479BC": {}, "hNvdjzmZ": {}}, "user_id": "c1v5QPMT"}], "ticket_created_at": 81, "ticket_id": "vElWTn47"}, {"first_ticket_created_at": 100, "party_attributes": {"2KxyqiQp": {}, "GFBWFkYS": {}, "N4fyjkKu": {}}, "party_id": "V8fvVF7W", "party_members": [{"extra_attributes": {"yTU4dDh0": {}, "B1IzBRKJ": {}, "JvOlkbRs": {}}, "user_id": "DKqZaiuD"}, {"extra_attributes": {"bhGcbqRA": {}, "aZVPRkrL": {}, "lUc75hOE": {}}, "user_id": "H3qcd9qW"}, {"extra_attributes": {"gknu8JUF": {}, "jg3tipsQ": {}, "vFQ0rBdp": {}}, "user_id": "hi1Le9Q4"}], "ticket_created_at": 45, "ticket_id": "aqdrRUKl"}, {"first_ticket_created_at": 13, "party_attributes": {"SbMZ1CA8": {}, "3xGxvOqM": {}, "piOfkEWE": {}}, "party_id": "2SsC3vyg", "party_members": [{"extra_attributes": {"WbdJo3xR": {}, "hOCS6Vq0": {}, "ViC7I4B5": {}}, "user_id": "FmZTm60t"}, {"extra_attributes": {"x8A3cX8a": {}, "yj7BMswV": {}, "hNM1ElcZ": {}}, "user_id": "TXTQmCwg"}, {"extra_attributes": {"GFazouU6": {}, "T0ZtFx2O": {}, "oHZNyVaI": {}}, "user_id": "PrFJvnT3"}], "ticket_created_at": 54, "ticket_id": "9icjm4JE"}]}, {"matching_parties": [{"first_ticket_created_at": 35, "party_attributes": {"Suacv6qE": {}, "KcT95oHj": {}, "8dLmyi8d": {}}, "party_id": "KlXYdm7g", "party_members": [{"extra_attributes": {"K9UjNl6n": {}, "93wsglwC": {}, "abuAahgP": {}}, "user_id": "p137QLwO"}, {"extra_attributes": {"sb3fMwRa": {}, "6na92KME": {}, "nxVaTyUj": {}}, "user_id": "S35kj3Se"}, {"extra_attributes": {"XBSvOzvD": {}, "WeFneqTp": {}, "vHRaF00c": {}}, "user_id": "3xHOKGl0"}], "ticket_created_at": 54, "ticket_id": "ThwiYWHG"}, {"first_ticket_created_at": 41, "party_attributes": {"Muipni6h": {}, "E6nrWk9e": {}, "wDvk7E4m": {}}, "party_id": "pOkdCwRn", "party_members": [{"extra_attributes": {"C8qCcJ0y": {}, "gBRaZhad": {}, "tT7XZJ3Z": {}}, "user_id": "GC7q2k7m"}, {"extra_attributes": {"ZljVLDkD": {}, "8jAA19b0": {}, "CYjO5kDp": {}}, "user_id": "LPAaxixp"}, {"extra_attributes": {"0BQP9OgZ": {}, "HHQOBukc": {}, "kcBn467A": {}}, "user_id": "fJOBliTs"}], "ticket_created_at": 73, "ticket_id": "Jwjo0Edp"}, {"first_ticket_created_at": 2, "party_attributes": {"3joClPGs": {}, "DleAuTik": {}, "ybuGUara": {}}, "party_id": "UoEZN7Ga", "party_members": [{"extra_attributes": {"WmyuQfmT": {}, "IUeWd9ps": {}, "ZaM7yMrG": {}}, "user_id": "BakTVZq8"}, {"extra_attributes": {"WfZHcZUa": {}, "NCIB5K2u": {}, "Tq8Ddv8W": {}}, "user_id": "P5c48BiW"}, {"extra_attributes": {"O61fGq68": {}, "brhL2wxZ": {}, "D9rYublW": {}}, "user_id": "gUldYjP9"}], "ticket_created_at": 96, "ticket_id": "QL5SjPuE"}]}], "namespace": "dlN8LcBr", "party_attributes": {"dGjjW4dE": {}, "QRrdqTGK": {}, "yK7noojh": {}}, "party_id": "x3zaKR5b", "queued_at": 58, "region": "cYL91033", "server_name": "GHjK5Aq3", "status": "ElREpYgc", "ticket_id": "zDoCSJsG", "ticket_ids": ["lP5qAFvA", "zTggYf0V", "dVcRUbOJ"], "updated_at": "1972-03-30T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "XAhHlWT5"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'E14ba8bu' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 100, "userID": "6YtISqNH", "weight": 0.1183080233945425}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'jn1xuWjl' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy 'iDmhmYan' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'RfG3VcEu' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatchOnDifferentTeam", "deployment": "hymjp01k", "description": "5ojHGsYS", "findMatchTimeoutSeconds": 33, "joinable": true, "max_delay_ms": 57, "region_expansion_range_ms": 69, "region_expansion_rate_ms": 1, "region_latency_initial_range_ms": 42, "region_latency_max_ms": 10, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 28, "min": 50, "name": "ODn7XXqa"}, {"max": 19, "min": 75, "name": "pBw2PnTg"}, {"max": 3, "min": 71, "name": "fH0RNoBf"}], [{"max": 22, "min": 38, "name": "RzvlVMte"}, {"max": 6, "min": 2, "name": "PXcHL615"}, {"max": 6, "min": 74, "name": "yqG7PcK6"}], [{"max": 4, "min": 56, "name": "HO4yvzpy"}, {"max": 21, "min": 49, "name": "vqpwn6uA"}, {"max": 86, "min": 69, "name": "FaVm9WAN"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 15, "role_flexing_second": 96}, "maxNumber": 36, "minNumber": 76, "playerMaxNumber": 24, "playerMinNumber": 65}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 5, "min": 75, "name": "YtufhPUt"}, {"max": 21, "min": 3, "name": "sxlrv4b2"}, {"max": 50, "min": 75, "name": "c9FMHKB8"}], [{"max": 17, "min": 96, "name": "jnmpppJ3"}, {"max": 22, "min": 67, "name": "adexyHfl"}, {"max": 64, "min": 59, "name": "iaRtX6bm"}], [{"max": 66, "min": 58, "name": "zTMGqeK4"}, {"max": 38, "min": 22, "name": "KckokE68"}, {"max": 5, "min": 49, "name": "HRhe3xhF"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 8, "role_flexing_second": 77}, "duration": 9, "max_number": 21, "min_number": 71, "player_max_number": 50, "player_min_number": 54}, {"combination": {"alliances": [[{"max": 60, "min": 46, "name": "AVuGtjAP"}, {"max": 78, "min": 73, "name": "QNiSW2Xi"}, {"max": 44, "min": 47, "name": "PKXEvDPq"}], [{"max": 30, "min": 86, "name": "m7mtn8r2"}, {"max": 88, "min": 61, "name": "0cRe25qQ"}, {"max": 15, "min": 7, "name": "cXruE0sx"}], [{"max": 50, "min": 5, "name": "npY26gWh"}, {"max": 55, "min": 77, "name": "UDexyLhE"}, {"max": 59, "min": 18, "name": "CBGNQDds"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 12, "role_flexing_second": 97}, "duration": 76, "max_number": 16, "min_number": 34, "player_max_number": 50, "player_min_number": 1}, {"combination": {"alliances": [[{"max": 79, "min": 31, "name": "TkgY9I8x"}, {"max": 5, "min": 32, "name": "PugDdp62"}, {"max": 39, "min": 24, "name": "vbHdDEze"}], [{"max": 27, "min": 0, "name": "czF42OSI"}, {"max": 63, "min": 89, "name": "iMAw5eAr"}, {"max": 20, "min": 97, "name": "f1YT1faO"}], [{"max": 8, "min": 81, "name": "1nEiS4EK"}, {"max": 26, "min": 32, "name": "xTesdl7E"}, {"max": 34, "min": 12, "name": "Xsa9Uzc1"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 21, "role_flexing_second": 68}, "duration": 66, "max_number": 1, "min_number": 3, "player_max_number": 63, "player_min_number": 29}], "batch_size": 84, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 42, "flex_flat_step_range": 15, "flex_immunity_count": 96, "flex_range_max": 37, "flex_rate_ms": 94, "flex_step_max": 1, "force_authority_match": false, "initial_step_range": 59, "mmr_max": 72, "mmr_mean": 0, "mmr_min": 77, "mmr_std_dev": 78, "override_mmr_data": true, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "ze6HeKu7", "criteria": "98qzI14B", "duration": 65, "reference": 0.8160966697325444}, {"attribute": "UcZOLHw4", "criteria": "xy0YBhTD", "duration": 82, "reference": 0.8557400674994811}, {"attribute": "vHdWN7WG", "criteria": "cbIG2z06", "duration": 52, "reference": 0.7944434470744068}], "match_options": {"options": [{"name": "Mx0MpjGE", "type": "o9Z1DrEo"}, {"name": "dc0BmO5x", "type": "3FUQUQPo"}, {"name": "M8p1fun2", "type": "fC7UYOe6"}]}, "matchingRules": [{"attribute": "mlyl8JQi", "criteria": "TzOW9wkE", "reference": 0.8358996291600583}, {"attribute": "3lmhDnW5", "criteria": "BdqG0CJe", "reference": 0.4957900435543232}, {"attribute": "Tlj568n6", "criteria": "oI89s7ip", "reference": 0.5456086150801257}], "sort_ticket": {"search_result": "A5LE9kpm", "ticket_queue": "45hJCreh"}, "sort_tickets": [{"search_result": "nIVbEfN7", "threshold": 50, "ticket_queue": "y47eGzLb"}, {"search_result": "CP31VZOw", "threshold": 72, "ticket_queue": "DJVdhslV"}, {"search_result": "3uyocSme", "threshold": 63, "ticket_queue": "r8vLVJ6J"}], "sub_game_modes": {}, "ticket_flexing_selection": "7cpyrFGR", "ticket_flexing_selections": [{"selection": "vR9X3IPX", "threshold": 58}, {"selection": "JMOPqoVD", "threshold": 20}, {"selection": "Ryw6ErVm", "threshold": 47}], "use_newest_ticket_for_flexing": true}, "sessionQueueTimeoutSeconds": 50, "socialMatchmaking": false, "sub_gamemode_selection": "random", "ticket_observability_enable": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName '4So1gHF7' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'EE4bEKPp' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'MyVbnYtp' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 52}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName '9nt40rBY' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName '3HbPI55J' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "ME3pz525", "count": 50, "mmrMax": 0.2922922077669239, "mmrMean": 0.01894764254445247, "mmrMin": 0.9033811097695316, "mmrStdDev": 0.8515282604113995}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'voT5qoHR' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 54, "party_attributes": {"aYZ7WNXR": {}, "sPHqORjP": {}, "FBsKArTD": {}}, "party_id": "TomSnynX", "party_members": [{"extra_attributes": {"okMvWuC6": {}, "pLw928ef": {}, "7SPonZLZ": {}}, "user_id": "kWAgwIJv"}, {"extra_attributes": {"JHn09VV3": {}, "WgQJk2k5": {}, "ZaJkxUXx": {}}, "user_id": "fbexNAGx"}, {"extra_attributes": {"NDLVNXJ8": {}, "j6SdDNaR": {}, "ao4oJ51E": {}}, "user_id": "wnSUAlgJ"}], "ticket_created_at": 29, "ticket_id": "Rnpk3Bjm"}, {"first_ticket_created_at": 29, "party_attributes": {"EvlK0ZO5": {}, "ldGj5ai1": {}, "vG15FrJP": {}}, "party_id": "wAulB9ij", "party_members": [{"extra_attributes": {"kSM0Qa94": {}, "5Hv9ofr7": {}, "4T2r9bMq": {}}, "user_id": "1dXYxMgF"}, {"extra_attributes": {"Rh3Xw6Az": {}, "zbZFrXL8": {}, "MmoZJq23": {}}, "user_id": "fcaaJeNz"}, {"extra_attributes": {"doh6DA12": {}, "4f18DR82": {}, "XmVxcemq": {}}, "user_id": "0hW5urIB"}], "ticket_created_at": 19, "ticket_id": "W14Ztg8J"}, {"first_ticket_created_at": 45, "party_attributes": {"p7mDLgwY": {}, "i1MZBzMu": {}, "ym4Ye9d1": {}}, "party_id": "nHuFNPKn", "party_members": [{"extra_attributes": {"OwNpF0NG": {}, "OIZGDC6h": {}, "UcKCbWuX": {}}, "user_id": "RRbTNgT0"}, {"extra_attributes": {"t7Txnzgw": {}, "V4py7Fjk": {}, "IJVjbyYV": {}}, "user_id": "4AmKQEMJ"}, {"extra_attributes": {"HnE24nsc": {}, "g2aBebGd": {}, "jOlZHE1Y": {}}, "user_id": "88gP6pch"}], "ticket_created_at": 0, "ticket_id": "0UlhKQEv"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'HqDWOeIH' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 5}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'Oa5guM7M' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'iHEumjr7' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'bdtMV0T7' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["QTQZkpuV", "Mlekbngv", "y9dHyBKS"], "party_id": "VaDkyIQp", "user_id": "6DWOqLn7"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'VsoXfwsr' \
    --matchID 'nSTQMqLi' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'sDlF54oS' \
    --matchID 'zt6l38bh' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'rRHghwYp' \
    --matchID 'r17Uejb0' \
    --namespace $AB_NAMESPACE \
    --userID '98uPRVLY' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'lcRVrgAA' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName '1zKWhpVU' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE