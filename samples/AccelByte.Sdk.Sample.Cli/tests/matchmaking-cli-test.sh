#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '56' \
    --offset '51' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatch", "deployment": "T6eBzs6R", "description": "z0SaCBKu", "find_match_timeout_seconds": 83, "game_mode": "cuF8ahhR", "joinable": true, "max_delay_ms": 75, "region_expansion_range_ms": 88, "region_expansion_rate_ms": 36, "region_latency_initial_range_ms": 24, "region_latency_max_ms": 36, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 46, "min": 88, "name": "JTXXT1ZD"}, {"max": 83, "min": 54, "name": "ZRQEGKko"}, {"max": 84, "min": 61, "name": "UPDlqRpt"}], [{"max": 45, "min": 25, "name": "7NLZItOn"}, {"max": 68, "min": 29, "name": "A2wrlpgg"}, {"max": 46, "min": 15, "name": "aZzng0tR"}], [{"max": 62, "min": 6, "name": "Uu5ngsnl"}, {"max": 53, "min": 78, "name": "UWYaKyRR"}, {"max": 97, "min": 88, "name": "T006SzBD"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 90, "role_flexing_second": 14}, "max_number": 68, "min_number": 41, "player_max_number": 61, "player_min_number": 44}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 72, "min": 95, "name": "p1a1C80C"}, {"max": 65, "min": 23, "name": "HG3JNdYD"}, {"max": 48, "min": 23, "name": "p2miuLiP"}], [{"max": 8, "min": 78, "name": "9HtjVamx"}, {"max": 58, "min": 93, "name": "rGATsFcu"}, {"max": 71, "min": 82, "name": "g6ec1PVL"}], [{"max": 50, "min": 51, "name": "39DIAweI"}, {"max": 52, "min": 7, "name": "yGJR35oJ"}, {"max": 25, "min": 33, "name": "4jbXy5kC"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 20, "role_flexing_second": 56}, "duration": 67, "max_number": 6, "min_number": 21, "player_max_number": 85, "player_min_number": 99}, {"combination": {"alliances": [[{"max": 58, "min": 34, "name": "rhed9uZe"}, {"max": 77, "min": 9, "name": "dsvIYstS"}, {"max": 63, "min": 81, "name": "WZFJM6CO"}], [{"max": 49, "min": 34, "name": "Hl6YkI9h"}, {"max": 97, "min": 85, "name": "vi5qOYwd"}, {"max": 57, "min": 12, "name": "QlN2VHIB"}], [{"max": 48, "min": 79, "name": "CrdFlz3F"}, {"max": 16, "min": 31, "name": "714muOJm"}, {"max": 2, "min": 93, "name": "NLQPN1vR"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 28, "role_flexing_second": 66}, "duration": 13, "max_number": 40, "min_number": 11, "player_max_number": 85, "player_min_number": 82}, {"combination": {"alliances": [[{"max": 33, "min": 50, "name": "or56LevL"}, {"max": 18, "min": 43, "name": "H2zyn9dm"}, {"max": 75, "min": 76, "name": "R73yhvL0"}], [{"max": 41, "min": 59, "name": "QPRN8c6D"}, {"max": 21, "min": 84, "name": "gxxlPh3L"}, {"max": 57, "min": 55, "name": "7RwZbTnX"}], [{"max": 73, "min": 13, "name": "DOv7g9hv"}, {"max": 79, "min": 46, "name": "K6JdmYSc"}, {"max": 29, "min": 47, "name": "9unYZN5H"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 7, "role_flexing_second": 32}, "duration": 66, "max_number": 18, "min_number": 18, "player_max_number": 57, "player_min_number": 65}], "batch_size": 42, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 53, "flex_flat_step_range": 87, "flex_immunity_count": 70, "flex_range_max": 23, "flex_rate_ms": 75, "flex_step_max": 89, "force_authority_match": false, "initial_step_range": 85, "mmr_max": 45, "mmr_mean": 50, "mmr_min": 41, "mmr_std_dev": 34, "override_mmr_data": true, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexing_rule": [{"attribute": "YDgqSO1H", "criteria": "hiZ5utTl", "duration": 86, "reference": 0.08975942283223337}, {"attribute": "67Gy5bPK", "criteria": "DTg2yXDb", "duration": 41, "reference": 0.24974243479667202}, {"attribute": "fWQwd8Vf", "criteria": "84lXjMG2", "duration": 40, "reference": 0.5515403333731912}], "match_options": {"options": [{"name": "6i2K6QJs", "type": "9CGVFXnJ"}, {"name": "EZGHouzS", "type": "HwYXy1Jn"}, {"name": "2mH0QSQH", "type": "InElCyAQ"}]}, "matching_rule": [{"attribute": "YTISLteA", "criteria": "1DpmvzqZ", "reference": 0.5777871504823555}, {"attribute": "v27JzMWK", "criteria": "WazoVr1Y", "reference": 0.8899688810220767}, {"attribute": "urcVGE8O", "criteria": "6H1j9YnY", "reference": 0.1474850453599782}], "rebalance_enable": false, "sort_ticket": {"search_result": "hn4N4u1f", "ticket_queue": "nr3ipAqP"}, "sort_tickets": [{"search_result": "sBKIzDih", "threshold": 52, "ticket_queue": "30wBSSGW"}, {"search_result": "52CtRhAM", "threshold": 65, "ticket_queue": "R4idso9y"}, {"search_result": "V8RqTVrP", "threshold": 55, "ticket_queue": "J1hgvQHJ"}], "sub_game_modes": {"8cV66QAm": {"alliance": {"combination": {"alliances": [[{"max": 92, "min": 24, "name": "zSz6nPsc"}, {"max": 68, "min": 56, "name": "Dq8hEAQw"}, {"max": 48, "min": 49, "name": "jbckV6Hu"}], [{"max": 56, "min": 69, "name": "UxDtvhBJ"}, {"max": 62, "min": 9, "name": "eAyHyQn2"}, {"max": 21, "min": 97, "name": "gSxEdd2d"}], [{"max": 61, "min": 7, "name": "dBTNGghi"}, {"max": 68, "min": 99, "name": "qpyBvWjU"}, {"max": 73, "min": 22, "name": "C6g4XJSn"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 2, "role_flexing_second": 13}, "max_number": 12, "min_number": 97, "player_max_number": 1, "player_min_number": 22}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 26, "min": 18, "name": "qXd2eQDi"}, {"max": 16, "min": 84, "name": "hujC0Bud"}, {"max": 93, "min": 19, "name": "qw7PGazR"}], [{"max": 3, "min": 46, "name": "uv8F5STa"}, {"max": 96, "min": 36, "name": "ifsUFgCV"}, {"max": 23, "min": 6, "name": "7O1R3Y1F"}], [{"max": 19, "min": 80, "name": "w2RcXJUT"}, {"max": 35, "min": 70, "name": "ieI3tAjS"}, {"max": 96, "min": 96, "name": "w08aeSg8"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 64, "role_flexing_second": 25}, "duration": 89, "max_number": 67, "min_number": 30, "player_max_number": 6, "player_min_number": 46}, {"combination": {"alliances": [[{"max": 56, "min": 22, "name": "NeQiQAvB"}, {"max": 77, "min": 48, "name": "MaszInAR"}, {"max": 17, "min": 37, "name": "o5fJP08Y"}], [{"max": 10, "min": 49, "name": "5UYAjWFL"}, {"max": 56, "min": 70, "name": "POCyNZHv"}, {"max": 11, "min": 9, "name": "F71jqMrP"}], [{"max": 29, "min": 21, "name": "QsfouI6J"}, {"max": 87, "min": 79, "name": "oW7LU4Sc"}, {"max": 52, "min": 66, "name": "T5BDykyJ"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 31, "role_flexing_second": 32}, "duration": 8, "max_number": 95, "min_number": 38, "player_max_number": 9, "player_min_number": 29}, {"combination": {"alliances": [[{"max": 34, "min": 4, "name": "FEMTs3HO"}, {"max": 6, "min": 3, "name": "GNKG1HT5"}, {"max": 42, "min": 37, "name": "7j5rEMZj"}], [{"max": 100, "min": 94, "name": "0DxYYUoh"}, {"max": 50, "min": 52, "name": "QuKcuvSx"}, {"max": 49, "min": 99, "name": "PRnYnqkY"}], [{"max": 12, "min": 26, "name": "f99CvfLx"}, {"max": 4, "min": 23, "name": "P6daS6g5"}, {"max": 63, "min": 40, "name": "AKbTYBEp"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 62, "role_flexing_second": 15}, "duration": 26, "max_number": 44, "min_number": 44, "player_max_number": 12, "player_min_number": 65}], "name": "3ps8aIZO"}, "AcQSR8Xa": {"alliance": {"combination": {"alliances": [[{"max": 81, "min": 19, "name": "kPXwFcBz"}, {"max": 24, "min": 75, "name": "sIQuFkle"}, {"max": 83, "min": 74, "name": "igc0KaSD"}], [{"max": 12, "min": 85, "name": "0oCXhHv4"}, {"max": 62, "min": 88, "name": "pUugmDz6"}, {"max": 66, "min": 24, "name": "iKAQZZFv"}], [{"max": 11, "min": 65, "name": "SSgswqVT"}, {"max": 61, "min": 24, "name": "x6hrsGhJ"}, {"max": 6, "min": 60, "name": "Q5Xxhsb7"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 55, "role_flexing_second": 9}, "max_number": 38, "min_number": 21, "player_max_number": 71, "player_min_number": 88}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 30, "min": 44, "name": "yFOuvbqX"}, {"max": 58, "min": 44, "name": "4DMAgHbK"}, {"max": 33, "min": 50, "name": "Hfi78kK2"}], [{"max": 61, "min": 47, "name": "aiT11gh3"}, {"max": 23, "min": 18, "name": "JwmHltjy"}, {"max": 62, "min": 84, "name": "XWmlSF5Y"}], [{"max": 13, "min": 48, "name": "3jwV4Cge"}, {"max": 44, "min": 100, "name": "x3d03kO2"}, {"max": 46, "min": 44, "name": "X7o3bUw8"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 9, "role_flexing_second": 43}, "duration": 4, "max_number": 11, "min_number": 72, "player_max_number": 47, "player_min_number": 76}, {"combination": {"alliances": [[{"max": 34, "min": 90, "name": "y6bmQjJF"}, {"max": 98, "min": 38, "name": "eFPNzkRA"}, {"max": 57, "min": 0, "name": "v1XUuxvk"}], [{"max": 79, "min": 23, "name": "hvtwFQdd"}, {"max": 25, "min": 86, "name": "iw4s2X8f"}, {"max": 28, "min": 28, "name": "oHesaYqL"}], [{"max": 36, "min": 12, "name": "mVuSTkqq"}, {"max": 8, "min": 13, "name": "l1KcgcMk"}, {"max": 11, "min": 90, "name": "uiWCf8zQ"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 10, "role_flexing_second": 95}, "duration": 71, "max_number": 44, "min_number": 32, "player_max_number": 71, "player_min_number": 61}, {"combination": {"alliances": [[{"max": 1, "min": 55, "name": "nM5DSMjR"}, {"max": 80, "min": 27, "name": "Q1txrx4D"}, {"max": 89, "min": 99, "name": "wFxbwrJO"}], [{"max": 85, "min": 69, "name": "h0ka4mgO"}, {"max": 18, "min": 81, "name": "oLIDaQcr"}, {"max": 98, "min": 54, "name": "pXEoLLEn"}], [{"max": 0, "min": 62, "name": "mjL4ALPz"}, {"max": 71, "min": 56, "name": "7RVm12rC"}, {"max": 47, "min": 73, "name": "eoyKL2yA"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 12, "role_flexing_second": 88}, "duration": 9, "max_number": 30, "min_number": 78, "player_max_number": 17, "player_min_number": 98}], "name": "YMAwI9VE"}, "QkryOMvR": {"alliance": {"combination": {"alliances": [[{"max": 39, "min": 74, "name": "VfaN7W2h"}, {"max": 100, "min": 3, "name": "THwU3MWx"}, {"max": 39, "min": 79, "name": "eN41UXMX"}], [{"max": 40, "min": 66, "name": "SMI9Ezod"}, {"max": 66, "min": 25, "name": "gy6bsaYf"}, {"max": 63, "min": 68, "name": "YwN6RVKg"}], [{"max": 40, "min": 88, "name": "7orlzSzY"}, {"max": 47, "min": 14, "name": "b8ozhxM6"}, {"max": 66, "min": 44, "name": "MngOAFV3"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 30, "role_flexing_second": 16}, "max_number": 14, "min_number": 72, "player_max_number": 81, "player_min_number": 34}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 24, "min": 20, "name": "hI7aDF08"}, {"max": 100, "min": 26, "name": "FvkTxU5w"}, {"max": 45, "min": 6, "name": "mvlBDfZq"}], [{"max": 3, "min": 54, "name": "vtVeroL4"}, {"max": 70, "min": 31, "name": "d50rTDBS"}, {"max": 62, "min": 53, "name": "2zvwdKmR"}], [{"max": 44, "min": 41, "name": "XdWjnnjL"}, {"max": 85, "min": 89, "name": "OhaOs6Cz"}, {"max": 84, "min": 33, "name": "rgluNS2H"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 28, "role_flexing_second": 86}, "duration": 66, "max_number": 8, "min_number": 42, "player_max_number": 88, "player_min_number": 11}, {"combination": {"alliances": [[{"max": 13, "min": 88, "name": "1fqbGPYD"}, {"max": 65, "min": 88, "name": "7JxRYgaT"}, {"max": 85, "min": 36, "name": "VcrAeT8q"}], [{"max": 45, "min": 99, "name": "ixaId3u1"}, {"max": 86, "min": 67, "name": "GmmYhKbR"}, {"max": 92, "min": 88, "name": "YFlqWnFn"}], [{"max": 40, "min": 44, "name": "BoQ0SwVC"}, {"max": 16, "min": 85, "name": "Bc2V4rmw"}, {"max": 89, "min": 91, "name": "KhkxBAMH"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 42, "role_flexing_second": 91}, "duration": 5, "max_number": 98, "min_number": 71, "player_max_number": 44, "player_min_number": 58}, {"combination": {"alliances": [[{"max": 23, "min": 19, "name": "Mk8k6V8t"}, {"max": 12, "min": 52, "name": "3SrEnsKn"}, {"max": 69, "min": 63, "name": "vfv8vgMR"}], [{"max": 26, "min": 33, "name": "uFaNciIC"}, {"max": 44, "min": 61, "name": "82vDDNOx"}, {"max": 14, "min": 30, "name": "25b66lfn"}], [{"max": 92, "min": 92, "name": "y1yDyRLS"}, {"max": 46, "min": 55, "name": "Z2QYjoLu"}, {"max": 7, "min": 75, "name": "iNxtGOeq"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 93, "role_flexing_second": 18}, "duration": 43, "max_number": 11, "min_number": 38, "player_max_number": 85, "player_min_number": 26}], "name": "d42UE9a9"}}, "ticket_flexing_selection": "iPO0qwhd", "ticket_flexing_selections": [{"selection": "9Tqk149y", "threshold": 70}, {"selection": "4JDnVACJ", "threshold": 26}, {"selection": "0QaiXSLq", "threshold": 17}], "use_newest_ticket_for_flexing": false}, "session_queue_timeout_seconds": 45, "social_matchmaking": false, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'sZJUBWIY' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'IgcYg8HY' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "cGt8rqVL", "players": [{"results": [{"attribute": "JND8xoZb", "value": 0.6779226292143571}, {"attribute": "1hcVtQN2", "value": 0.7330342444781893}, {"attribute": "ZXmqMnyU", "value": 0.8602054877873778}], "user_id": "rmwbdmxn"}, {"results": [{"attribute": "9TgH1GE2", "value": 0.16151153597420187}, {"attribute": "wdPQkd70", "value": 0.1228623503660734}, {"attribute": "s2tj5iCd", "value": 0.05220331691506386}], "user_id": "U4x98iIE"}, {"results": [{"attribute": "Ml0F8KeS", "value": 0.03550586127831645}, {"attribute": "U38xaJ8v", "value": 0.13215453501148944}, {"attribute": "Zw2HilAG", "value": 0.4725218671938505}], "user_id": "FFf8pPaZ"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "g2uxtsx7"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "THLdeGSw", "client_version": "el3nZ4II", "deployment": "8VQXLXTG", "error_code": 74, "error_message": "gtOC4v6y", "game_mode": "rM31jXdZ", "is_mock": "9HkXTHew", "joinable": true, "match_id": "RDPN4YcA", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 25, "party_attributes": {"e9EBHpJt": {}, "7p7YcTOt": {}, "F9hazT5O": {}}, "party_id": "mh0LSfzU", "party_members": [{"extra_attributes": {"dqml4IrN": {}, "KocczW1d": {}, "CsBGtGkb": {}}, "user_id": "CtwwLcpH"}, {"extra_attributes": {"bqR2vNMU": {}, "IKH1zKLP": {}, "fVfAzKGl": {}}, "user_id": "TQkfvJrl"}, {"extra_attributes": {"gbei8sTi": {}, "IcydPp0t": {}, "L6GQx8f1": {}}, "user_id": "cLbkluqC"}], "ticket_created_at": 81, "ticket_id": "dipmN8Ab"}, {"first_ticket_created_at": 66, "party_attributes": {"BGGbYvuo": {}, "YJpE4D8H": {}, "foOdBJgy": {}}, "party_id": "8muFFvc9", "party_members": [{"extra_attributes": {"prXZ3GVh": {}, "YIEtjx41": {}, "V8Y9xtFG": {}}, "user_id": "jjPdTxms"}, {"extra_attributes": {"fepHjodR": {}, "qjDXHNDs": {}, "hwaOmAto": {}}, "user_id": "8bDHdqy8"}, {"extra_attributes": {"YFpNXt08": {}, "O2pAlSxH": {}, "tsYOTDtx": {}}, "user_id": "DVYoJeKq"}], "ticket_created_at": 17, "ticket_id": "q4BooU3o"}, {"first_ticket_created_at": 63, "party_attributes": {"dyAWg3Eb": {}, "bQ8gErQo": {}, "9FsWAbQ9": {}}, "party_id": "Vyj2PYAj", "party_members": [{"extra_attributes": {"U9JnXR03": {}, "7MKb57zj": {}, "XZB04RdG": {}}, "user_id": "jmfilY0s"}, {"extra_attributes": {"n8w4zMZS": {}, "gTlFNXkw": {}, "nkWXrVPU": {}}, "user_id": "eboQZNaG"}, {"extra_attributes": {"UqvkC4Uh": {}, "8irAvZYi": {}, "iXbB0TnY": {}}, "user_id": "C0IBvJqy"}], "ticket_created_at": 98, "ticket_id": "4u6zakPF"}]}, {"matching_parties": [{"first_ticket_created_at": 86, "party_attributes": {"YXCHFGGX": {}, "yQ0taB3d": {}, "oZQhu6qL": {}}, "party_id": "y7KnhFEG", "party_members": [{"extra_attributes": {"2yukXwpi": {}, "jeddHuX4": {}, "xmKI4OST": {}}, "user_id": "2EaBG3zj"}, {"extra_attributes": {"NDHCVo0j": {}, "ncsGTkks": {}, "mykZkos4": {}}, "user_id": "eCEVPrkq"}, {"extra_attributes": {"Qx0nxna0": {}, "YfYcp7Ed": {}, "slE2zQwk": {}}, "user_id": "Rw0k9srr"}], "ticket_created_at": 82, "ticket_id": "PsoisQ8y"}, {"first_ticket_created_at": 84, "party_attributes": {"UToZctfp": {}, "wKCb20dR": {}, "QfFQjY7S": {}}, "party_id": "FVtgE51N", "party_members": [{"extra_attributes": {"HmH5b3S6": {}, "Kq8VNNIX": {}, "47OVGdH3": {}}, "user_id": "8WkYat3K"}, {"extra_attributes": {"oxsUX4qp": {}, "VjxQo991": {}, "M7zDxx1X": {}}, "user_id": "oo6xQKKA"}, {"extra_attributes": {"gwt0Opu0": {}, "uqdOPPUn": {}, "jl8SxYBe": {}}, "user_id": "GKFLwk5G"}], "ticket_created_at": 39, "ticket_id": "1EU5X4Ac"}, {"first_ticket_created_at": 41, "party_attributes": {"jacJjG3l": {}, "byXg5orn": {}, "ZawS4Alp": {}}, "party_id": "mRjOvyLk", "party_members": [{"extra_attributes": {"PCYWCleX": {}, "yxaerpY0": {}, "Ks16f3QJ": {}}, "user_id": "akLFCDkV"}, {"extra_attributes": {"uvp2Gd6f": {}, "QovpNdq5": {}, "gwuPq7li": {}}, "user_id": "yUJvqub4"}, {"extra_attributes": {"KfmTBF3a": {}, "x6qfQLfT": {}, "3gGztMRU": {}}, "user_id": "kMFf8WbA"}], "ticket_created_at": 97, "ticket_id": "gzPXGRHh"}]}, {"matching_parties": [{"first_ticket_created_at": 88, "party_attributes": {"wyMF3fNr": {}, "3FvRyiET": {}, "hWRCGGvq": {}}, "party_id": "VTPStQPP", "party_members": [{"extra_attributes": {"lcCRG2Zb": {}, "xUTkxWFl": {}, "Ar708pvq": {}}, "user_id": "rk949raW"}, {"extra_attributes": {"mfOGhhq9": {}, "6KUVGeXU": {}, "YkQVgfyw": {}}, "user_id": "AOJK8ynP"}, {"extra_attributes": {"YYrPrWas": {}, "c5382ynJ": {}, "3I9cr2o8": {}}, "user_id": "A0LqaMnI"}], "ticket_created_at": 73, "ticket_id": "dStqtHFi"}, {"first_ticket_created_at": 71, "party_attributes": {"NtS0WrPy": {}, "izA1APzM": {}, "ciqpMkdQ": {}}, "party_id": "YwGcc4P7", "party_members": [{"extra_attributes": {"CTT5tERq": {}, "Lc6NOZdj": {}, "T9eIG2ab": {}}, "user_id": "liM2S2CZ"}, {"extra_attributes": {"2JoHvgGN": {}, "nsFBYkCz": {}, "Oh5p8uxM": {}}, "user_id": "wKT9ZhjA"}, {"extra_attributes": {"wPwUqBhe": {}, "zJ6MEBGL": {}, "Rq5WNg3u": {}}, "user_id": "MJleaMco"}], "ticket_created_at": 50, "ticket_id": "6hr9d3Gq"}, {"first_ticket_created_at": 34, "party_attributes": {"xSlSjaXK": {}, "NSwNHD9p": {}, "C5eZRupY": {}}, "party_id": "ux53QZdp", "party_members": [{"extra_attributes": {"rBHEKgS4": {}, "nyG4zsxE": {}, "r6wIdJJj": {}}, "user_id": "xP6GoToZ"}, {"extra_attributes": {"TZ9d0VHO": {}, "xgg9MbEa": {}, "oOio5BmY": {}}, "user_id": "cDI4BkKd"}, {"extra_attributes": {"MMH5AfG6": {}, "imvREO0W": {}, "CTDj3oHA": {}}, "user_id": "viG9gq0B"}], "ticket_created_at": 98, "ticket_id": "zWmIjD3G"}]}], "namespace": "w7jOaQW5", "party_attributes": {"nHu9amvz": {}, "S33jWdA0": {}, "UfGBYh10": {}}, "party_id": "sdxygmMx", "queued_at": 86, "region": "PGqE0NJr", "server_name": "kDUbH6dc", "status": "poaup5VZ", "ticket_id": "fSqjvAqF", "ticket_ids": ["rr7wvdqr", "aGwjmOk9", "WySbW46K"], "updated_at": "1980-09-26T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "KqHZNrdM"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'wO6MSkyz' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 15, "userID": "pAsRmOzY", "weight": 0.2345544526464901}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'veiJ57TS' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy 'bfiFnta3' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'X0BG8A75' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCannotMatch", "deployment": "caav1x9o", "description": "uAYWNSix", "findMatchTimeoutSeconds": 10, "joinable": true, "max_delay_ms": 76, "region_expansion_range_ms": 6, "region_expansion_rate_ms": 17, "region_latency_initial_range_ms": 74, "region_latency_max_ms": 12, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 47, "min": 25, "name": "OFB71OvG"}, {"max": 46, "min": 92, "name": "1eq5qugi"}, {"max": 11, "min": 41, "name": "m5rEuXdO"}], [{"max": 77, "min": 45, "name": "5ltUUEob"}, {"max": 84, "min": 5, "name": "GJjQLRrg"}, {"max": 87, "min": 78, "name": "Q0DFLOK6"}], [{"max": 62, "min": 7, "name": "6NdWIGog"}, {"max": 38, "min": 29, "name": "W8GmCuoG"}, {"max": 58, "min": 48, "name": "WHf5qdUx"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 92, "role_flexing_second": 40}, "maxNumber": 69, "minNumber": 61, "playerMaxNumber": 57, "playerMinNumber": 50}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 15, "min": 71, "name": "kRv6pFSD"}, {"max": 72, "min": 80, "name": "sOPpI06I"}, {"max": 43, "min": 46, "name": "M1b9Aecp"}], [{"max": 78, "min": 46, "name": "eZl2gumZ"}, {"max": 99, "min": 97, "name": "TX8yCEdD"}, {"max": 30, "min": 76, "name": "gXuXATKf"}], [{"max": 69, "min": 79, "name": "omixBcUV"}, {"max": 42, "min": 96, "name": "o6J6ctds"}, {"max": 41, "min": 16, "name": "wk6fEnE4"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 58, "role_flexing_second": 40}, "duration": 35, "max_number": 6, "min_number": 85, "player_max_number": 57, "player_min_number": 97}, {"combination": {"alliances": [[{"max": 5, "min": 79, "name": "UaBCBXfF"}, {"max": 81, "min": 39, "name": "XxpAzs0d"}, {"max": 5, "min": 56, "name": "VNP5g2wK"}], [{"max": 18, "min": 5, "name": "YyB3DINm"}, {"max": 93, "min": 53, "name": "FhNpEaaK"}, {"max": 19, "min": 67, "name": "30kr884a"}], [{"max": 25, "min": 87, "name": "NSQhMUxy"}, {"max": 15, "min": 27, "name": "S4Sw0byE"}, {"max": 48, "min": 85, "name": "Oo9NdvKB"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 67, "role_flexing_second": 47}, "duration": 48, "max_number": 76, "min_number": 61, "player_max_number": 13, "player_min_number": 2}, {"combination": {"alliances": [[{"max": 98, "min": 90, "name": "xliH4gUi"}, {"max": 82, "min": 67, "name": "sBnOpmjk"}, {"max": 18, "min": 82, "name": "lPHlbmUB"}], [{"max": 59, "min": 99, "name": "mFkgb9AZ"}, {"max": 54, "min": 98, "name": "EDn5lBIl"}, {"max": 29, "min": 0, "name": "AojX88dC"}], [{"max": 99, "min": 97, "name": "Q1OozHTf"}, {"max": 69, "min": 41, "name": "KLptneoj"}, {"max": 10, "min": 25, "name": "Y4d3YU1Q"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 46, "role_flexing_second": 51}, "duration": 97, "max_number": 92, "min_number": 70, "player_max_number": 29, "player_min_number": 85}], "batch_size": 18, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 69, "flex_flat_step_range": 74, "flex_immunity_count": 36, "flex_range_max": 99, "flex_rate_ms": 68, "flex_step_max": 66, "force_authority_match": false, "initial_step_range": 82, "mmr_max": 38, "mmr_mean": 19, "mmr_min": 89, "mmr_std_dev": 88, "override_mmr_data": true, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "qQrO5tGB", "criteria": "4sIO95th", "duration": 72, "reference": 0.06767671574020262}, {"attribute": "mGP8S4Vo", "criteria": "Zm1bnwQQ", "duration": 10, "reference": 0.7423417563657578}, {"attribute": "VMY8CpTb", "criteria": "hHcptK2h", "duration": 71, "reference": 0.05637138493477456}], "match_options": {"options": [{"name": "rWG1YaGr", "type": "tgmS0xgn"}, {"name": "PT3lfvMy", "type": "TuBuwr1u"}, {"name": "aiUf0NYl", "type": "Kz8XhAXG"}]}, "matchingRules": [{"attribute": "JOeOLh93", "criteria": "KbpVZEJ4", "reference": 0.8242492820847652}, {"attribute": "cRMN0nDp", "criteria": "kaXbytXj", "reference": 0.21480291581218358}, {"attribute": "IenvvwvX", "criteria": "8ffQ9hR2", "reference": 0.9538351578545216}], "sort_ticket": {"search_result": "nc5ktppn", "ticket_queue": "rKMvus5S"}, "sort_tickets": [{"search_result": "oP2UaCAL", "threshold": 35, "ticket_queue": "edlwwT8L"}, {"search_result": "rIZxNn8v", "threshold": 79, "ticket_queue": "7j93e1V1"}, {"search_result": "iwgsnB18", "threshold": 70, "ticket_queue": "KDrHBWoi"}], "sub_game_modes": {}, "ticket_flexing_selection": "szvpK1sw", "ticket_flexing_selections": [{"selection": "scd4q4zy", "threshold": 71}, {"selection": "L6KTg5F3", "threshold": 42}, {"selection": "K7XWHkHe", "threshold": 15}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 80, "socialMatchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName '9AX2Q18a' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'sxD0koqe' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'vu2oSWX0' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 55}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'u4VQ6BAt' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName '9ad4oVCf' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "goTJtEBU", "count": 13, "mmrMax": 0.26625594634466765, "mmrMean": 0.9896628514085589, "mmrMin": 0.8261262681759581, "mmrStdDev": 0.019134781980224225}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName '6cyPcQO4' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 22, "party_attributes": {"hPWOMdEH": {}, "s6yu9ks4": {}, "MakvdOAQ": {}}, "party_id": "cWgwo6mP", "party_members": [{"extra_attributes": {"VlpDpuav": {}, "awCrZ1gl": {}, "UZGc4mbo": {}}, "user_id": "OWbqAqM4"}, {"extra_attributes": {"EAFJC7h8": {}, "12pZqzcE": {}, "bDviI1g6": {}}, "user_id": "76IAsHFz"}, {"extra_attributes": {"JfeTI4OR": {}, "Ncv0fYPF": {}, "u82qqP60": {}}, "user_id": "xJ6AYl7M"}], "ticket_created_at": 29, "ticket_id": "O4qPIbbZ"}, {"first_ticket_created_at": 27, "party_attributes": {"JQwIyAAj": {}, "G4dmuTT5": {}, "IMwXqnaQ": {}}, "party_id": "nBMTHRWh", "party_members": [{"extra_attributes": {"TGHDJ0GK": {}, "Uktbpo3T": {}, "JfcjdI4f": {}}, "user_id": "XTFgv211"}, {"extra_attributes": {"mNNYuQOO": {}, "5MOfirzB": {}, "FUvo9mGW": {}}, "user_id": "9oOjg2ba"}, {"extra_attributes": {"t2o7pL7C": {}, "uVk5fIqY": {}, "neCT6YK4": {}}, "user_id": "lZEMliLQ"}], "ticket_created_at": 35, "ticket_id": "fNCoZHQm"}, {"first_ticket_created_at": 9, "party_attributes": {"0RzHR0Bz": {}, "Y9HXteaZ": {}, "V0X79AVE": {}}, "party_id": "4oBhblT3", "party_members": [{"extra_attributes": {"mG9eei9P": {}, "9uWCpRzO": {}, "RtBx6A3K": {}}, "user_id": "rPnjDLsW"}, {"extra_attributes": {"Leu5zFiF": {}, "Ac0JH2xI": {}, "HEVjqVNA": {}}, "user_id": "D4TMHnPd"}, {"extra_attributes": {"PvWSzbgA": {}, "UFSHhVof": {}, "mMSsDcRS": {}}, "user_id": "Fik020DA"}], "ticket_created_at": 99, "ticket_id": "olBGy2gY"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'nNC0AU3v' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 99}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'IUCWCfdk' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'J9Qc856Y' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'tAtju11I' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["hw2ufsf9", "QZNvRydi", "6x2ZwDJT"], "party_id": "84D4nzoo", "user_id": "tfxk55CG"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'pvo3wxaj' \
    --matchID 'qc5cX1M4' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'Hfx9A2Ir' \
    --matchID 'wIRXl6H2' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'ImzGFqzW' \
    --matchID 'IJD5nOuU' \
    --namespace $AB_NAMESPACE \
    --userID 'R29BpqJf' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'IoAQVlyi' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName '9dnVkzxv' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE