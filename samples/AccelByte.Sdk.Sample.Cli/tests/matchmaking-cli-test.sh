#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '25' \
    --offset '47' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatchOnDifferentTeam", "deployment": "fZPhpLRd", "description": "U3Iwtr6R", "find_match_timeout_seconds": 93, "game_mode": "9VtTp6F5", "joinable": true, "max_delay_ms": 73, "region_expansion_range_ms": 37, "region_expansion_rate_ms": 19, "region_latency_initial_range_ms": 85, "region_latency_max_ms": 39, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 0, "min": 93, "name": "m8BclKAr"}, {"max": 50, "min": 88, "name": "msyYhfQ7"}, {"max": 30, "min": 78, "name": "1uMs6uS0"}], [{"max": 43, "min": 16, "name": "vO2vlTQ9"}, {"max": 27, "min": 4, "name": "RjKL7Z65"}, {"max": 52, "min": 60, "name": "qOgBMdHj"}], [{"max": 87, "min": 2, "name": "1T7f8UZ0"}, {"max": 47, "min": 59, "name": "530TQoXd"}, {"max": 32, "min": 69, "name": "pvKvKOOS"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 5, "role_flexing_second": 45}, "max_number": 13, "min_number": 68, "player_max_number": 54, "player_min_number": 9}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 72, "min": 4, "name": "JswCQ8OM"}, {"max": 81, "min": 45, "name": "f0XTpUoC"}, {"max": 49, "min": 91, "name": "APIqQsiF"}], [{"max": 27, "min": 81, "name": "zMKAMWVN"}, {"max": 19, "min": 70, "name": "YxmJA49S"}, {"max": 77, "min": 25, "name": "pnCHMgCo"}], [{"max": 21, "min": 7, "name": "JSKv98tN"}, {"max": 96, "min": 67, "name": "eQQfXBbp"}, {"max": 77, "min": 50, "name": "atUCVzTN"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 72, "role_flexing_second": 64}, "duration": 57, "max_number": 71, "min_number": 90, "player_max_number": 68, "player_min_number": 64}, {"combination": {"alliances": [[{"max": 69, "min": 32, "name": "EzoFOTuu"}, {"max": 61, "min": 24, "name": "PgFrBfo0"}, {"max": 89, "min": 57, "name": "lfhh2fTa"}], [{"max": 0, "min": 97, "name": "wG1g2rvy"}, {"max": 49, "min": 69, "name": "lXCEHudl"}, {"max": 62, "min": 73, "name": "bNd06JuP"}], [{"max": 2, "min": 25, "name": "aWQbDpVn"}, {"max": 97, "min": 16, "name": "YAcQcRgj"}, {"max": 15, "min": 89, "name": "WOB1BNYj"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 0, "role_flexing_second": 93}, "duration": 55, "max_number": 80, "min_number": 34, "player_max_number": 43, "player_min_number": 33}, {"combination": {"alliances": [[{"max": 54, "min": 97, "name": "cK67mnGr"}, {"max": 4, "min": 64, "name": "q0owF1C6"}, {"max": 71, "min": 91, "name": "nw1WeqPw"}], [{"max": 51, "min": 39, "name": "FEc7t6Ai"}, {"max": 76, "min": 50, "name": "9b5bLsHr"}, {"max": 95, "min": 60, "name": "DGayn5Hr"}], [{"max": 89, "min": 81, "name": "YnfXMVe6"}, {"max": 75, "min": 38, "name": "41CCR4Sm"}, {"max": 49, "min": 74, "name": "oLxFEOCP"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 38, "role_flexing_second": 40}, "duration": 71, "max_number": 83, "min_number": 44, "player_max_number": 49, "player_min_number": 46}], "batch_size": 100, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 12, "flex_flat_step_range": 42, "flex_immunity_count": 54, "flex_range_max": 29, "flex_rate_ms": 51, "flex_step_max": 32, "force_authority_match": false, "initial_step_range": 84, "mmr_max": 76, "mmr_mean": 53, "mmr_min": 99, "mmr_std_dev": 46, "override_mmr_data": true, "use_bucket_mmr": true, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "mnfufqRy", "criteria": "bxgcVp4i", "duration": 90, "reference": 0.23954368954193705}, {"attribute": "JaEbQJgp", "criteria": "lC2vDtAU", "duration": 43, "reference": 0.010707243261638744}, {"attribute": "c1ZNjTPx", "criteria": "rBXOidUu", "duration": 8, "reference": 0.6998214498253634}], "match_options": {"options": [{"name": "JTzoakpF", "type": "9OPPYfLd"}, {"name": "Y6898TUY", "type": "HrDyobaV"}, {"name": "eKXKMosI", "type": "v1RWe7PQ"}]}, "matching_rule": [{"attribute": "Ym6J6W4v", "criteria": "OMLHXS0P", "reference": 0.06731141917369998}, {"attribute": "zLhH3wZ8", "criteria": "FWuCmBQB", "reference": 0.9014054589866713}, {"attribute": "Z1pwTnoh", "criteria": "qD4MZut3", "reference": 0.08830278074679021}], "rebalance_enable": true, "sort_ticket": {"search_result": "KEDpA5SO", "ticket_queue": "h0g1QA3H"}, "sort_tickets": [{"search_result": "XJqSoOwa", "threshold": 49, "ticket_queue": "clfTxOJL"}, {"search_result": "0MODTQHw", "threshold": 17, "ticket_queue": "ZMh1egFZ"}, {"search_result": "RB8AyAOx", "threshold": 26, "ticket_queue": "6LQBbQip"}], "sub_game_modes": {"viI8Ywo3": {"alliance": {"combination": {"alliances": [[{"max": 49, "min": 73, "name": "UGdG0KYP"}, {"max": 7, "min": 13, "name": "D7BAiLfo"}, {"max": 98, "min": 9, "name": "NRlDdPCe"}], [{"max": 57, "min": 31, "name": "QG6Zb0mj"}, {"max": 100, "min": 2, "name": "NOukpXTx"}, {"max": 36, "min": 69, "name": "KPLz5dY0"}], [{"max": 88, "min": 57, "name": "CJNLKIdP"}, {"max": 52, "min": 21, "name": "YA9eaG8y"}, {"max": 0, "min": 38, "name": "evs9RY0L"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 37, "role_flexing_second": 38}, "max_number": 3, "min_number": 30, "player_max_number": 21, "player_min_number": 78}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 64, "min": 16, "name": "tKUHbDVT"}, {"max": 62, "min": 71, "name": "g6VUfSwj"}, {"max": 69, "min": 95, "name": "UmlOgUKO"}], [{"max": 87, "min": 86, "name": "C60knAZ3"}, {"max": 96, "min": 66, "name": "B1A92IWv"}, {"max": 25, "min": 50, "name": "pdC6cpUu"}], [{"max": 70, "min": 8, "name": "MKkvt5qc"}, {"max": 93, "min": 23, "name": "PSGbV0M4"}, {"max": 28, "min": 35, "name": "tRX8N1dx"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 62, "role_flexing_second": 1}, "duration": 6, "max_number": 49, "min_number": 13, "player_max_number": 10, "player_min_number": 24}, {"combination": {"alliances": [[{"max": 45, "min": 58, "name": "vl96riIp"}, {"max": 13, "min": 47, "name": "hRRjXgky"}, {"max": 77, "min": 83, "name": "9gU6rYtt"}], [{"max": 54, "min": 71, "name": "zGmo4ql0"}, {"max": 49, "min": 46, "name": "xwZc3Fhv"}, {"max": 32, "min": 74, "name": "y4uZ1qnP"}], [{"max": 23, "min": 75, "name": "0Vsti1ar"}, {"max": 17, "min": 8, "name": "zwbQpexl"}, {"max": 2, "min": 34, "name": "Ij05K5JN"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 78, "role_flexing_second": 49}, "duration": 47, "max_number": 87, "min_number": 76, "player_max_number": 83, "player_min_number": 89}, {"combination": {"alliances": [[{"max": 3, "min": 38, "name": "5SDUSpO9"}, {"max": 19, "min": 47, "name": "IR73CGuB"}, {"max": 29, "min": 33, "name": "YPTAchKm"}], [{"max": 26, "min": 15, "name": "4hJDYvMG"}, {"max": 95, "min": 59, "name": "vop5zyu8"}, {"max": 21, "min": 80, "name": "qchw9QYr"}], [{"max": 56, "min": 71, "name": "jw9n6qFR"}, {"max": 88, "min": 28, "name": "ZuZChOnU"}, {"max": 81, "min": 37, "name": "sN5GX3Ws"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 36, "role_flexing_second": 19}, "duration": 4, "max_number": 34, "min_number": 55, "player_max_number": 94, "player_min_number": 70}], "name": "lWDfCzqo"}, "o42nEe6b": {"alliance": {"combination": {"alliances": [[{"max": 14, "min": 65, "name": "t1HNUV1C"}, {"max": 20, "min": 19, "name": "C9rUE3Ju"}, {"max": 34, "min": 21, "name": "33sNbXbq"}], [{"max": 76, "min": 22, "name": "LpRWcLZU"}, {"max": 37, "min": 87, "name": "3SOdo1pt"}, {"max": 9, "min": 43, "name": "RfPfTSVu"}], [{"max": 99, "min": 65, "name": "tvXXlq3E"}, {"max": 66, "min": 48, "name": "jxzckX0r"}, {"max": 83, "min": 22, "name": "0LOiKSx4"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 6, "role_flexing_second": 2}, "max_number": 77, "min_number": 31, "player_max_number": 61, "player_min_number": 71}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 9, "min": 20, "name": "qWJ4KOPZ"}, {"max": 68, "min": 94, "name": "B5T55GKh"}, {"max": 19, "min": 32, "name": "4UjpPNhm"}], [{"max": 55, "min": 79, "name": "1SRARDqL"}, {"max": 96, "min": 44, "name": "bAXoEIZQ"}, {"max": 17, "min": 56, "name": "yqBpoaKb"}], [{"max": 90, "min": 14, "name": "pisI3kU8"}, {"max": 36, "min": 9, "name": "hJgEkLXd"}, {"max": 6, "min": 69, "name": "VHhNKCnp"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 99, "role_flexing_second": 76}, "duration": 80, "max_number": 75, "min_number": 94, "player_max_number": 33, "player_min_number": 66}, {"combination": {"alliances": [[{"max": 71, "min": 38, "name": "XMunq81e"}, {"max": 60, "min": 38, "name": "PQcgiOxo"}, {"max": 6, "min": 22, "name": "xUAK5Y4p"}], [{"max": 29, "min": 79, "name": "p0FvN1Wx"}, {"max": 87, "min": 16, "name": "JMWxAZfW"}, {"max": 42, "min": 31, "name": "e02cFKZR"}], [{"max": 63, "min": 54, "name": "KldhNBw7"}, {"max": 75, "min": 81, "name": "8aVWyvbo"}, {"max": 87, "min": 12, "name": "0LpHP10M"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 19, "role_flexing_second": 98}, "duration": 15, "max_number": 43, "min_number": 44, "player_max_number": 17, "player_min_number": 52}, {"combination": {"alliances": [[{"max": 59, "min": 6, "name": "7Q7FHaDc"}, {"max": 66, "min": 64, "name": "31JEhgSv"}, {"max": 21, "min": 2, "name": "BRX8QTEB"}], [{"max": 35, "min": 37, "name": "pBBhfLtr"}, {"max": 54, "min": 21, "name": "Qh4wRAFN"}, {"max": 25, "min": 95, "name": "qUScQngF"}], [{"max": 45, "min": 56, "name": "HgUAKaOn"}, {"max": 25, "min": 33, "name": "hvlv66Lf"}, {"max": 66, "min": 83, "name": "qav8rY9I"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 51, "role_flexing_second": 19}, "duration": 92, "max_number": 2, "min_number": 6, "player_max_number": 53, "player_min_number": 20}], "name": "WzgdfcMz"}, "d75JTqOC": {"alliance": {"combination": {"alliances": [[{"max": 58, "min": 46, "name": "rLwtDm02"}, {"max": 77, "min": 73, "name": "aGHd9pXZ"}, {"max": 30, "min": 32, "name": "9S6DeWVO"}], [{"max": 6, "min": 59, "name": "Le99veSZ"}, {"max": 8, "min": 31, "name": "BUKNfACf"}, {"max": 95, "min": 40, "name": "kgJak9XY"}], [{"max": 24, "min": 66, "name": "ZDAWHlUM"}, {"max": 62, "min": 27, "name": "uObfHpv6"}, {"max": 95, "min": 3, "name": "EDdrn49m"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 31, "role_flexing_second": 27}, "max_number": 82, "min_number": 46, "player_max_number": 41, "player_min_number": 35}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 80, "min": 43, "name": "cuytGw3f"}, {"max": 80, "min": 79, "name": "09lmZFAq"}, {"max": 51, "min": 48, "name": "iAj8KZGi"}], [{"max": 11, "min": 60, "name": "yDzxlgYT"}, {"max": 12, "min": 23, "name": "K3VDFhZX"}, {"max": 83, "min": 53, "name": "dhO1QwYh"}], [{"max": 48, "min": 57, "name": "TqmvAsIA"}, {"max": 61, "min": 5, "name": "GgukPuEP"}, {"max": 53, "min": 84, "name": "RLczQfx1"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 22, "role_flexing_second": 99}, "duration": 1, "max_number": 59, "min_number": 26, "player_max_number": 65, "player_min_number": 58}, {"combination": {"alliances": [[{"max": 22, "min": 75, "name": "iPTjQQny"}, {"max": 13, "min": 25, "name": "x0c3EUsz"}, {"max": 95, "min": 26, "name": "maUIkUgE"}], [{"max": 43, "min": 7, "name": "WAP5JXSI"}, {"max": 29, "min": 60, "name": "ORIJdrL8"}, {"max": 75, "min": 84, "name": "IAx1edjB"}], [{"max": 67, "min": 29, "name": "drCEA6zZ"}, {"max": 64, "min": 61, "name": "bdzi1y7A"}, {"max": 96, "min": 37, "name": "KcR0piCo"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 44, "role_flexing_second": 72}, "duration": 52, "max_number": 93, "min_number": 57, "player_max_number": 97, "player_min_number": 52}, {"combination": {"alliances": [[{"max": 35, "min": 72, "name": "DWB3dnZk"}, {"max": 18, "min": 93, "name": "caINsdqe"}, {"max": 64, "min": 89, "name": "1t1DjN4o"}], [{"max": 44, "min": 26, "name": "UPsZKZ6N"}, {"max": 74, "min": 81, "name": "M88jaEG4"}, {"max": 74, "min": 87, "name": "Ie1VQTn8"}], [{"max": 96, "min": 61, "name": "SKRJMw8y"}, {"max": 46, "min": 22, "name": "6kkebuSw"}, {"max": 1, "min": 84, "name": "LKQq1SEg"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 6, "role_flexing_second": 23}, "duration": 55, "max_number": 35, "min_number": 85, "player_max_number": 27, "player_min_number": 51}], "name": "1jw0fuWf"}}, "ticket_flexing_selection": "a9C2zRPr", "ticket_flexing_selections": [{"selection": "IfHYE1tU", "threshold": 81}, {"selection": "kvGR9Hp9", "threshold": 7}, {"selection": "iJdWtsXd", "threshold": 3}], "use_newest_ticket_for_flexing": false}, "session_queue_timeout_seconds": 39, "social_matchmaking": true, "sub_gamemode_selection": "random", "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'HzhEHLSu' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'GYza5voT' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "DAZ0QfwP", "players": [{"results": [{"attribute": "RdH7nLM0", "value": 0.3476490658980227}, {"attribute": "OXqU22kt", "value": 0.8824944723542929}, {"attribute": "yxib2j5H", "value": 0.028722626697009646}], "user_id": "9zyL0MS3"}, {"results": [{"attribute": "W5BmTKp9", "value": 0.451525486972597}, {"attribute": "HbrkgH6x", "value": 0.7489760205605978}, {"attribute": "IUxznRn7", "value": 0.6602888082796897}], "user_id": "ifXaZT4y"}, {"results": [{"attribute": "IE3z5YTA", "value": 0.9999719508328242}, {"attribute": "tkugeeJ4", "value": 0.1600062124058853}, {"attribute": "buA4Yayt", "value": 0.9839250359421337}], "user_id": "n4SUn4vz"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "wMRPQ0zI"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "PbM1BBJe", "client_version": "fEtSlAq0", "deployment": "x4DXEV3Q", "error_code": 44, "error_message": "2JXA9hCk", "game_mode": "dsCDX1GA", "is_mock": "bOPLsIC4", "joinable": false, "match_id": "cZmXBrMX", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 80, "party_attributes": {"DTjwkUFg": {}, "Y52faElr": {}, "M7wBU34U": {}}, "party_id": "p89c0DWb", "party_members": [{"extra_attributes": {"TciSZkI3": {}, "f1DbK3Kr": {}, "MD1KXyT3": {}}, "user_id": "TVQS0ofj"}, {"extra_attributes": {"iGGY5p4e": {}, "1QYw9GJG": {}, "UDShDLxK": {}}, "user_id": "gFB7SEMX"}, {"extra_attributes": {"YbOapIsT": {}, "U8fZHt7P": {}, "00U6w6dw": {}}, "user_id": "VUpExqwg"}], "ticket_created_at": 71, "ticket_id": "nccxpzaX"}, {"first_ticket_created_at": 79, "party_attributes": {"DT4KRcYK": {}, "kah51Ex8": {}, "t8FyLB1t": {}}, "party_id": "hV5zofxs", "party_members": [{"extra_attributes": {"uBeyYLyw": {}, "AQDN3lo5": {}, "DnrtzuN5": {}}, "user_id": "W5t2wprH"}, {"extra_attributes": {"5GQVqUrs": {}, "7WlaOpCT": {}, "nBeApcqM": {}}, "user_id": "jbTGnOtl"}, {"extra_attributes": {"x0HUw6jo": {}, "monaCRfJ": {}, "rsRv7Fpw": {}}, "user_id": "YI50X3bF"}], "ticket_created_at": 29, "ticket_id": "120n4YvK"}, {"first_ticket_created_at": 3, "party_attributes": {"XjYd6tN9": {}, "JnCQ1oqS": {}, "MDpDa4Ya": {}}, "party_id": "7ZBFvALF", "party_members": [{"extra_attributes": {"71iJJHi7": {}, "VEXagiww": {}, "6HED96ZE": {}}, "user_id": "n7kLMCbY"}, {"extra_attributes": {"L91TMmly": {}, "EACSso1N": {}, "8vsIQJd5": {}}, "user_id": "xkA0dxHo"}, {"extra_attributes": {"O5FTOOit": {}, "vrD9vyoY": {}, "Lw6uScaf": {}}, "user_id": "eieDGSNv"}], "ticket_created_at": 83, "ticket_id": "sqnjLNOy"}]}, {"matching_parties": [{"first_ticket_created_at": 99, "party_attributes": {"qWLneHqA": {}, "Ix8Cm1Z8": {}, "MtfL24qY": {}}, "party_id": "9XPvK7SJ", "party_members": [{"extra_attributes": {"vpTm5FXe": {}, "4it28wsB": {}, "nQrC9iDV": {}}, "user_id": "8BKNQPfX"}, {"extra_attributes": {"MStPcbPh": {}, "kqv0bGUl": {}, "mLd5SU4Y": {}}, "user_id": "djm8Wk6c"}, {"extra_attributes": {"NjkAbltX": {}, "gwaDKob4": {}, "5ufVU6xv": {}}, "user_id": "icA60yVT"}], "ticket_created_at": 24, "ticket_id": "hHJLGirK"}, {"first_ticket_created_at": 54, "party_attributes": {"eu9Ns6yP": {}, "orzoDWAN": {}, "WXMzUuK0": {}}, "party_id": "7vl7bQU7", "party_members": [{"extra_attributes": {"cw0xT7Yq": {}, "U1r0fgjl": {}, "GnWo6Kzx": {}}, "user_id": "rc0T2ziO"}, {"extra_attributes": {"2uItaEUP": {}, "Ny0zvsUK": {}, "WYYcPcVe": {}}, "user_id": "NwUZvTXt"}, {"extra_attributes": {"71eqcHQa": {}, "Y7cvSK0b": {}, "GuNxMYZe": {}}, "user_id": "3DpV7d6x"}], "ticket_created_at": 40, "ticket_id": "j0MPe4Xt"}, {"first_ticket_created_at": 20, "party_attributes": {"719lYSby": {}, "Kp0L0gmP": {}, "Xdwo6tHO": {}}, "party_id": "NJEQ9p3D", "party_members": [{"extra_attributes": {"hLrfOg9r": {}, "4piuqY0l": {}, "CYc0kYVl": {}}, "user_id": "GSfcBF1T"}, {"extra_attributes": {"CCl41TWG": {}, "3hpi6ZKh": {}, "1IohatoV": {}}, "user_id": "806GoBLs"}, {"extra_attributes": {"Uldt7SQC": {}, "t2LMMEgQ": {}, "xdNiRB95": {}}, "user_id": "OM5szWff"}], "ticket_created_at": 63, "ticket_id": "W54L9Wko"}]}, {"matching_parties": [{"first_ticket_created_at": 71, "party_attributes": {"5ABMQnMw": {}, "ARBexpel": {}, "xpeCTtJl": {}}, "party_id": "lCe5H7J8", "party_members": [{"extra_attributes": {"SKyTWJ4o": {}, "SGA4h5hu": {}, "arEoyWUZ": {}}, "user_id": "2dFaDIpC"}, {"extra_attributes": {"YtnyXGzU": {}, "PFmbqxng": {}, "vM4FuovQ": {}}, "user_id": "YhCTX5Jq"}, {"extra_attributes": {"dmVlxsLm": {}, "6C8leRcG": {}, "uBy3cZ3X": {}}, "user_id": "0RU0OUDA"}], "ticket_created_at": 69, "ticket_id": "kBblBfEY"}, {"first_ticket_created_at": 37, "party_attributes": {"3kcAsxBi": {}, "algJuGU5": {}, "VgEO5eaS": {}}, "party_id": "RPR03bQt", "party_members": [{"extra_attributes": {"7o6nXGrd": {}, "q0RjyN42": {}, "sAyLhIKz": {}}, "user_id": "TRHjuLxg"}, {"extra_attributes": {"jwCq5Lih": {}, "zoMgtd5m": {}, "lZ1L8Hsl": {}}, "user_id": "nBtcG3nH"}, {"extra_attributes": {"UNXeI5Kf": {}, "bkWX5Qzr": {}, "JstUDE2A": {}}, "user_id": "KCk2UfrO"}], "ticket_created_at": 63, "ticket_id": "sCl3V2m1"}, {"first_ticket_created_at": 58, "party_attributes": {"NTa3Dd6E": {}, "qg9gSUDy": {}, "utnKulyK": {}}, "party_id": "eO6okVUx", "party_members": [{"extra_attributes": {"kk8t9yrg": {}, "IbRRFfdL": {}, "LmeOUKZI": {}}, "user_id": "oTEkaP4o"}, {"extra_attributes": {"hXU6yyZV": {}, "2AiW2gGq": {}, "dDGSyVPu": {}}, "user_id": "rr1Yo2YC"}, {"extra_attributes": {"bTDiMupA": {}, "vz6e4X40": {}, "lUErEztT": {}}, "user_id": "OJci9N21"}], "ticket_created_at": 94, "ticket_id": "GacxoiBX"}]}], "namespace": "IYbiGLZd", "party_attributes": {"BaLpqZrw": {}, "i5MFWGvz": {}, "E09OXJwq": {}}, "party_id": "Cv114fe6", "queued_at": 2, "region": "HQvJj346", "server_name": "BFr6dRYx", "status": "bRUDPuZL", "ticket_id": "sHornMDU", "ticket_ids": ["5UB8yx3P", "O481aof3", "rYQCKL29"], "updated_at": "1973-10-27T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "MDdadg8O"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'upMZHkAC' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 1, "userID": "zlB9vwig", "weight": 0.7194935909881781}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'Ry2pQYjp' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy 'adAblcf3' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'Y6XLgTP6' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCannotMatch", "deployment": "Jm194550", "description": "2qqSPptW", "findMatchTimeoutSeconds": 21, "joinable": false, "max_delay_ms": 21, "region_expansion_range_ms": 31, "region_expansion_rate_ms": 68, "region_latency_initial_range_ms": 86, "region_latency_max_ms": 18, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 56, "min": 0, "name": "6MPtwxTl"}, {"max": 77, "min": 60, "name": "shhxmE26"}, {"max": 25, "min": 58, "name": "gEaaTw0B"}], [{"max": 90, "min": 99, "name": "dP78rBMN"}, {"max": 45, "min": 41, "name": "NIQS6CZv"}, {"max": 25, "min": 20, "name": "b7ztjYPQ"}], [{"max": 36, "min": 74, "name": "QEGIvHY9"}, {"max": 85, "min": 29, "name": "U1RsAxsN"}, {"max": 58, "min": 50, "name": "txM0uQJd"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 33, "role_flexing_second": 88}, "maxNumber": 15, "minNumber": 73, "playerMaxNumber": 83, "playerMinNumber": 13}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 28, "min": 83, "name": "5A4WMKeY"}, {"max": 3, "min": 3, "name": "ozr40iwR"}, {"max": 37, "min": 45, "name": "02fvoA9Q"}], [{"max": 86, "min": 79, "name": "3thrUF52"}, {"max": 27, "min": 48, "name": "J2DTEmTK"}, {"max": 46, "min": 86, "name": "fZ42w9vz"}], [{"max": 49, "min": 47, "name": "tIUnU6PL"}, {"max": 32, "min": 90, "name": "LwmeEpMp"}, {"max": 80, "min": 80, "name": "gvDUTDrp"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 51, "role_flexing_second": 73}, "duration": 46, "max_number": 78, "min_number": 44, "player_max_number": 40, "player_min_number": 19}, {"combination": {"alliances": [[{"max": 90, "min": 32, "name": "r2gSiBPj"}, {"max": 66, "min": 3, "name": "4FDDtxnt"}, {"max": 93, "min": 89, "name": "MA5gVr1c"}], [{"max": 27, "min": 6, "name": "BxZVHzZM"}, {"max": 32, "min": 60, "name": "xhde46uj"}, {"max": 16, "min": 65, "name": "LaVvtzxo"}], [{"max": 14, "min": 22, "name": "R3y1pwFY"}, {"max": 59, "min": 36, "name": "NFNEyuUM"}, {"max": 60, "min": 3, "name": "841loIjn"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 81, "role_flexing_second": 92}, "duration": 71, "max_number": 98, "min_number": 23, "player_max_number": 58, "player_min_number": 39}, {"combination": {"alliances": [[{"max": 58, "min": 28, "name": "zluS3PBt"}, {"max": 62, "min": 78, "name": "sHogBPGF"}, {"max": 2, "min": 83, "name": "hsfocu4C"}], [{"max": 51, "min": 25, "name": "N2MqJ6VA"}, {"max": 42, "min": 10, "name": "3GcXlP3q"}, {"max": 52, "min": 16, "name": "DRTec0tr"}], [{"max": 71, "min": 79, "name": "HCYg4TFL"}, {"max": 92, "min": 1, "name": "J50QcWNc"}, {"max": 82, "min": 91, "name": "4xmUYBO6"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 91, "role_flexing_second": 99}, "duration": 93, "max_number": 27, "min_number": 89, "player_max_number": 25, "player_min_number": 10}], "batch_size": 34, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 93, "flex_flat_step_range": 0, "flex_immunity_count": 18, "flex_range_max": 76, "flex_rate_ms": 65, "flex_step_max": 33, "force_authority_match": true, "initial_step_range": 96, "mmr_max": 70, "mmr_mean": 97, "mmr_min": 14, "mmr_std_dev": 90, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexingRules": [{"attribute": "ISbQ4EPN", "criteria": "qRfYMXQV", "duration": 99, "reference": 0.623842803102693}, {"attribute": "uEavgmkW", "criteria": "uSsjfAGR", "duration": 53, "reference": 0.9175981446672073}, {"attribute": "wbdzDaAK", "criteria": "SFN8d9u2", "duration": 47, "reference": 0.12269530726532796}], "match_options": {"options": [{"name": "NnQotH73", "type": "NZQ6Vefo"}, {"name": "HMAUtEhn", "type": "Rt3N3vWK"}, {"name": "dzEIaCSJ", "type": "dJxZGusL"}]}, "matchingRules": [{"attribute": "i5iCMOR5", "criteria": "OibvFd8v", "reference": 0.36401145759721887}, {"attribute": "G5mbs0xX", "criteria": "Y3UseqJu", "reference": 0.35893834772736155}, {"attribute": "bktwZ8GW", "criteria": "YiIZHEhX", "reference": 0.6509859595803159}], "sort_ticket": {"search_result": "A9mhSs6n", "ticket_queue": "d6fjqvWN"}, "sort_tickets": [{"search_result": "zyNeN8NI", "threshold": 68, "ticket_queue": "zFaYvTyc"}, {"search_result": "b8MT6BUr", "threshold": 60, "ticket_queue": "9gAcRySE"}, {"search_result": "VAv0AU0P", "threshold": 89, "ticket_queue": "ZcNXUZ4y"}], "sub_game_modes": {}, "ticket_flexing_selection": "0hIuGgj8", "ticket_flexing_selections": [{"selection": "N1SdhNPQ", "threshold": 81}, {"selection": "MjG4sYwm", "threshold": 42}, {"selection": "EPjigF3F", "threshold": 71}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 47, "socialMatchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'vmJNIixT' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'qBrl3PK9' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'wNILpG5K' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 43}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'yZW9R7Qu' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'EkuUeu78' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "YchqgIuM", "count": 31, "mmrMax": 0.45909600695944097, "mmrMean": 0.6652326848189964, "mmrMin": 0.6593969647896636, "mmrStdDev": 0.6331406979571749}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'vARpcgIZ' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 11, "party_attributes": {"KNUoPX3o": {}, "g23c9PND": {}, "NHTtHLrs": {}}, "party_id": "J2cexkH3", "party_members": [{"extra_attributes": {"bI6PwJw2": {}, "KW3eAzp2": {}, "d6n9UWHY": {}}, "user_id": "ecJoXAD7"}, {"extra_attributes": {"42N78eD0": {}, "9Dy91l7X": {}, "XMlbMq0f": {}}, "user_id": "WPdXrtVf"}, {"extra_attributes": {"sFoFTyEh": {}, "FWU9tl2E": {}, "oxzeB8h9": {}}, "user_id": "Z4BX4ryZ"}], "ticket_created_at": 90, "ticket_id": "soFNHasH"}, {"first_ticket_created_at": 24, "party_attributes": {"XDpBsHjT": {}, "SF2t9aGe": {}, "E7wu08JP": {}}, "party_id": "5WWbrpBK", "party_members": [{"extra_attributes": {"NmRxYqsz": {}, "HV3ZBU2T": {}, "LCoymYL2": {}}, "user_id": "x9dhGHfJ"}, {"extra_attributes": {"gx7dvLwY": {}, "wHQbygPm": {}, "2HVagljv": {}}, "user_id": "DmbuCCgj"}, {"extra_attributes": {"vMyEyOg4": {}, "NXhM1M4f": {}, "KsC06tjL": {}}, "user_id": "MdnzGQwO"}], "ticket_created_at": 79, "ticket_id": "8i3w755I"}, {"first_ticket_created_at": 49, "party_attributes": {"H17IIsIX": {}, "xn6Dh3cW": {}, "dHiya3PJ": {}}, "party_id": "o6Sm5bTI", "party_members": [{"extra_attributes": {"OPZoYIhH": {}, "0NCgt3Mi": {}, "R9PyWKdq": {}}, "user_id": "8EcbFyJG"}, {"extra_attributes": {"lPNzk7o7": {}, "9plQyeIZ": {}, "ppPF8i4B": {}}, "user_id": "6DK4PMH0"}, {"extra_attributes": {"7hzFE5An": {}, "2hX60Yer": {}, "aMcFXzxk": {}}, "user_id": "yD5CdelZ"}], "ticket_created_at": 24, "ticket_id": "v8sg6gy8"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName '1kILQGFg' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 11}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'QukaiQts' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName '2xHmS1AD' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'uSyEkTtd' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["jS71SjwV", "ZKLXY0JQ", "54fbuOil"], "party_id": "BOg2SLzi", "user_id": "OhWC191w"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'T5Ef3ZRP' \
    --matchID 'bMdLJxVm' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName '6Iyk5sqW' \
    --matchID 'VmKmZV92' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'vwLY8LHF' \
    --matchID 'hMqPdohp' \
    --namespace $AB_NAMESPACE \
    --userID 'DHKpT1LJ' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName '31vOb6kQ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'A94hIgHc' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE