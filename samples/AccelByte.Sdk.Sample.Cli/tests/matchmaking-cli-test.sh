#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '31' \
    --offset '34' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "cQsNMBOE", "description": "54CO6izB", "find_match_timeout_seconds": 86, "game_mode": "DSBjZAVF", "joinable": false, "max_delay_ms": 98, "region_expansion_range_ms": 82, "region_expansion_rate_ms": 57, "region_latency_initial_range_ms": 69, "region_latency_max_ms": 97, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 23, "min": 24, "name": "kReB5T0s"}, {"max": 92, "min": 73, "name": "tSHx8ecr"}, {"max": 73, "min": 15, "name": "iDnFO3pu"}], [{"max": 41, "min": 45, "name": "fbmdkNeG"}, {"max": 34, "min": 13, "name": "yLwqfA8i"}, {"max": 86, "min": 40, "name": "JBZFaDyW"}], [{"max": 11, "min": 40, "name": "Z3pjztTE"}, {"max": 77, "min": 89, "name": "QuUTkRt0"}, {"max": 77, "min": 25, "name": "Ifyj7MS1"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 97, "role_flexing_second": 11}, "max_number": 63, "min_number": 45, "player_max_number": 75, "player_min_number": 87}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 51, "min": 93, "name": "3JTkaOXt"}, {"max": 16, "min": 83, "name": "rPBZCdw3"}, {"max": 18, "min": 61, "name": "yZXBXGSo"}], [{"max": 41, "min": 16, "name": "Pn3xAZXI"}, {"max": 97, "min": 17, "name": "hRwE5Jyh"}, {"max": 35, "min": 21, "name": "gJlNLYmm"}], [{"max": 2, "min": 82, "name": "EZy3zKv4"}, {"max": 41, "min": 3, "name": "1vX3HHSf"}, {"max": 68, "min": 85, "name": "bF5CDvZ7"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 41, "role_flexing_second": 66}, "duration": 56, "max_number": 2, "min_number": 64, "player_max_number": 40, "player_min_number": 100}, {"combination": {"alliances": [[{"max": 83, "min": 53, "name": "nL5of2IT"}, {"max": 71, "min": 77, "name": "JJ1wLNwx"}, {"max": 75, "min": 37, "name": "gb3zutt5"}], [{"max": 66, "min": 29, "name": "NJqGEHY6"}, {"max": 60, "min": 75, "name": "XkdqHje0"}, {"max": 84, "min": 57, "name": "JsEOf1Bo"}], [{"max": 8, "min": 77, "name": "Usorj9t0"}, {"max": 39, "min": 91, "name": "uqNTzTEO"}, {"max": 51, "min": 88, "name": "Zg2WgJLW"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 82, "role_flexing_second": 57}, "duration": 13, "max_number": 29, "min_number": 40, "player_max_number": 47, "player_min_number": 15}, {"combination": {"alliances": [[{"max": 43, "min": 87, "name": "bvVD2boi"}, {"max": 64, "min": 100, "name": "SnRmAzYs"}, {"max": 99, "min": 82, "name": "Xmfjmgyz"}], [{"max": 22, "min": 83, "name": "qJXcxxlk"}, {"max": 79, "min": 77, "name": "qlWashno"}, {"max": 27, "min": 28, "name": "bF9LjoMc"}], [{"max": 25, "min": 85, "name": "HxyG1IFK"}, {"max": 70, "min": 45, "name": "rltQBMkO"}, {"max": 84, "min": 62, "name": "dMOwWXUU"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 89, "role_flexing_second": 100}, "duration": 75, "max_number": 97, "min_number": 56, "player_max_number": 91, "player_min_number": 83}], "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 8, "flex_flat_step_range": 60, "flex_immunity_count": 40, "flex_range_max": 2, "flex_rate_ms": 71, "flex_step_max": 81, "force_authority_match": true, "initial_step_range": 90, "mmr_max": 80, "mmr_mean": 64, "mmr_min": 24, "mmr_std_dev": 54, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "pOWqFnEL", "criteria": "mGq0tKzj", "duration": 59, "reference": 0.9485975077232003}, {"attribute": "HdkUxzTi", "criteria": "5oYVtWsR", "duration": 34, "reference": 0.07897630521686827}, {"attribute": "rcVzl2ai", "criteria": "7Y43x9Kk", "duration": 72, "reference": 0.4268470957481634}], "match_options": {"options": [{"name": "JeSZcDnP", "type": "iQ6qxo4v"}, {"name": "K28Fnfad", "type": "f875mVvG"}, {"name": "AzTq1WzX", "type": "JBj4dLQc"}]}, "matching_rule": [{"attribute": "5Zw21eQl", "criteria": "y9u569Vd", "reference": 0.3436712695750581}, {"attribute": "x28DdEhI", "criteria": "f5PO39SB", "reference": 0.5969447089667244}, {"attribute": "kMCklEJw", "criteria": "oY3WubA6", "reference": 0.6260658538324515}], "rebalance_enable": true, "sub_game_modes": {"k9AcYtVK": {"alliance": {"combination": {"alliances": [[{"max": 23, "min": 13, "name": "iYuvcxD8"}, {"max": 76, "min": 67, "name": "qFIsJa0A"}, {"max": 59, "min": 67, "name": "qlB4lRdb"}], [{"max": 33, "min": 1, "name": "jsVqn3WP"}, {"max": 36, "min": 68, "name": "TsnB3LL0"}, {"max": 44, "min": 75, "name": "vO4GF94G"}], [{"max": 76, "min": 99, "name": "gAqrlVz5"}, {"max": 68, "min": 23, "name": "clJXJqqn"}, {"max": 40, "min": 88, "name": "qMhQBfcI"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 26, "role_flexing_second": 15}, "max_number": 10, "min_number": 69, "player_max_number": 6, "player_min_number": 55}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 34, "min": 59, "name": "bhV7F4uD"}, {"max": 80, "min": 70, "name": "jPoDrXOI"}, {"max": 95, "min": 57, "name": "SjBf9vTa"}], [{"max": 52, "min": 78, "name": "Ss18aKyK"}, {"max": 32, "min": 31, "name": "fzDP3y7k"}, {"max": 46, "min": 85, "name": "maNxe1X8"}], [{"max": 70, "min": 16, "name": "3AfKlJTl"}, {"max": 11, "min": 6, "name": "AN46hUHS"}, {"max": 53, "min": 0, "name": "TyaQ8Ed0"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 67, "role_flexing_second": 64}, "duration": 85, "max_number": 0, "min_number": 28, "player_max_number": 44, "player_min_number": 85}, {"combination": {"alliances": [[{"max": 45, "min": 4, "name": "9T2XEuAv"}, {"max": 25, "min": 60, "name": "PAzu3eYw"}, {"max": 95, "min": 84, "name": "QhknnOPv"}], [{"max": 89, "min": 85, "name": "RuvCRbJO"}, {"max": 81, "min": 19, "name": "rIv0WK8p"}, {"max": 72, "min": 32, "name": "dDxgPhv0"}], [{"max": 83, "min": 57, "name": "WbS0eRZy"}, {"max": 83, "min": 46, "name": "WrJpvgDn"}, {"max": 30, "min": 95, "name": "GGtZVYdx"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 41, "role_flexing_second": 100}, "duration": 88, "max_number": 3, "min_number": 26, "player_max_number": 23, "player_min_number": 65}, {"combination": {"alliances": [[{"max": 60, "min": 25, "name": "X1XUTyfJ"}, {"max": 52, "min": 41, "name": "BlG8q8xG"}, {"max": 70, "min": 44, "name": "Buvlpv1C"}], [{"max": 28, "min": 84, "name": "LOqmWZbm"}, {"max": 51, "min": 20, "name": "cX6wYq4l"}, {"max": 49, "min": 38, "name": "TJbBbgvL"}], [{"max": 27, "min": 36, "name": "zRs2tMim"}, {"max": 40, "min": 35, "name": "JMvR1wDq"}, {"max": 62, "min": 30, "name": "Hb2e0iFZ"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 14, "role_flexing_second": 34}, "duration": 73, "max_number": 14, "min_number": 92, "player_max_number": 9, "player_min_number": 9}], "name": "BBOXeRt0"}, "OslmKYUR": {"alliance": {"combination": {"alliances": [[{"max": 64, "min": 63, "name": "hsKD0mta"}, {"max": 1, "min": 26, "name": "JQed3wI2"}, {"max": 88, "min": 84, "name": "zvykzZtb"}], [{"max": 83, "min": 17, "name": "Xfuw2mlE"}, {"max": 16, "min": 94, "name": "yOC1MJHi"}, {"max": 76, "min": 34, "name": "901N2Cuj"}], [{"max": 5, "min": 23, "name": "jEQTCq27"}, {"max": 34, "min": 10, "name": "ZgznH8TX"}, {"max": 58, "min": 77, "name": "csUUJzG7"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 41, "role_flexing_second": 67}, "max_number": 18, "min_number": 75, "player_max_number": 60, "player_min_number": 53}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 84, "min": 85, "name": "x4iGDBUv"}, {"max": 42, "min": 35, "name": "x2nbT76H"}, {"max": 3, "min": 100, "name": "slAjnPhX"}], [{"max": 22, "min": 3, "name": "MQk5MTor"}, {"max": 8, "min": 50, "name": "slh9K7dO"}, {"max": 81, "min": 37, "name": "sEbZgj4a"}], [{"max": 78, "min": 27, "name": "tAJeSkff"}, {"max": 89, "min": 32, "name": "sCXu5DQE"}, {"max": 92, "min": 8, "name": "aHzmHuy8"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 7}, "duration": 68, "max_number": 27, "min_number": 9, "player_max_number": 19, "player_min_number": 32}, {"combination": {"alliances": [[{"max": 87, "min": 48, "name": "w2kltyDq"}, {"max": 88, "min": 49, "name": "mgXS9Er1"}, {"max": 83, "min": 15, "name": "vZ6zb8cq"}], [{"max": 22, "min": 44, "name": "v2WndC5c"}, {"max": 15, "min": 2, "name": "3OL7Hei9"}, {"max": 27, "min": 34, "name": "gzhBPro0"}], [{"max": 4, "min": 10, "name": "qmIWHT9Y"}, {"max": 41, "min": 12, "name": "dcfMnoQ0"}, {"max": 31, "min": 31, "name": "JhxIqw18"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 71, "role_flexing_second": 84}, "duration": 23, "max_number": 45, "min_number": 21, "player_max_number": 17, "player_min_number": 51}, {"combination": {"alliances": [[{"max": 60, "min": 17, "name": "VcIBleCP"}, {"max": 75, "min": 39, "name": "Eb56AVFN"}, {"max": 61, "min": 96, "name": "gvZEslR0"}], [{"max": 80, "min": 100, "name": "V9PcUVlB"}, {"max": 30, "min": 12, "name": "wcswviHp"}, {"max": 68, "min": 18, "name": "617UUDI9"}], [{"max": 51, "min": 61, "name": "09NEqXP4"}, {"max": 56, "min": 67, "name": "4rq8706z"}, {"max": 50, "min": 34, "name": "HXQ7NMs7"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 28, "role_flexing_second": 54}, "duration": 37, "max_number": 25, "min_number": 54, "player_max_number": 59, "player_min_number": 60}], "name": "hfkMrQUN"}, "UCJ0JCEG": {"alliance": {"combination": {"alliances": [[{"max": 35, "min": 6, "name": "ciIycbbY"}, {"max": 69, "min": 17, "name": "5lUDHRdC"}, {"max": 21, "min": 31, "name": "mJeZ4Qu7"}], [{"max": 47, "min": 25, "name": "XqHz4d42"}, {"max": 90, "min": 51, "name": "yuf5gsWN"}, {"max": 89, "min": 53, "name": "eWuliJ4V"}], [{"max": 68, "min": 61, "name": "lTxvZnJy"}, {"max": 29, "min": 19, "name": "mnAVpepz"}, {"max": 0, "min": 13, "name": "gq1iOHnv"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 100}, "max_number": 32, "min_number": 100, "player_max_number": 75, "player_min_number": 68}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 87, "min": 76, "name": "Fd3b149e"}, {"max": 30, "min": 88, "name": "Wp42Agjq"}, {"max": 34, "min": 4, "name": "ToorLcqC"}], [{"max": 67, "min": 25, "name": "YQBvuz44"}, {"max": 67, "min": 46, "name": "04fCFjcH"}, {"max": 29, "min": 24, "name": "UmH7SjZP"}], [{"max": 73, "min": 50, "name": "tRK1gScH"}, {"max": 13, "min": 11, "name": "Al00IYU0"}, {"max": 38, "min": 73, "name": "35KEUyV7"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 50, "role_flexing_second": 46}, "duration": 49, "max_number": 71, "min_number": 35, "player_max_number": 100, "player_min_number": 31}, {"combination": {"alliances": [[{"max": 25, "min": 10, "name": "0IjloLzu"}, {"max": 25, "min": 32, "name": "id1DPsFR"}, {"max": 24, "min": 55, "name": "vCA3iUYe"}], [{"max": 1, "min": 98, "name": "alWTNvuo"}, {"max": 80, "min": 60, "name": "upDstB3a"}, {"max": 87, "min": 31, "name": "xrlnN5q5"}], [{"max": 4, "min": 42, "name": "Vvp0QxL9"}, {"max": 9, "min": 3, "name": "DVIDtSqG"}, {"max": 19, "min": 33, "name": "CgHVs0SV"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 48, "role_flexing_second": 76}, "duration": 9, "max_number": 33, "min_number": 82, "player_max_number": 61, "player_min_number": 76}, {"combination": {"alliances": [[{"max": 89, "min": 71, "name": "aPHdfbHx"}, {"max": 51, "min": 82, "name": "gilofLHb"}, {"max": 41, "min": 38, "name": "9lacWvXz"}], [{"max": 6, "min": 94, "name": "OkV9KoXR"}, {"max": 41, "min": 70, "name": "PjIpenRs"}, {"max": 64, "min": 29, "name": "92y48nB6"}], [{"max": 81, "min": 4, "name": "Geeadqde"}, {"max": 99, "min": 29, "name": "EDG9cKsm"}, {"max": 23, "min": 70, "name": "zU5AfoK3"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 95, "role_flexing_second": 17}, "duration": 40, "max_number": 32, "min_number": 78, "player_max_number": 55, "player_min_number": 42}], "name": "RYmysCPF"}}, "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 68, "social_matchmaking": true, "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'W9NzwEfN' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'TjqFQBrJ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "9mOv5Ut9", "players": [{"results": [{"attribute": "9eE6luGc", "value": 0.9215914272241136}, {"attribute": "eNlySxAc", "value": 0.37899840218622305}, {"attribute": "HOB9BP23", "value": 0.09823023262707031}], "user_id": "C75w2i2U"}, {"results": [{"attribute": "uplJZQJA", "value": 0.33066829760378413}, {"attribute": "Xb5WXXhv", "value": 0.811031325333066}, {"attribute": "rphi14xG", "value": 0.9580915760736908}], "user_id": "GVK1uk2u"}, {"results": [{"attribute": "oZLWQEwf", "value": 0.28825534827359445}, {"attribute": "FdjiK3T3", "value": 0.47406036498863235}, {"attribute": "zhYKF2ZJ", "value": 0.997014033047693}], "user_id": "ntPvzB0N"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "rJUORXVq"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "8vAUZnmx", "client_version": "ZHaw43MF", "deployment": "94tEdJbS", "error_code": 69, "error_message": "tOSP6sOH", "game_mode": "cVcxTRGh", "is_mock": "RzYjC9YL", "joinable": true, "match_id": "KiUQH8VI", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 95, "party_attributes": {"6zUgAdJt": {}, "fbMQUZbb": {}, "pP1wkem9": {}}, "party_id": "s9unQRqc", "party_members": [{"extra_attributes": {"BXYJhXsB": {}, "sdDn56GV": {}, "uhEnCjwM": {}}, "user_id": "MEzzTP9p"}, {"extra_attributes": {"nEXMVHhZ": {}, "eUdWuBNV": {}, "LZJubIDy": {}}, "user_id": "EMZXaSb8"}, {"extra_attributes": {"usHVV78o": {}, "z9mM0mN3": {}, "yVxJs5cd": {}}, "user_id": "HbwxPqL0"}], "ticket_created_at": 6, "ticket_id": "X5HuZwSZ"}, {"first_ticket_created_at": 5, "party_attributes": {"mGtbJugy": {}, "yxBfAZET": {}, "zpeJZWDX": {}}, "party_id": "D3xOi8FT", "party_members": [{"extra_attributes": {"p7cGwUSv": {}, "1pEvYgZ8": {}, "8401JhI4": {}}, "user_id": "sapGo34W"}, {"extra_attributes": {"WBymVGQz": {}, "xzjQySy7": {}, "WOiIpABr": {}}, "user_id": "4FCdEQ1Y"}, {"extra_attributes": {"CiCW1vUa": {}, "mYqKEIlw": {}, "DvuP9q0r": {}}, "user_id": "jpznFYNq"}], "ticket_created_at": 44, "ticket_id": "uYW3huM5"}, {"first_ticket_created_at": 93, "party_attributes": {"HqKJihZw": {}, "jJVxdOjk": {}, "FB41BoXI": {}}, "party_id": "Jjxuy8uP", "party_members": [{"extra_attributes": {"gPnxdyZ3": {}, "r0QDutXf": {}, "5bAHTQDv": {}}, "user_id": "nKpbJZvP"}, {"extra_attributes": {"izhttoYx": {}, "riHlSxoz": {}, "elXVV2Go": {}}, "user_id": "HgxoJE1z"}, {"extra_attributes": {"A5RFU14C": {}, "wWmaiMeH": {}, "NXY5V59Q": {}}, "user_id": "E4vmSlKL"}], "ticket_created_at": 4, "ticket_id": "oN54bkBQ"}]}, {"matching_parties": [{"first_ticket_created_at": 81, "party_attributes": {"45LbfAa7": {}, "EHN07xCq": {}, "qNH5V6bn": {}}, "party_id": "kGIy8xWL", "party_members": [{"extra_attributes": {"V95mdehB": {}, "uvNPfoa7": {}, "gXzNWtaR": {}}, "user_id": "01nY3sCn"}, {"extra_attributes": {"3HkwnSzD": {}, "GpbIk2sT": {}, "RD2oCaHR": {}}, "user_id": "L2TgXLna"}, {"extra_attributes": {"2xSI4MW5": {}, "Tgdjpc9K": {}, "0odhqo3Q": {}}, "user_id": "ESxmQeJm"}], "ticket_created_at": 21, "ticket_id": "xPpQAEML"}, {"first_ticket_created_at": 63, "party_attributes": {"00tsZmvq": {}, "MjmERa3F": {}, "EguUuK1K": {}}, "party_id": "mV9vgdEk", "party_members": [{"extra_attributes": {"3USYOKjD": {}, "BvfGyCEs": {}, "oqREe609": {}}, "user_id": "8p4lRZ5Z"}, {"extra_attributes": {"S1kOAwp8": {}, "Lk0gXwr1": {}, "oJjwjRVc": {}}, "user_id": "84lg21AC"}, {"extra_attributes": {"RGMrky28": {}, "LBFNK0a3": {}, "7F1Ua6jQ": {}}, "user_id": "YdJIjXDw"}], "ticket_created_at": 71, "ticket_id": "aXZHwAe8"}, {"first_ticket_created_at": 55, "party_attributes": {"lUIHfhv8": {}, "iXrU2KO3": {}, "C6bnitHM": {}}, "party_id": "hF3PK0Cf", "party_members": [{"extra_attributes": {"gWT6Mpxz": {}, "vOx1xjfv": {}, "sbFhsB2p": {}}, "user_id": "BKfeL6KT"}, {"extra_attributes": {"9xMdMxtf": {}, "U5upIPoY": {}, "aeX1yCSH": {}}, "user_id": "Q7Ggl6EX"}, {"extra_attributes": {"DZ8xnVzF": {}, "kAlaRe0n": {}, "eZrB34cW": {}}, "user_id": "TcIEYWvq"}], "ticket_created_at": 3, "ticket_id": "5NfXUern"}]}, {"matching_parties": [{"first_ticket_created_at": 98, "party_attributes": {"n9plG5G5": {}, "efc4G9EO": {}, "0AcyzXiA": {}}, "party_id": "T7m0bZqM", "party_members": [{"extra_attributes": {"n83iLzR2": {}, "oKELzdva": {}, "CriBSpSQ": {}}, "user_id": "zSxdSJro"}, {"extra_attributes": {"ZrAHUsAM": {}, "r8D7M0tp": {}, "03Jbn1B7": {}}, "user_id": "VtEYVEBA"}, {"extra_attributes": {"UGxJWGx0": {}, "LCA53tp7": {}, "QeRpzuvr": {}}, "user_id": "ABvOO5BW"}], "ticket_created_at": 45, "ticket_id": "xmuU4tw4"}, {"first_ticket_created_at": 40, "party_attributes": {"tgwaQj7r": {}, "1EB2BWBK": {}, "ypjyaIth": {}}, "party_id": "QxsdA44S", "party_members": [{"extra_attributes": {"kIBW5hZs": {}, "h5yg1kPO": {}, "5DP4aFyF": {}}, "user_id": "Uu22MSgD"}, {"extra_attributes": {"2fBXGu1a": {}, "x2eusj9E": {}, "0eE8RXcx": {}}, "user_id": "dxPBhQmv"}, {"extra_attributes": {"tKnjJVPg": {}, "MIj4orSH": {}, "NwvctpA6": {}}, "user_id": "6ClvICoy"}], "ticket_created_at": 21, "ticket_id": "e7Knj2T7"}, {"first_ticket_created_at": 93, "party_attributes": {"SN839u4A": {}, "JMbNZKPw": {}, "VCs57OKY": {}}, "party_id": "SuXkvfqp", "party_members": [{"extra_attributes": {"zQzeMFsw": {}, "UvACVjtw": {}, "jQOo5u2S": {}}, "user_id": "1nwc3Mou"}, {"extra_attributes": {"QmabgyS5": {}, "hfK9GpfI": {}, "lcsZFqvO": {}}, "user_id": "hk96cAjD"}, {"extra_attributes": {"nBXHvmJU": {}, "bXbfbv5U": {}, "9sLqEtku": {}}, "user_id": "dhzsvXQe"}], "ticket_created_at": 7, "ticket_id": "9vFAO8Ye"}]}], "namespace": "nGDsuqwd", "party_attributes": {"1dtbK7Gb": {}, "NYy1X0xJ": {}, "j3jQGYsy": {}}, "party_id": "6mvl3j8f", "queued_at": 4, "region": "4VagQTnh", "server_name": "H1OivOKt", "status": "MI1GYeJd", "ticket_id": "sDV3LD9h", "ticket_ids": ["PLNY98LM", "L7HhMY7l", "M3eLjOAF"], "updated_at": "1985-05-22T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "RO0SFZIr"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID '6DjjZ8oU' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 51, "userID": "GgJs7Koe", "weight": 0.7105816693373919}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'IF4eIFbu' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'Q9TSvre7' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'Fp0n4AUb' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "BbhWMmHk", "description": "RZk6Nq9N", "findMatchTimeoutSeconds": 53, "joinable": false, "max_delay_ms": 37, "region_expansion_range_ms": 68, "region_expansion_rate_ms": 21, "region_latency_initial_range_ms": 32, "region_latency_max_ms": 72, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 77, "min": 93, "name": "mouPIiOh"}, {"max": 28, "min": 8, "name": "dWSsaydn"}, {"max": 12, "min": 61, "name": "hGfOH21C"}], [{"max": 90, "min": 2, "name": "QE4is0Af"}, {"max": 41, "min": 14, "name": "Es8f01t3"}, {"max": 33, "min": 98, "name": "ujWehMrO"}], [{"max": 22, "min": 88, "name": "SCgGdpe9"}, {"max": 33, "min": 25, "name": "KEXyWvI3"}, {"max": 45, "min": 11, "name": "LqeGvdBx"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 70, "role_flexing_second": 89}, "maxNumber": 87, "minNumber": 92, "playerMaxNumber": 60, "playerMinNumber": 35}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 3, "min": 77, "name": "xXgGLW5i"}, {"max": 45, "min": 41, "name": "Rv1u5Y8U"}, {"max": 94, "min": 65, "name": "JVevpU9q"}], [{"max": 33, "min": 96, "name": "0woU7zL5"}, {"max": 9, "min": 8, "name": "C2VCyxye"}, {"max": 39, "min": 18, "name": "i9JhCHza"}], [{"max": 88, "min": 24, "name": "YnVzrOdA"}, {"max": 4, "min": 37, "name": "XovMF8s5"}, {"max": 13, "min": 27, "name": "Mh60kUh8"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 80, "role_flexing_second": 96}, "duration": 82, "max_number": 60, "min_number": 18, "player_max_number": 40, "player_min_number": 28}, {"combination": {"alliances": [[{"max": 44, "min": 38, "name": "nHIBQp4c"}, {"max": 48, "min": 5, "name": "3AUD1k2A"}, {"max": 52, "min": 34, "name": "ao8OVHnN"}], [{"max": 38, "min": 75, "name": "PqbzfX6r"}, {"max": 80, "min": 50, "name": "OYLIAUBQ"}, {"max": 74, "min": 70, "name": "0kR4KMsX"}], [{"max": 75, "min": 94, "name": "LdSiQhsq"}, {"max": 73, "min": 99, "name": "EaS8Vaeg"}, {"max": 87, "min": 82, "name": "7BD3JMfv"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 5, "role_flexing_second": 4}, "duration": 97, "max_number": 92, "min_number": 92, "player_max_number": 36, "player_min_number": 59}, {"combination": {"alliances": [[{"max": 49, "min": 65, "name": "9nE9wQgl"}, {"max": 45, "min": 83, "name": "iT4yOHT1"}, {"max": 37, "min": 86, "name": "oqs7yEdv"}], [{"max": 83, "min": 79, "name": "AVBpE7fz"}, {"max": 18, "min": 53, "name": "153O8G1I"}, {"max": 11, "min": 58, "name": "7fLPpLPx"}], [{"max": 55, "min": 41, "name": "5u1Pt4RM"}, {"max": 32, "min": 22, "name": "JJLGienc"}, {"max": 30, "min": 55, "name": "DUliL5S9"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 83, "role_flexing_second": 24}, "duration": 52, "max_number": 99, "min_number": 76, "player_max_number": 42, "player_min_number": 86}], "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 39, "flex_flat_step_range": 62, "flex_immunity_count": 10, "flex_range_max": 57, "flex_rate_ms": 23, "flex_step_max": 25, "force_authority_match": false, "initial_step_range": 23, "mmr_max": 92, "mmr_mean": 83, "mmr_min": 67, "mmr_std_dev": 72, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "pQiwWoVl", "criteria": "WMmnkW5f", "duration": 22, "reference": 0.7473047089787298}, {"attribute": "4LSuZMj0", "criteria": "RhrCdNIe", "duration": 42, "reference": 0.8302541687599179}, {"attribute": "HxPhcUoU", "criteria": "C4q5DHEl", "duration": 57, "reference": 0.08324036326836048}], "match_options": {"options": [{"name": "OY9Y5a2R", "type": "edXfpveF"}, {"name": "fBC8f7AM", "type": "v8TkEWRi"}, {"name": "KrtJ4wYX", "type": "wHUmDltw"}]}, "matchingRules": [{"attribute": "OhhQFr4R", "criteria": "4WgjP5E9", "reference": 0.29401942571898787}, {"attribute": "iuL6re3a", "criteria": "gCgGYSCU", "reference": 0.40186379263589367}, {"attribute": "de1kqLwR", "criteria": "QG0SVKm9", "reference": 0.8607339483834412}], "sub_game_modes": {}, "use_newest_ticket_for_flexing": true}, "sessionQueueTimeoutSeconds": 8, "socialMatchmaking": false, "ticket_observability_enable": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'mCbys8ZM' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName '4n4xe5P8' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'nEwEwVrY' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 20}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'wm53rcOE' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'g605H4fo' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "7X4Ot4M5", "count": 24, "mmrMax": 0.5037925121221656, "mmrMean": 0.6164472852732797, "mmrMin": 0.22566387339276406, "mmrStdDev": 0.055502323915508134}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'P4ElnigM' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 51, "party_attributes": {"QqAJlzXq": {}, "sggRZJRh": {}, "VH90Onh5": {}}, "party_id": "ud3U2vep", "party_members": [{"extra_attributes": {"B3nbnckH": {}, "iZzhQQtR": {}, "UBPTQdbB": {}}, "user_id": "93ZpjNQo"}, {"extra_attributes": {"VO1k3xVw": {}, "j5WcDlXU": {}, "IEPt6OJA": {}}, "user_id": "CLme4KFW"}, {"extra_attributes": {"oTJ0gQiB": {}, "JmeG7vWn": {}, "UYk83lp9": {}}, "user_id": "6oHJ7y43"}], "ticket_created_at": 82, "ticket_id": "IMq7QaNl"}, {"first_ticket_created_at": 4, "party_attributes": {"yYWLnCsV": {}, "wbOlfNUT": {}, "jnBx34g0": {}}, "party_id": "8UZKZiJ7", "party_members": [{"extra_attributes": {"0jsXJTQA": {}, "xN2zotxW": {}, "E2G3jrwz": {}}, "user_id": "5zX246Wr"}, {"extra_attributes": {"BN1wQ59c": {}, "WVt3Bikd": {}, "HEcGIxGX": {}}, "user_id": "RqGaYOQK"}, {"extra_attributes": {"PYrk7ATR": {}, "iyc4bQby": {}, "K6FDYnbm": {}}, "user_id": "1ZiXzOU6"}], "ticket_created_at": 34, "ticket_id": "uCasJalu"}, {"first_ticket_created_at": 92, "party_attributes": {"iRlN0NTe": {}, "E5bQZ5kf": {}, "0AieWmj7": {}}, "party_id": "ffzSm4VD", "party_members": [{"extra_attributes": {"xI9IfAu6": {}, "rsicJCnd": {}, "OOxu7Okv": {}}, "user_id": "43mkeiRB"}, {"extra_attributes": {"Mac9HmPR": {}, "HHZA8Qo8": {}, "PmWfcVp2": {}}, "user_id": "uNPSZn7t"}, {"extra_attributes": {"o4UkykXp": {}, "dBzn4zuy": {}, "A7Mx4TGL": {}}, "user_id": "4O2mQ4Q8"}], "ticket_created_at": 99, "ticket_id": "8YkWx16D"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName '157yr4ro' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 23}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'xNxanop5' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'pVMFIbjo' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'pcbY9901' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["FLQZJ5vJ", "b4XesSSJ", "ZSFPvHaC"], "party_id": "uqSLhZSE", "user_id": "yysTR2mz"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'PfPWCREg' \
    --matchID 'TbbXqZQF' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'igqHsrHP' \
    --matchID '1hDHSsVx' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName '0xRjgGJV' \
    --matchID 'crKcTu7n' \
    --namespace $AB_NAMESPACE \
    --userID 'ihJHH9Rt' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'eTqZfDpN' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName '9pvLhOge' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE