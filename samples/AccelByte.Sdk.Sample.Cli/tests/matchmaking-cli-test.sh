#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '4' \
    --offset '95' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCannotMatch", "deployment": "IfkaWLeb", "description": "zHJc6V0Z", "find_match_timeout_seconds": 9, "game_mode": "8SV7uBds", "joinable": false, "max_delay_ms": 81, "region_expansion_range_ms": 51, "region_expansion_rate_ms": 49, "region_latency_initial_range_ms": 40, "region_latency_max_ms": 58, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 23, "min": 4, "name": "sT6cdz60"}, {"max": 45, "min": 91, "name": "LZmHEhSG"}, {"max": 93, "min": 74, "name": "3c65EO7B"}], [{"max": 89, "min": 6, "name": "M5NCLS5i"}, {"max": 6, "min": 15, "name": "1sNVYwSz"}, {"max": 18, "min": 87, "name": "meo7zIRl"}], [{"max": 93, "min": 42, "name": "dUQxIkcW"}, {"max": 56, "min": 98, "name": "JNB4w2kU"}, {"max": 15, "min": 73, "name": "Na1fpGFd"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 73, "role_flexing_second": 72}, "max_number": 66, "min_number": 57, "player_max_number": 32, "player_min_number": 75}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 29, "min": 77, "name": "0DkznFil"}, {"max": 67, "min": 11, "name": "pee2IHUj"}, {"max": 56, "min": 17, "name": "WyzCQYmK"}], [{"max": 55, "min": 18, "name": "byH84hJO"}, {"max": 28, "min": 12, "name": "sLuKTV48"}, {"max": 93, "min": 46, "name": "LqtMfqpY"}], [{"max": 82, "min": 15, "name": "sbsa63ge"}, {"max": 10, "min": 8, "name": "hNdmqd3Z"}, {"max": 32, "min": 6, "name": "L9AijoyZ"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 57, "role_flexing_second": 77}, "duration": 32, "max_number": 58, "min_number": 48, "player_max_number": 99, "player_min_number": 35}, {"combination": {"alliances": [[{"max": 97, "min": 19, "name": "uIoaWf21"}, {"max": 84, "min": 44, "name": "A9c5JHc7"}, {"max": 50, "min": 54, "name": "HguW16II"}], [{"max": 58, "min": 13, "name": "kabl5npQ"}, {"max": 50, "min": 36, "name": "lFmIbV4n"}, {"max": 71, "min": 13, "name": "LKbqVsp6"}], [{"max": 74, "min": 80, "name": "uC8lYk9O"}, {"max": 98, "min": 85, "name": "IXMqDH73"}, {"max": 58, "min": 64, "name": "LC9WTXqf"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 100, "role_flexing_second": 66}, "duration": 67, "max_number": 67, "min_number": 97, "player_max_number": 83, "player_min_number": 83}, {"combination": {"alliances": [[{"max": 89, "min": 92, "name": "QDuExj5R"}, {"max": 73, "min": 89, "name": "wHLF0JEp"}, {"max": 93, "min": 67, "name": "O3RyGgzg"}], [{"max": 27, "min": 94, "name": "hC1MyKh9"}, {"max": 36, "min": 32, "name": "y0IyeyQX"}, {"max": 49, "min": 97, "name": "lky0YplW"}], [{"max": 11, "min": 14, "name": "t6Cobu5k"}, {"max": 89, "min": 29, "name": "X600y078"}, {"max": 19, "min": 29, "name": "G20Jpdn7"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 33, "role_flexing_second": 56}, "duration": 12, "max_number": 100, "min_number": 98, "player_max_number": 1, "player_min_number": 35}], "batch_size": 0, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 58, "flex_flat_step_range": 33, "flex_immunity_count": 28, "flex_range_max": 43, "flex_rate_ms": 53, "flex_step_max": 10, "force_authority_match": false, "initial_step_range": 88, "mmr_max": 55, "mmr_mean": 41, "mmr_min": 2, "mmr_std_dev": 82, "override_mmr_data": false, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexing_rule": [{"attribute": "PLNic2ic", "criteria": "37MlU3Uq", "duration": 67, "reference": 0.8189658445879311}, {"attribute": "r4nxc6Zl", "criteria": "2ObJaHee", "duration": 78, "reference": 0.6326543460945617}, {"attribute": "vbD72aAw", "criteria": "dx8r6gXR", "duration": 87, "reference": 0.024208713522046232}], "match_options": {"options": [{"name": "GeMBIQfN", "type": "zYpCYpAL"}, {"name": "3MtIvHJx", "type": "Mjy5Sd16"}, {"name": "R4rY4j7R", "type": "U4atkUIO"}]}, "matching_rule": [{"attribute": "TlzelxhF", "criteria": "y9JoxiVw", "reference": 0.0303137066345609}, {"attribute": "XCoVHUnD", "criteria": "i4500L7n", "reference": 0.7114946323615017}, {"attribute": "3j2QKN5O", "criteria": "2lFJig4g", "reference": 0.07392165550678365}], "rebalance_enable": false, "sort_ticket": {"search_result": "BABTAJYn", "ticket_queue": "LLR7wr9R"}, "sort_tickets": [{"search_result": "o40gjFAa", "threshold": 100, "ticket_queue": "MbB4LjY7"}, {"search_result": "GQmNfBYL", "threshold": 82, "ticket_queue": "vzLPS32u"}, {"search_result": "vDNi4BLQ", "threshold": 18, "ticket_queue": "cpRly41d"}], "sub_game_modes": {"4Aip7geG": {"alliance": {"combination": {"alliances": [[{"max": 64, "min": 40, "name": "RCzanDhs"}, {"max": 61, "min": 94, "name": "dUBUjPH3"}, {"max": 24, "min": 54, "name": "XJZCSMhq"}], [{"max": 35, "min": 93, "name": "0tcAsZBo"}, {"max": 96, "min": 87, "name": "ZpTon2rv"}, {"max": 17, "min": 13, "name": "A75kTA3T"}], [{"max": 58, "min": 13, "name": "VtdHBpxi"}, {"max": 5, "min": 57, "name": "BcR5rSlU"}, {"max": 96, "min": 99, "name": "EDt7vl71"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 58, "role_flexing_second": 5}, "max_number": 5, "min_number": 2, "player_max_number": 41, "player_min_number": 91}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 89, "min": 81, "name": "4ZY2Nlh6"}, {"max": 29, "min": 80, "name": "ZavUNezA"}, {"max": 51, "min": 31, "name": "Kt2T3zQz"}], [{"max": 88, "min": 90, "name": "T7adWZsB"}, {"max": 94, "min": 7, "name": "lF6JEBw9"}, {"max": 89, "min": 36, "name": "uxVEp23O"}], [{"max": 2, "min": 54, "name": "KBGTjncR"}, {"max": 66, "min": 32, "name": "m6s17N1G"}, {"max": 16, "min": 77, "name": "5f71nrMk"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 57, "role_flexing_second": 98}, "duration": 65, "max_number": 40, "min_number": 32, "player_max_number": 50, "player_min_number": 64}, {"combination": {"alliances": [[{"max": 77, "min": 61, "name": "VWj3DELg"}, {"max": 50, "min": 10, "name": "7pgBkXIa"}, {"max": 7, "min": 89, "name": "E5TsAXv0"}], [{"max": 65, "min": 38, "name": "6mSsy979"}, {"max": 55, "min": 52, "name": "FOg2uTQf"}, {"max": 49, "min": 88, "name": "mnZXgvJb"}], [{"max": 59, "min": 12, "name": "WaV5dszL"}, {"max": 81, "min": 25, "name": "mBEM3MQc"}, {"max": 12, "min": 52, "name": "6FGRzp7A"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 23, "role_flexing_second": 58}, "duration": 30, "max_number": 43, "min_number": 84, "player_max_number": 35, "player_min_number": 11}, {"combination": {"alliances": [[{"max": 78, "min": 86, "name": "7nOVgKGI"}, {"max": 71, "min": 97, "name": "b7PSkych"}, {"max": 21, "min": 5, "name": "QnSYqcRr"}], [{"max": 5, "min": 54, "name": "43OMmQvA"}, {"max": 1, "min": 66, "name": "nVpwUbMS"}, {"max": 50, "min": 6, "name": "cqOQVsAa"}], [{"max": 63, "min": 93, "name": "mJpL5Bys"}, {"max": 91, "min": 7, "name": "ntpkh66A"}, {"max": 56, "min": 75, "name": "LOTKCv7H"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 5, "role_flexing_second": 43}, "duration": 2, "max_number": 8, "min_number": 43, "player_max_number": 21, "player_min_number": 2}], "name": "yhL4m9Vn"}, "5Gs60Y7P": {"alliance": {"combination": {"alliances": [[{"max": 82, "min": 89, "name": "TFLUUxbY"}, {"max": 91, "min": 43, "name": "D44g4POy"}, {"max": 64, "min": 56, "name": "TCdhovm2"}], [{"max": 68, "min": 25, "name": "iQuoqfnE"}, {"max": 1, "min": 62, "name": "CL96yfDx"}, {"max": 64, "min": 98, "name": "Yq2Fs0Wn"}], [{"max": 49, "min": 41, "name": "laKRg53M"}, {"max": 11, "min": 31, "name": "yx2JdCv0"}, {"max": 96, "min": 30, "name": "fUemQl9f"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 56, "role_flexing_second": 48}, "max_number": 18, "min_number": 88, "player_max_number": 45, "player_min_number": 13}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 80, "min": 45, "name": "YpTeitKX"}, {"max": 21, "min": 81, "name": "ouqnRW0k"}, {"max": 98, "min": 6, "name": "Lc7QOyo8"}], [{"max": 62, "min": 73, "name": "8LHKpPqR"}, {"max": 99, "min": 92, "name": "ZaC2bUtk"}, {"max": 96, "min": 66, "name": "rTc7NvAm"}], [{"max": 12, "min": 90, "name": "k0Bz99C8"}, {"max": 92, "min": 51, "name": "4sg4d4IP"}, {"max": 53, "min": 60, "name": "zhF8smM0"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 44, "role_flexing_second": 81}, "duration": 11, "max_number": 96, "min_number": 100, "player_max_number": 58, "player_min_number": 37}, {"combination": {"alliances": [[{"max": 92, "min": 26, "name": "xw8s7PnK"}, {"max": 50, "min": 16, "name": "c1vWEWRH"}, {"max": 3, "min": 31, "name": "LQOqgZeZ"}], [{"max": 93, "min": 43, "name": "vE1NyJsv"}, {"max": 91, "min": 77, "name": "YPjY686F"}, {"max": 74, "min": 32, "name": "EF0sFAkz"}], [{"max": 7, "min": 80, "name": "YV9oy02x"}, {"max": 82, "min": 73, "name": "RUDkBZE8"}, {"max": 44, "min": 10, "name": "tQfygjDe"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 22, "role_flexing_second": 78}, "duration": 73, "max_number": 91, "min_number": 0, "player_max_number": 98, "player_min_number": 27}, {"combination": {"alliances": [[{"max": 71, "min": 47, "name": "RD7Y4rg9"}, {"max": 45, "min": 2, "name": "L09SB6Kf"}, {"max": 78, "min": 27, "name": "qnN4UikR"}], [{"max": 1, "min": 81, "name": "WwVwP9nC"}, {"max": 88, "min": 80, "name": "TS8VXmco"}, {"max": 99, "min": 78, "name": "gsp9i38g"}], [{"max": 24, "min": 37, "name": "sOV18gUR"}, {"max": 72, "min": 24, "name": "mokNTTN4"}, {"max": 89, "min": 27, "name": "bJvvPV0q"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 14, "role_flexing_second": 26}, "duration": 56, "max_number": 18, "min_number": 23, "player_max_number": 90, "player_min_number": 94}], "name": "Kd7qkArx"}, "fFLnokJO": {"alliance": {"combination": {"alliances": [[{"max": 20, "min": 11, "name": "0FMSvZZg"}, {"max": 49, "min": 81, "name": "Xh0ZDZiO"}, {"max": 56, "min": 88, "name": "TcGqiECg"}], [{"max": 38, "min": 73, "name": "7AtL9nQk"}, {"max": 34, "min": 64, "name": "mzo3YKqR"}, {"max": 51, "min": 60, "name": "qXv08ej4"}], [{"max": 40, "min": 68, "name": "FXHmDjkc"}, {"max": 82, "min": 23, "name": "NajxIVAb"}, {"max": 8, "min": 25, "name": "pJhIc15P"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 26, "role_flexing_second": 9}, "max_number": 61, "min_number": 55, "player_max_number": 57, "player_min_number": 12}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 29, "min": 5, "name": "mygr0mG4"}, {"max": 9, "min": 45, "name": "QQWitfez"}, {"max": 2, "min": 45, "name": "WjqN3uOa"}], [{"max": 67, "min": 19, "name": "XyOfBInA"}, {"max": 36, "min": 83, "name": "tAWkPqIf"}, {"max": 61, "min": 32, "name": "koBbAPKy"}], [{"max": 9, "min": 33, "name": "FiuUVd3V"}, {"max": 82, "min": 83, "name": "BY0zHV7f"}, {"max": 11, "min": 14, "name": "sRkHS5ij"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 65, "role_flexing_second": 27}, "duration": 77, "max_number": 54, "min_number": 9, "player_max_number": 96, "player_min_number": 87}, {"combination": {"alliances": [[{"max": 66, "min": 65, "name": "Q9R6At2f"}, {"max": 93, "min": 96, "name": "ghiyzLM5"}, {"max": 15, "min": 61, "name": "KZLS6PB9"}], [{"max": 87, "min": 5, "name": "3QNLYxfd"}, {"max": 19, "min": 49, "name": "e6UAXcpa"}, {"max": 40, "min": 45, "name": "ilFcVK5j"}], [{"max": 79, "min": 53, "name": "RJV6Vsdl"}, {"max": 8, "min": 58, "name": "zFfPzhaE"}, {"max": 75, "min": 24, "name": "IKwnE82P"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 29, "role_flexing_second": 73}, "duration": 98, "max_number": 67, "min_number": 97, "player_max_number": 73, "player_min_number": 64}, {"combination": {"alliances": [[{"max": 72, "min": 72, "name": "xIhBM0Az"}, {"max": 91, "min": 35, "name": "uoWUOFQ3"}, {"max": 42, "min": 83, "name": "CjgYKTJ5"}], [{"max": 50, "min": 15, "name": "8zu6ZjtV"}, {"max": 17, "min": 27, "name": "6cOLWgv1"}, {"max": 46, "min": 66, "name": "W2U08MWs"}], [{"max": 84, "min": 95, "name": "AzklkXRc"}, {"max": 98, "min": 63, "name": "GjgVkvZD"}, {"max": 14, "min": 87, "name": "4MXSv7mB"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 7, "role_flexing_second": 81}, "duration": 31, "max_number": 10, "min_number": 54, "player_max_number": 46, "player_min_number": 33}], "name": "gQXGpJta"}}, "ticket_flexing_selection": "KdLdIi0j", "ticket_flexing_selections": [{"selection": "lpl53HGN", "threshold": 90}, {"selection": "eoQ3a9lr", "threshold": 11}, {"selection": "5sCctswK", "threshold": 5}], "use_newest_ticket_for_flexing": false}, "session_queue_timeout_seconds": 81, "social_matchmaking": false, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'BotIBNXU' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'wDk0m7y6' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "Jz9wtapj", "players": [{"results": [{"attribute": "eTbH4nAO", "value": 0.5600108293521265}, {"attribute": "RWbMNKYB", "value": 0.4072437035742186}, {"attribute": "5UFLKjTs", "value": 0.9578970233373713}], "user_id": "E2UPvOe0"}, {"results": [{"attribute": "dOF91Tfu", "value": 0.1390573057763429}, {"attribute": "gROeHPmS", "value": 0.17618975447142737}, {"attribute": "Oxd7LDCx", "value": 0.1761411000673877}], "user_id": "W1CR33eU"}, {"results": [{"attribute": "XfVhjePY", "value": 0.5242367101318595}, {"attribute": "0HKNrwSh", "value": 0.7126398236198915}, {"attribute": "bjFKZpvB", "value": 0.19131447915355193}], "user_id": "1FvcwAZK"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "dpIkMx6P"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "THfwAEn2", "client_version": "6dDvyOKn", "deployment": "sFiAEWEg", "error_code": 56, "error_message": "h18scCz4", "game_mode": "eV44PQuj", "is_mock": "9M35YcMX", "joinable": false, "match_id": "p39bWzpk", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 88, "party_attributes": {"5ZdNSTag": {}, "DdPbpDFp": {}, "6npSQNV6": {}}, "party_id": "bgnejD86", "party_members": [{"extra_attributes": {"TnfFK4ut": {}, "U0dgYAxf": {}, "gTDyX87l": {}}, "user_id": "kD9EuweY"}, {"extra_attributes": {"z9W4EXXC": {}, "LVUDjYvi": {}, "OWT5XqXx": {}}, "user_id": "UmDkpDct"}, {"extra_attributes": {"mduOUqwk": {}, "H7XXg4Bu": {}, "flIAISew": {}}, "user_id": "FsffIF1S"}], "ticket_created_at": 16, "ticket_id": "DetYMffI"}, {"first_ticket_created_at": 78, "party_attributes": {"HrxAGmh2": {}, "7CPQD2sd": {}, "5Pkn3clq": {}}, "party_id": "gUHbwBfj", "party_members": [{"extra_attributes": {"E7tjm3OI": {}, "Elhvhxef": {}, "1UEgcT9M": {}}, "user_id": "qMY80VAz"}, {"extra_attributes": {"vJfdCRnv": {}, "1Yu3JlPq": {}, "zoBFLTqI": {}}, "user_id": "PbGlKFk8"}, {"extra_attributes": {"8MwE2iLp": {}, "a0ZF6U3i": {}, "EOKIgvQq": {}}, "user_id": "NvJeuBwg"}], "ticket_created_at": 43, "ticket_id": "9ku73LZV"}, {"first_ticket_created_at": 11, "party_attributes": {"3mAtpWEM": {}, "Dc1KanqJ": {}, "viooXywx": {}}, "party_id": "LZj8MBr3", "party_members": [{"extra_attributes": {"pF5jK7mt": {}, "aP8JtegW": {}, "k1uffRh4": {}}, "user_id": "53KEI5sR"}, {"extra_attributes": {"rex0JiS7": {}, "IWg2svEy": {}, "J5AvmXKy": {}}, "user_id": "AYvw9dBe"}, {"extra_attributes": {"3mMEkob1": {}, "QaShNWM1": {}, "EF2d6Cah": {}}, "user_id": "lFE09Rrv"}], "ticket_created_at": 84, "ticket_id": "JRZoqy8z"}]}, {"matching_parties": [{"first_ticket_created_at": 99, "party_attributes": {"9FXult2v": {}, "0eSA3nAN": {}, "BiCxkSQ6": {}}, "party_id": "0YiluY7K", "party_members": [{"extra_attributes": {"VgqJxMio": {}, "uQ4LssVL": {}, "9rpCM3IB": {}}, "user_id": "AY0P51zn"}, {"extra_attributes": {"NL0Zl9TQ": {}, "RCvHeM19": {}, "OL63KP6e": {}}, "user_id": "rQZfgVbT"}, {"extra_attributes": {"UmzXikK5": {}, "2qr2oCsQ": {}, "5e9cwado": {}}, "user_id": "TU3enu6G"}], "ticket_created_at": 84, "ticket_id": "07aaAlCV"}, {"first_ticket_created_at": 75, "party_attributes": {"kEsbSavd": {}, "BE6tapLo": {}, "lj6ftPGL": {}}, "party_id": "j4PTMwn8", "party_members": [{"extra_attributes": {"EnqrXlFV": {}, "1UwDXQuq": {}, "8Bpi19MB": {}}, "user_id": "oJ3kg0t0"}, {"extra_attributes": {"NwMMiB4o": {}, "AFdGAzIW": {}, "uWBGTZ88": {}}, "user_id": "7i5Frzvh"}, {"extra_attributes": {"NFDDT2oS": {}, "sriJ8npp": {}, "bV5tClem": {}}, "user_id": "U4OddBEo"}], "ticket_created_at": 10, "ticket_id": "pAXANtQv"}, {"first_ticket_created_at": 22, "party_attributes": {"WchINGq0": {}, "Hmb4kL4y": {}, "oML2O4t4": {}}, "party_id": "nfO0sH5m", "party_members": [{"extra_attributes": {"DMoHugw6": {}, "SaXrJNjf": {}, "2MKGfVPt": {}}, "user_id": "vuqyMgFX"}, {"extra_attributes": {"yfptqe0b": {}, "khq2Xwln": {}, "HNN2wj7H": {}}, "user_id": "vIlDmbyE"}, {"extra_attributes": {"tImeqLGn": {}, "j3FxbT3m": {}, "wZ7Vgmbb": {}}, "user_id": "oeQI18dd"}], "ticket_created_at": 13, "ticket_id": "y0rHATBV"}]}, {"matching_parties": [{"first_ticket_created_at": 44, "party_attributes": {"7bOfDZWL": {}, "OoTD0uvM": {}, "qCM6ZihY": {}}, "party_id": "RhyG4IU4", "party_members": [{"extra_attributes": {"pS4R8FW7": {}, "vQrCWSh3": {}, "pmdye0vF": {}}, "user_id": "A9Mhpbv3"}, {"extra_attributes": {"2Fu8vlcX": {}, "HQx4vamT": {}, "JMrVhqHO": {}}, "user_id": "Y9SrC7Vt"}, {"extra_attributes": {"voD1gddq": {}, "4WkRMlAT": {}, "z9uY7rni": {}}, "user_id": "1PPIpsOW"}], "ticket_created_at": 64, "ticket_id": "uxF36c0u"}, {"first_ticket_created_at": 57, "party_attributes": {"hJAGN042": {}, "D86cBD2Q": {}, "oXdbRFVf": {}}, "party_id": "5u2n3zT2", "party_members": [{"extra_attributes": {"hRuKD7UX": {}, "uaj5Z3mZ": {}, "tsHgKmDS": {}}, "user_id": "kHCyfSgr"}, {"extra_attributes": {"qLRn6L7a": {}, "mUGtxoqa": {}, "qnbfagFd": {}}, "user_id": "M2Xq4Xeb"}, {"extra_attributes": {"oCOEj0jW": {}, "RGnl7Zmg": {}, "VDCLjUkS": {}}, "user_id": "M3JoJkvG"}], "ticket_created_at": 25, "ticket_id": "zWmnsxkV"}, {"first_ticket_created_at": 68, "party_attributes": {"aDQaOKBZ": {}, "s5rBqwXY": {}, "n5XlQ2g3": {}}, "party_id": "cPPpavfH", "party_members": [{"extra_attributes": {"0xN9ZMV1": {}, "mwOopYII": {}, "sUkoUB7y": {}}, "user_id": "jkz7B4vq"}, {"extra_attributes": {"dwREJqTG": {}, "3zdUnCpk": {}, "7huOyaVs": {}}, "user_id": "Xm2gN6Vn"}, {"extra_attributes": {"sPtFnGsN": {}, "g5TJX9Ti": {}, "iTbqVIWT": {}}, "user_id": "WeInpqcv"}], "ticket_created_at": 41, "ticket_id": "vAOwUxQG"}]}], "namespace": "hnI8eZfB", "party_attributes": {"8TynFWpx": {}, "pucOQQC6": {}, "j5SKDc9D": {}}, "party_id": "LZkWRQOy", "queued_at": 36, "region": "bN4k3KCj", "server_name": "juv300OQ", "status": "4WpZErNH", "ticket_id": "RqH6cV2q", "ticket_ids": ["DcMPXxB6", "aRq6YFFA", "4JOa4xo0"], "updated_at": "1987-03-02T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "vxmvIUCE"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'YG5dCIN6' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 82, "userID": "B7BexgAD", "weight": 0.08803235432385415}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'G1vWZSZg' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy 'hPBi7bzY' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName '89yMksgT' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCannotMatch", "deployment": "0XNv9T1T", "description": "hDcliWuE", "findMatchTimeoutSeconds": 76, "joinable": true, "max_delay_ms": 18, "region_expansion_range_ms": 65, "region_expansion_rate_ms": 3, "region_latency_initial_range_ms": 36, "region_latency_max_ms": 13, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 37, "min": 78, "name": "aIqzI5kE"}, {"max": 91, "min": 64, "name": "egguVV0Y"}, {"max": 91, "min": 35, "name": "VJ9NUy97"}], [{"max": 86, "min": 63, "name": "LhnP4c5D"}, {"max": 35, "min": 62, "name": "3EzXdvAU"}, {"max": 15, "min": 78, "name": "MNuh2jw1"}], [{"max": 99, "min": 64, "name": "OmLyDNk8"}, {"max": 20, "min": 60, "name": "Vlh6Leq7"}, {"max": 2, "min": 97, "name": "wz5BAZdm"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 31, "role_flexing_second": 72}, "maxNumber": 49, "minNumber": 29, "playerMaxNumber": 55, "playerMinNumber": 0}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 30, "min": 39, "name": "Sos9amzP"}, {"max": 92, "min": 97, "name": "vxIf8xYP"}, {"max": 53, "min": 95, "name": "E80YUPuM"}], [{"max": 88, "min": 42, "name": "QBWZp2hz"}, {"max": 24, "min": 10, "name": "ACsVVjTK"}, {"max": 68, "min": 9, "name": "zIsRdckG"}], [{"max": 94, "min": 29, "name": "7tCBmPR4"}, {"max": 66, "min": 57, "name": "aTa9LiH7"}, {"max": 65, "min": 33, "name": "ndyWjJa0"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 58, "role_flexing_second": 38}, "duration": 49, "max_number": 75, "min_number": 38, "player_max_number": 81, "player_min_number": 94}, {"combination": {"alliances": [[{"max": 59, "min": 80, "name": "pKt7EkYb"}, {"max": 46, "min": 59, "name": "CLv9oY6p"}, {"max": 52, "min": 43, "name": "5oplu0uL"}], [{"max": 92, "min": 78, "name": "46Ev347E"}, {"max": 47, "min": 9, "name": "znJMtNeh"}, {"max": 36, "min": 2, "name": "n2hA6GfG"}], [{"max": 5, "min": 46, "name": "HKrNPNuu"}, {"max": 67, "min": 49, "name": "cJjqW026"}, {"max": 23, "min": 37, "name": "1sVSmKRk"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 10}, "duration": 89, "max_number": 5, "min_number": 67, "player_max_number": 91, "player_min_number": 45}, {"combination": {"alliances": [[{"max": 7, "min": 41, "name": "Pz0QGFkD"}, {"max": 13, "min": 71, "name": "aFLIb2mF"}, {"max": 98, "min": 24, "name": "GBTptfM4"}], [{"max": 48, "min": 18, "name": "7iFFxpJl"}, {"max": 64, "min": 78, "name": "2yGmBu39"}, {"max": 15, "min": 66, "name": "Ha7RvB48"}], [{"max": 60, "min": 34, "name": "dH5S8sov"}, {"max": 48, "min": 67, "name": "gixgV9Bz"}, {"max": 1, "min": 34, "name": "lpXYfgwy"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 56, "role_flexing_second": 61}, "duration": 3, "max_number": 63, "min_number": 5, "player_max_number": 83, "player_min_number": 56}], "batch_size": 87, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 1, "flex_flat_step_range": 78, "flex_immunity_count": 3, "flex_range_max": 77, "flex_rate_ms": 95, "flex_step_max": 41, "force_authority_match": false, "initial_step_range": 7, "mmr_max": 3, "mmr_mean": 13, "mmr_min": 81, "mmr_std_dev": 27, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "GVu9WuyH", "criteria": "PPGafsQE", "duration": 29, "reference": 0.8085222972593671}, {"attribute": "UymAda3U", "criteria": "YATqvMRb", "duration": 90, "reference": 0.44157990157458915}, {"attribute": "onGJCW5g", "criteria": "bilGyqGH", "duration": 56, "reference": 0.4099343123444342}], "match_options": {"options": [{"name": "GaNTkpAc", "type": "IYzesQzh"}, {"name": "m7pXjN3j", "type": "KaRJLF2T"}, {"name": "tCiM8KvN", "type": "qXc6TUmM"}]}, "matchingRules": [{"attribute": "WJtL52yg", "criteria": "L9dZXvzy", "reference": 0.76887036691427}, {"attribute": "gnlQnxcl", "criteria": "fAoQe306", "reference": 0.5967636139967181}, {"attribute": "FytR8MoQ", "criteria": "DguXmBJX", "reference": 0.8026771700584258}], "sort_ticket": {"search_result": "bkxMJ28R", "ticket_queue": "eItTaDTD"}, "sort_tickets": [{"search_result": "xeNkI6EL", "threshold": 67, "ticket_queue": "UCWnvHNZ"}, {"search_result": "3pGoiIgv", "threshold": 35, "ticket_queue": "1cI15COL"}, {"search_result": "8yR6ilz0", "threshold": 23, "ticket_queue": "lVj6GFmB"}], "sub_game_modes": {}, "ticket_flexing_selection": "iq6Axl8h", "ticket_flexing_selections": [{"selection": "9PmkzW51", "threshold": 53}, {"selection": "wk0gCrss", "threshold": 2}, {"selection": "7en3q5CI", "threshold": 10}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 26, "socialMatchmaking": false, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName '0nh8wpFy' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'z3XZeMPz' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'XDrSTyee' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 97}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName '9hI54muB' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'XGaSS3ng' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "7KQT566K", "count": 14, "mmrMax": 0.9942539967158887, "mmrMean": 0.6602466025112815, "mmrMin": 0.3407113632588388, "mmrStdDev": 0.8635135859391532}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'PL20Oft1' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 79, "party_attributes": {"w4ydPVFL": {}, "rSVjwSJC": {}, "x11wkgln": {}}, "party_id": "zbkpGZSK", "party_members": [{"extra_attributes": {"lmSgeCNF": {}, "qGLjT4q1": {}, "BX2hztnm": {}}, "user_id": "plXQiOXQ"}, {"extra_attributes": {"bNTjp8Wj": {}, "2tTmO6CH": {}, "nkKV7wqj": {}}, "user_id": "sZXHO6PA"}, {"extra_attributes": {"XwULbbtu": {}, "hZEvtVtA": {}, "7ifZIqUk": {}}, "user_id": "bqA4kI8v"}], "ticket_created_at": 3, "ticket_id": "y2A3fZzh"}, {"first_ticket_created_at": 23, "party_attributes": {"TPrZro7z": {}, "YPLTcPKP": {}, "u6TQs36z": {}}, "party_id": "OTWQT5zN", "party_members": [{"extra_attributes": {"0NfYveQu": {}, "iFeOTrtG": {}, "Lvij0dtB": {}}, "user_id": "REOQhJTg"}, {"extra_attributes": {"UMgCWaeD": {}, "FLaqKuwK": {}, "sd1v4ssL": {}}, "user_id": "Cq56reVX"}, {"extra_attributes": {"daSDuvTl": {}, "tOgTSkDu": {}, "Kzd6TBMi": {}}, "user_id": "sJakT6x0"}], "ticket_created_at": 50, "ticket_id": "WBbzSOHL"}, {"first_ticket_created_at": 32, "party_attributes": {"CAQ4r7SL": {}, "FENbNk5w": {}, "PcmoTKI0": {}}, "party_id": "fsSYwonv", "party_members": [{"extra_attributes": {"C4Qbkc8Y": {}, "lbiueyhD": {}, "9tkX6FG1": {}}, "user_id": "9CdpJ5YD"}, {"extra_attributes": {"ZAZbKeTE": {}, "o5RhU2li": {}, "Y1kNFgy4": {}}, "user_id": "mQL3LxCh"}, {"extra_attributes": {"bu6MjfR7": {}, "BWQy6IQI": {}, "Gp91SQeJ": {}}, "user_id": "YDLBIotc"}], "ticket_created_at": 81, "ticket_id": "h2TfLI87"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'DINVcji4' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 92}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'ksW2pwK1' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'e0L5fqvx' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName '08ScWL3V' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["R6ZmuGz2", "tzccwZDR", "kDAYqJaJ"], "party_id": "umznoUF6", "user_id": "Xs8XW2EW"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'fINtLo0S' \
    --matchID 'XJO2UVYT' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'KVa5Y9MB' \
    --matchID 'aTwlQvCC' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'RIF1nYa9' \
    --matchID 'te1UFgzH' \
    --namespace $AB_NAMESPACE \
    --userID 'bcHih8Zw' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'jBFDpku2' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'LU3k7lrG' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE