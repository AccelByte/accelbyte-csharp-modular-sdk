#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '74' \
    --offset '75' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "uP2nxETN", "description": "jZOPGnNT", "find_match_timeout_seconds": 86, "game_mode": "kQ8YuDyk", "joinable": false, "max_delay_ms": 43, "region_expansion_range_ms": 39, "region_expansion_rate_ms": 20, "region_latency_initial_range_ms": 31, "region_latency_max_ms": 44, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 16, "min": 12, "name": "GmodcHQj"}, {"max": 37, "min": 12, "name": "7YnCWLGn"}, {"max": 27, "min": 99, "name": "s4L52vzE"}], [{"max": 9, "min": 82, "name": "defznyGj"}, {"max": 44, "min": 53, "name": "1mXtv8nw"}, {"max": 35, "min": 58, "name": "AmeFG7GK"}], [{"max": 15, "min": 42, "name": "nzLXG08A"}, {"max": 85, "min": 91, "name": "zYsqPnh5"}, {"max": 87, "min": 6, "name": "ACXR2qp8"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 8, "role_flexing_second": 27}, "max_number": 78, "min_number": 39, "player_max_number": 98, "player_min_number": 35}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 57, "min": 93, "name": "6bRANwnI"}, {"max": 64, "min": 6, "name": "PgrPqC2I"}, {"max": 83, "min": 75, "name": "LDY3GoMd"}], [{"max": 13, "min": 22, "name": "TWxPCJRy"}, {"max": 90, "min": 64, "name": "AlYQGmtA"}, {"max": 49, "min": 28, "name": "ClMaQYEI"}], [{"max": 44, "min": 19, "name": "njr5HOrs"}, {"max": 31, "min": 15, "name": "B11s2SHq"}, {"max": 58, "min": 28, "name": "TC32CPjw"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 52, "role_flexing_second": 58}, "duration": 76, "max_number": 73, "min_number": 24, "player_max_number": 5, "player_min_number": 66}, {"combination": {"alliances": [[{"max": 47, "min": 92, "name": "1f3FwYax"}, {"max": 83, "min": 87, "name": "yDfMCRAy"}, {"max": 82, "min": 20, "name": "a9jguQzC"}], [{"max": 41, "min": 94, "name": "D1dgJac0"}, {"max": 16, "min": 72, "name": "Q6v1ZW3c"}, {"max": 24, "min": 74, "name": "E8OzGri7"}], [{"max": 89, "min": 55, "name": "4H4TRvGO"}, {"max": 69, "min": 14, "name": "hw3uDMv3"}, {"max": 73, "min": 61, "name": "qID0rtiU"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 21, "role_flexing_second": 19}, "duration": 45, "max_number": 62, "min_number": 22, "player_max_number": 64, "player_min_number": 91}, {"combination": {"alliances": [[{"max": 71, "min": 2, "name": "Xl34EFXy"}, {"max": 75, "min": 17, "name": "gWM37jAV"}, {"max": 55, "min": 23, "name": "7liew4dV"}], [{"max": 52, "min": 58, "name": "oA8eQt95"}, {"max": 61, "min": 31, "name": "p1eELMU3"}, {"max": 90, "min": 31, "name": "u8WS3aHU"}], [{"max": 52, "min": 24, "name": "OoQJmjb3"}, {"max": 97, "min": 7, "name": "fEXZTU6V"}, {"max": 43, "min": 21, "name": "FEkfavEK"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 9, "role_flexing_second": 0}, "duration": 78, "max_number": 2, "min_number": 52, "player_max_number": 51, "player_min_number": 37}], "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 95, "flex_flat_step_range": 59, "flex_immunity_count": 50, "flex_range_max": 29, "flex_rate_ms": 13, "flex_step_max": 31, "force_authority_match": true, "initial_step_range": 82, "mmr_max": 78, "mmr_mean": 100, "mmr_min": 47, "mmr_std_dev": 73, "override_mmr_data": false, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexing_rule": [{"attribute": "WT6lkSXr", "criteria": "oAcbxJE0", "duration": 88, "reference": 0.15312128463939023}, {"attribute": "sOiIQghy", "criteria": "xc5tGVry", "duration": 62, "reference": 0.6758061322377077}, {"attribute": "1tVsCEvh", "criteria": "7AnJEgLY", "duration": 7, "reference": 0.04576831590415953}], "match_options": {"options": [{"name": "vjSfBzJK", "type": "UCvApUA3"}, {"name": "09skBoTT", "type": "XNuRok0y"}, {"name": "mtGUEmGy", "type": "RigI1t6R"}]}, "matching_rule": [{"attribute": "Tq9nX1xa", "criteria": "nqMreeIl", "reference": 0.15450018927255238}, {"attribute": "ullgwIPn", "criteria": "AFMhTACb", "reference": 0.4563205878518357}, {"attribute": "PB3NBs30", "criteria": "MZpn0gS1", "reference": 0.7055789682531333}], "rebalance_enable": true, "sub_game_modes": {"tyErr9W2": {"alliance": {"combination": {"alliances": [[{"max": 80, "min": 13, "name": "Cd7aSPjx"}, {"max": 66, "min": 54, "name": "9dkf8z2p"}, {"max": 44, "min": 11, "name": "tWy9Ls5F"}], [{"max": 59, "min": 77, "name": "iKNaZEJk"}, {"max": 99, "min": 96, "name": "FpCl6zh8"}, {"max": 94, "min": 62, "name": "VsaFhqvH"}], [{"max": 61, "min": 9, "name": "4SAHauGu"}, {"max": 76, "min": 30, "name": "zjxZunS9"}, {"max": 88, "min": 49, "name": "6tdAwQ1M"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 32, "role_flexing_second": 40}, "max_number": 9, "min_number": 24, "player_max_number": 91, "player_min_number": 70}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 92, "min": 81, "name": "cMUDs4n5"}, {"max": 45, "min": 0, "name": "Lf7EODpZ"}, {"max": 50, "min": 83, "name": "dqOoowWD"}], [{"max": 17, "min": 38, "name": "ZFt28OVD"}, {"max": 52, "min": 5, "name": "8xD5s0my"}, {"max": 32, "min": 20, "name": "umF7Z3VY"}], [{"max": 24, "min": 91, "name": "etglKwlz"}, {"max": 0, "min": 87, "name": "aYHJMCcI"}, {"max": 73, "min": 0, "name": "aalrHrah"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 69, "role_flexing_second": 36}, "duration": 28, "max_number": 78, "min_number": 92, "player_max_number": 7, "player_min_number": 74}, {"combination": {"alliances": [[{"max": 73, "min": 43, "name": "nbFoYaAO"}, {"max": 58, "min": 58, "name": "ajxbolgW"}, {"max": 43, "min": 11, "name": "XIccj2iv"}], [{"max": 98, "min": 16, "name": "0Vk5NPqI"}, {"max": 11, "min": 53, "name": "8TwwMPAB"}, {"max": 91, "min": 38, "name": "fDWCwHTD"}], [{"max": 85, "min": 68, "name": "Y6vfg1u1"}, {"max": 29, "min": 84, "name": "XHoiAr14"}, {"max": 41, "min": 35, "name": "DxdgoPO0"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 23, "role_flexing_second": 42}, "duration": 23, "max_number": 35, "min_number": 58, "player_max_number": 3, "player_min_number": 36}, {"combination": {"alliances": [[{"max": 74, "min": 97, "name": "wmwR67N1"}, {"max": 56, "min": 84, "name": "QfcsuqRQ"}, {"max": 78, "min": 81, "name": "H2rw8zCv"}], [{"max": 2, "min": 94, "name": "9B7wIm6c"}, {"max": 79, "min": 65, "name": "5L5j9qoF"}, {"max": 99, "min": 29, "name": "BWQU7VTc"}], [{"max": 32, "min": 50, "name": "aQddAQv4"}, {"max": 23, "min": 2, "name": "tV0OurLc"}, {"max": 42, "min": 46, "name": "uuJbOqdK"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 49, "role_flexing_second": 48}, "duration": 94, "max_number": 58, "min_number": 95, "player_max_number": 78, "player_min_number": 1}], "name": "hvpdvTvZ"}, "N2UXefSI": {"alliance": {"combination": {"alliances": [[{"max": 33, "min": 83, "name": "o36LSNxY"}, {"max": 82, "min": 17, "name": "rSQ7GZUO"}, {"max": 58, "min": 16, "name": "mmJnnCl4"}], [{"max": 0, "min": 96, "name": "OuUVC329"}, {"max": 17, "min": 73, "name": "dmmX6POj"}, {"max": 67, "min": 77, "name": "Vpqbmw3X"}], [{"max": 1, "min": 19, "name": "ivGa3xKI"}, {"max": 90, "min": 72, "name": "rykFuDzy"}, {"max": 90, "min": 71, "name": "O6PLA4fC"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 54, "role_flexing_second": 64}, "max_number": 86, "min_number": 72, "player_max_number": 84, "player_min_number": 72}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 75, "min": 2, "name": "shPkzzcy"}, {"max": 6, "min": 39, "name": "bxhJlbDo"}, {"max": 39, "min": 80, "name": "ttY9dCei"}], [{"max": 30, "min": 90, "name": "1a7rkrTC"}, {"max": 16, "min": 42, "name": "RRwOla8N"}, {"max": 82, "min": 17, "name": "rNUXYMDZ"}], [{"max": 35, "min": 89, "name": "RWBMp8gu"}, {"max": 78, "min": 38, "name": "6bceeIag"}, {"max": 59, "min": 91, "name": "z9scDdAN"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 4, "role_flexing_second": 37}, "duration": 64, "max_number": 41, "min_number": 49, "player_max_number": 20, "player_min_number": 19}, {"combination": {"alliances": [[{"max": 88, "min": 11, "name": "WqVyOyml"}, {"max": 64, "min": 48, "name": "kjch9jca"}, {"max": 33, "min": 98, "name": "XjP15X3R"}], [{"max": 9, "min": 99, "name": "7jEdOUet"}, {"max": 29, "min": 49, "name": "0FyUZ0fQ"}, {"max": 53, "min": 59, "name": "eicbcxc8"}], [{"max": 66, "min": 34, "name": "fSON9KJQ"}, {"max": 66, "min": 20, "name": "TkpBgWWy"}, {"max": 100, "min": 11, "name": "8p5hRMvJ"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 89, "role_flexing_second": 80}, "duration": 27, "max_number": 32, "min_number": 97, "player_max_number": 93, "player_min_number": 18}, {"combination": {"alliances": [[{"max": 9, "min": 78, "name": "xipPcxHf"}, {"max": 14, "min": 49, "name": "uX3l2pcV"}, {"max": 82, "min": 14, "name": "s9FpzfQe"}], [{"max": 24, "min": 39, "name": "pIzh49xF"}, {"max": 20, "min": 48, "name": "rslFPJAC"}, {"max": 71, "min": 86, "name": "SZd2S6mp"}], [{"max": 76, "min": 23, "name": "omzBEPpm"}, {"max": 30, "min": 90, "name": "TzhrkJqT"}, {"max": 6, "min": 68, "name": "fbrM111i"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 13, "role_flexing_second": 3}, "duration": 79, "max_number": 46, "min_number": 26, "player_max_number": 51, "player_min_number": 52}], "name": "nI2i4rU9"}, "SSSN104D": {"alliance": {"combination": {"alliances": [[{"max": 86, "min": 36, "name": "YpIhqfS2"}, {"max": 13, "min": 43, "name": "VJON2AcT"}, {"max": 72, "min": 96, "name": "okkvWv9v"}], [{"max": 4, "min": 77, "name": "4vWBjl5N"}, {"max": 0, "min": 89, "name": "U7kRP49i"}, {"max": 20, "min": 51, "name": "LgiqzGmn"}], [{"max": 53, "min": 8, "name": "FEVw746o"}, {"max": 10, "min": 16, "name": "duN2X0wG"}, {"max": 0, "min": 5, "name": "IZxeGQEs"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 40, "role_flexing_second": 99}, "max_number": 45, "min_number": 85, "player_max_number": 13, "player_min_number": 87}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 75, "min": 11, "name": "rARpVnUt"}, {"max": 57, "min": 31, "name": "g5WOgctM"}, {"max": 56, "min": 34, "name": "leeejCoU"}], [{"max": 46, "min": 2, "name": "RQF57wvr"}, {"max": 2, "min": 38, "name": "hH45GZ0v"}, {"max": 68, "min": 3, "name": "1k6VVlHo"}], [{"max": 40, "min": 81, "name": "8RkkU7NT"}, {"max": 0, "min": 0, "name": "lWgFIk1o"}, {"max": 80, "min": 25, "name": "yepmGEIC"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 60}, "duration": 79, "max_number": 66, "min_number": 61, "player_max_number": 24, "player_min_number": 81}, {"combination": {"alliances": [[{"max": 54, "min": 13, "name": "h6mUL6Fj"}, {"max": 29, "min": 98, "name": "ichMlpwe"}, {"max": 63, "min": 73, "name": "fskbfKDH"}], [{"max": 67, "min": 70, "name": "GyRnJGAR"}, {"max": 6, "min": 95, "name": "KXRs0jnD"}, {"max": 19, "min": 16, "name": "0Hl9B5tM"}], [{"max": 73, "min": 36, "name": "QSu5rez8"}, {"max": 92, "min": 87, "name": "AP942OtR"}, {"max": 99, "min": 43, "name": "9gKAru1h"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 39, "role_flexing_second": 8}, "duration": 50, "max_number": 88, "min_number": 80, "player_max_number": 39, "player_min_number": 44}, {"combination": {"alliances": [[{"max": 81, "min": 38, "name": "VsD1meWR"}, {"max": 100, "min": 91, "name": "9Zts5fMr"}, {"max": 50, "min": 68, "name": "NWni5xbj"}], [{"max": 27, "min": 19, "name": "mXA5kksi"}, {"max": 94, "min": 78, "name": "QZuooIYZ"}, {"max": 50, "min": 74, "name": "QoP9xHDE"}], [{"max": 75, "min": 69, "name": "vP6E3k5f"}, {"max": 64, "min": 66, "name": "WBU9bvGt"}, {"max": 69, "min": 74, "name": "5R9NWtWq"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 34, "role_flexing_second": 91}, "duration": 23, "max_number": 34, "min_number": 84, "player_max_number": 26, "player_min_number": 8}], "name": "rr8j8H67"}}, "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 77, "social_matchmaking": false, "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'bjAU0FIo' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'wKqQEwqH' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "JAP1Xbq1", "players": [{"results": [{"attribute": "mvGQgPYY", "value": 0.5068212485936777}, {"attribute": "QsfmW8sG", "value": 0.2213803171442822}, {"attribute": "x2uiLwpR", "value": 0.0936629323893926}], "user_id": "EqUlVqHY"}, {"results": [{"attribute": "C3ACy9qV", "value": 0.473363610190052}, {"attribute": "KxOfIfwj", "value": 0.8610540953273442}, {"attribute": "bHmHeWYO", "value": 0.6585454370715177}], "user_id": "RZDOZjbq"}, {"results": [{"attribute": "PDtLbNlE", "value": 0.12611936587296102}, {"attribute": "tlx724lR", "value": 0.18105530525448654}, {"attribute": "5x9OuxSD", "value": 0.8543652374423849}], "user_id": "U491P9ol"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "hI3QhaKJ"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "L8i9GdhN", "client_version": "jo2qDoKv", "deployment": "J5RIrKl1", "error_code": 58, "error_message": "BokdlUXG", "game_mode": "q5tLM2R8", "is_mock": "dqLWr9jo", "joinable": false, "match_id": "46h0ajgN", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 77, "party_attributes": {"SRiqGQWn": {}, "aRaextCI": {}, "dtq2aZC4": {}}, "party_id": "rO16s00b", "party_members": [{"extra_attributes": {"e06vRBKJ": {}, "kMloxDfm": {}, "wJ2JnDW2": {}}, "user_id": "jZlHMLHA"}, {"extra_attributes": {"xIyE9vws": {}, "l51kahip": {}, "8ibNL9YB": {}}, "user_id": "7Z0RD5sj"}, {"extra_attributes": {"toUjloyc": {}, "go2wktUH": {}, "RIQ7Ix4E": {}}, "user_id": "8cYyEOca"}], "ticket_created_at": 32, "ticket_id": "0MGI57GF"}, {"first_ticket_created_at": 26, "party_attributes": {"HoO99A8j": {}, "vPHWIsRX": {}, "Gw2eKp8w": {}}, "party_id": "U4aUnoPA", "party_members": [{"extra_attributes": {"VqnzDbJV": {}, "NwWDeWUZ": {}, "MWCkt2EI": {}}, "user_id": "Ey80gu3O"}, {"extra_attributes": {"z4DI7Xks": {}, "hnkDTPe5": {}, "Odj7DrCv": {}}, "user_id": "rG5eYHqq"}, {"extra_attributes": {"wI7upQWE": {}, "DNV2nrCh": {}, "eJRpQ4ja": {}}, "user_id": "0Eb7g4It"}], "ticket_created_at": 20, "ticket_id": "s3id9KLz"}, {"first_ticket_created_at": 24, "party_attributes": {"sevNXVzF": {}, "3lDzyRgb": {}, "nqyElFG4": {}}, "party_id": "RqxXdpeP", "party_members": [{"extra_attributes": {"Uj0rg6gS": {}, "xikHUnsY": {}, "0z07y2Og": {}}, "user_id": "EQZuj5TA"}, {"extra_attributes": {"DvmqVnhH": {}, "MiQRxPlJ": {}, "42bcdo2U": {}}, "user_id": "YTPwcSvr"}, {"extra_attributes": {"P1ZRN0oR": {}, "IPYzcQBK": {}, "JO2Miv51": {}}, "user_id": "Rlgv0trl"}], "ticket_created_at": 20, "ticket_id": "sGLIbtA5"}]}, {"matching_parties": [{"first_ticket_created_at": 3, "party_attributes": {"y4IVc7pa": {}, "iVP85hTm": {}, "u4679L1D": {}}, "party_id": "m09XhtHu", "party_members": [{"extra_attributes": {"ffe1X0Pj": {}, "a78SAjSj": {}, "ZNfpMDW9": {}}, "user_id": "Qyjwth0p"}, {"extra_attributes": {"3kRAnyfu": {}, "UAo0gC2k": {}, "695zZFgE": {}}, "user_id": "z7aDoYjK"}, {"extra_attributes": {"Qd8kgW22": {}, "hoOReW9g": {}, "GV0Nng8Q": {}}, "user_id": "2ZLFP9Qe"}], "ticket_created_at": 58, "ticket_id": "uhrVwGWk"}, {"first_ticket_created_at": 22, "party_attributes": {"BN4KL8U2": {}, "1LofMzxT": {}, "q3BT831p": {}}, "party_id": "OoxgnB5T", "party_members": [{"extra_attributes": {"CgFs4kFF": {}, "GeZRMO0w": {}, "b9mWUdTZ": {}}, "user_id": "sfb2ThYE"}, {"extra_attributes": {"PjhsvPE7": {}, "MEO4s2GR": {}, "I6GhmX3S": {}}, "user_id": "qG0XnW2J"}, {"extra_attributes": {"KMFs4pOq": {}, "fRqqmUlu": {}, "ni9Xmj8K": {}}, "user_id": "ey0iXhkQ"}], "ticket_created_at": 24, "ticket_id": "TKcL3F0I"}, {"first_ticket_created_at": 19, "party_attributes": {"UXG7Qvvh": {}, "eO6cw6BS": {}, "xAuEdHhg": {}}, "party_id": "N4lSxJK5", "party_members": [{"extra_attributes": {"JmBNEAKY": {}, "PlHZHkyJ": {}, "pHDL1TTG": {}}, "user_id": "mBs9yUEg"}, {"extra_attributes": {"CYTRadgl": {}, "F59fGjTh": {}, "rzO034HC": {}}, "user_id": "sBnU92z7"}, {"extra_attributes": {"f71WoRdI": {}, "TRLILG44": {}, "AONzvuvZ": {}}, "user_id": "7XRhO8vB"}], "ticket_created_at": 80, "ticket_id": "Z6itRcnP"}]}, {"matching_parties": [{"first_ticket_created_at": 35, "party_attributes": {"TA7ssHPU": {}, "RvqnSSUZ": {}, "vpdUt1jJ": {}}, "party_id": "f2rze71i", "party_members": [{"extra_attributes": {"QBtSjsKp": {}, "A30fX1Bz": {}, "IUCyjAi1": {}}, "user_id": "GPqy3XBb"}, {"extra_attributes": {"pGSiLqlP": {}, "L1hidB3Z": {}, "sV8CnGux": {}}, "user_id": "ithzAGAi"}, {"extra_attributes": {"GL0BMh7u": {}, "2v79mNSn": {}, "Dic8L8lw": {}}, "user_id": "GLoPzmYt"}], "ticket_created_at": 9, "ticket_id": "CLmG2lGL"}, {"first_ticket_created_at": 49, "party_attributes": {"AuVEFBdE": {}, "RWVYIzWt": {}, "JLwbzvtc": {}}, "party_id": "irZf21pO", "party_members": [{"extra_attributes": {"UbpzmQHi": {}, "AL64GV74": {}, "bwYs7qTN": {}}, "user_id": "ZVOh9djk"}, {"extra_attributes": {"u1Qi4wgp": {}, "bKVmFhen": {}, "OxAt2ljy": {}}, "user_id": "Ah2OClQw"}, {"extra_attributes": {"6qWfxnyq": {}, "PiuBl770": {}, "E7yWWqtt": {}}, "user_id": "I7kDMmGd"}], "ticket_created_at": 36, "ticket_id": "WVVNjRnE"}, {"first_ticket_created_at": 28, "party_attributes": {"YhuibknW": {}, "aOKp49nO": {}, "SNOMYMze": {}}, "party_id": "A8izg33o", "party_members": [{"extra_attributes": {"fWecn7jY": {}, "TL4UkpR6": {}, "atV9LENS": {}}, "user_id": "54ta0SYb"}, {"extra_attributes": {"Nmt9e6MM": {}, "Q3EUROE2": {}, "RgFR7nB4": {}}, "user_id": "MZXoZTPy"}, {"extra_attributes": {"fzRiXUJO": {}, "n7GxVGZL": {}, "6fPihF8X": {}}, "user_id": "qgvAKOsd"}], "ticket_created_at": 77, "ticket_id": "BwTyyTqQ"}]}], "namespace": "33pUUhcN", "party_attributes": {"feFsxnAS": {}, "lhE2fFqc": {}, "cEwMzREi": {}}, "party_id": "zJE16q3x", "queued_at": 41, "region": "2NRKKCL3", "server_name": "sJe2LEcb", "status": "0CNX7BwK", "ticket_id": "SCW1y1aV", "ticket_ids": ["iPvhmtYa", "0RDsvedl", "nVowYYxk"], "updated_at": "1991-08-31T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "eLXt0XDb"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID '4nBeCyr2' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 55, "userID": "aKU9pEjJ", "weight": 0.7863904582382162}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs '2nrtKWWu' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy '66qop4lH' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName '80jIBXM5' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "MO0gADov", "description": "tXyUwVZy", "findMatchTimeoutSeconds": 66, "joinable": false, "max_delay_ms": 57, "region_expansion_range_ms": 17, "region_expansion_rate_ms": 1, "region_latency_initial_range_ms": 52, "region_latency_max_ms": 83, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 10, "min": 15, "name": "RjWGpXkX"}, {"max": 32, "min": 40, "name": "yIltvjTl"}, {"max": 3, "min": 2, "name": "YJiZc2R0"}], [{"max": 59, "min": 64, "name": "aQfQhW33"}, {"max": 68, "min": 3, "name": "CdS2GHuc"}, {"max": 40, "min": 49, "name": "dGrI4dy9"}], [{"max": 7, "min": 37, "name": "1GWG9hlj"}, {"max": 78, "min": 56, "name": "KHTJRjKL"}, {"max": 46, "min": 18, "name": "RCFHQCIs"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 95, "role_flexing_second": 63}, "maxNumber": 23, "minNumber": 71, "playerMaxNumber": 21, "playerMinNumber": 19}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 92, "min": 52, "name": "WcHgPKDM"}, {"max": 29, "min": 82, "name": "WiOaOdWz"}, {"max": 83, "min": 18, "name": "i3bzyHxn"}], [{"max": 31, "min": 95, "name": "tmKjUFXr"}, {"max": 26, "min": 16, "name": "5KVdZdAn"}, {"max": 65, "min": 74, "name": "bj8ABmKt"}], [{"max": 37, "min": 72, "name": "q3JigRym"}, {"max": 24, "min": 70, "name": "rXUHsNTv"}, {"max": 84, "min": 32, "name": "pllZUD6s"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 89, "role_flexing_second": 18}, "duration": 44, "max_number": 72, "min_number": 3, "player_max_number": 71, "player_min_number": 71}, {"combination": {"alliances": [[{"max": 22, "min": 72, "name": "tl86jH1x"}, {"max": 68, "min": 38, "name": "adtGciwD"}, {"max": 17, "min": 4, "name": "4CqkNSOW"}], [{"max": 76, "min": 57, "name": "I87PbZ2G"}, {"max": 23, "min": 88, "name": "lBzaVziu"}, {"max": 71, "min": 35, "name": "UNZimIuG"}], [{"max": 47, "min": 86, "name": "O5plGQnL"}, {"max": 29, "min": 88, "name": "gkL6aGd9"}, {"max": 27, "min": 78, "name": "pofFUHvr"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 9, "role_flexing_second": 78}, "duration": 95, "max_number": 50, "min_number": 94, "player_max_number": 100, "player_min_number": 37}, {"combination": {"alliances": [[{"max": 62, "min": 98, "name": "mKrIZvCK"}, {"max": 38, "min": 90, "name": "MK3U8jzg"}, {"max": 75, "min": 14, "name": "wHVzTWrs"}], [{"max": 1, "min": 3, "name": "JzZnrs5M"}, {"max": 5, "min": 90, "name": "cIlJDgKG"}, {"max": 23, "min": 87, "name": "UmfQpUiF"}], [{"max": 12, "min": 26, "name": "wJtfXf8C"}, {"max": 86, "min": 65, "name": "9vcANJkZ"}, {"max": 22, "min": 2, "name": "nmDPz5vu"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 73, "role_flexing_second": 39}, "duration": 29, "max_number": 97, "min_number": 51, "player_max_number": 47, "player_min_number": 58}], "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 27, "flex_flat_step_range": 0, "flex_immunity_count": 75, "flex_range_max": 12, "flex_rate_ms": 6, "flex_step_max": 25, "force_authority_match": false, "initial_step_range": 20, "mmr_max": 98, "mmr_mean": 92, "mmr_min": 80, "mmr_std_dev": 95, "override_mmr_data": false, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "LRmOpFXz", "criteria": "kCQ1Avlh", "duration": 71, "reference": 0.6453543524292398}, {"attribute": "VSfwVpC0", "criteria": "qvfPpuoK", "duration": 11, "reference": 0.2629244742437693}, {"attribute": "zoWj2OLt", "criteria": "9gXLfvTh", "duration": 44, "reference": 0.3009076783272615}], "match_options": {"options": [{"name": "wul1Ux3J", "type": "TCb8IZ3I"}, {"name": "DJhxgHXm", "type": "p4XqhYie"}, {"name": "DiFwalF6", "type": "AyOeit6N"}]}, "matchingRules": [{"attribute": "k90Ai2Ah", "criteria": "4euldluE", "reference": 0.059694439027735635}, {"attribute": "NOEXy8oZ", "criteria": "OrUIV6Yv", "reference": 0.8177804426380157}, {"attribute": "5djnT95g", "criteria": "lcIckXcm", "reference": 0.42981958896398376}], "sub_game_modes": {}, "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 94, "socialMatchmaking": false, "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName '221Bfoop' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'lJyQiUwP' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'yAS5Iaub' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 85}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'CJGK6apD' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'OzLnyX5U' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "zp9sfGpE", "count": 73, "mmrMax": 0.906268719479277, "mmrMean": 0.3232066325983648, "mmrMin": 0.16393748578833334, "mmrStdDev": 0.9985052113039883}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'UqWjrQ6x' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 95, "party_attributes": {"xpfkkQFS": {}, "tiLV8par": {}, "pARH0e7K": {}}, "party_id": "bryMaCYG", "party_members": [{"extra_attributes": {"H9fwSlIt": {}, "YBNWQ94K": {}, "Qy8K0PMa": {}}, "user_id": "ViZCgQFm"}, {"extra_attributes": {"LTsHvDvg": {}, "vk07fBDi": {}, "pZyYVRun": {}}, "user_id": "DwTHNOmy"}, {"extra_attributes": {"3IC9ltOc": {}, "rkO6wJEs": {}, "79LV2LSi": {}}, "user_id": "FZ9gjnAE"}], "ticket_created_at": 46, "ticket_id": "OC2iEV4C"}, {"first_ticket_created_at": 4, "party_attributes": {"5IvqvHcO": {}, "FAbkJtxW": {}, "D4ghN8Mm": {}}, "party_id": "zcCPY0O4", "party_members": [{"extra_attributes": {"B1uwjNvv": {}, "qsVEfhNa": {}, "H5HLVmBS": {}}, "user_id": "PGYvBilI"}, {"extra_attributes": {"8ArIiQ1z": {}, "uLjjX2Fz": {}, "0ZQ5ULys": {}}, "user_id": "sI06gwSo"}, {"extra_attributes": {"262mCe82": {}, "rYb7RndC": {}, "gogHoRa5": {}}, "user_id": "9ymr3iU3"}], "ticket_created_at": 39, "ticket_id": "Hy3Hccih"}, {"first_ticket_created_at": 2, "party_attributes": {"ifQD3tAD": {}, "usRO2qio": {}, "VqbQOn9h": {}}, "party_id": "H4FKS0my", "party_members": [{"extra_attributes": {"YOjEeF4K": {}, "Cyc9VI0Z": {}, "GmDnudox": {}}, "user_id": "lPjbRfYT"}, {"extra_attributes": {"sjNKTzbI": {}, "KTDJIPOm": {}, "h0QqMMoi": {}}, "user_id": "TIhjXeUP"}, {"extra_attributes": {"zPLD721R": {}, "6I3l9fzW": {}, "zv83SYAx": {}}, "user_id": "KmU2c7Z1"}], "ticket_created_at": 2, "ticket_id": "32uMDF2Z"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'pRq3VlGl' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 37}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'oUiCIAMb' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'IgJsOfra' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'wXpdUIzy' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["OhZe7tL9", "BjlmLTpD", "8s3yqgBJ"], "party_id": "z8PGXhk8", "user_id": "4Yj0UPNm"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'UbcUfCnC' \
    --matchID 'tbtDBKqq' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'VfXONojk' \
    --matchID 'Gg5Y9QMR' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'GZVBgzwn' \
    --matchID 'xLWit7tJ' \
    --namespace $AB_NAMESPACE \
    --userID '87uMeUBY' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'r3yYU5lU' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'hheOMmf6' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE