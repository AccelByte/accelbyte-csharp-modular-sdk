#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '23' \
    --offset '86' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatch", "deployment": "m8Tv4Ys6", "description": "QA0Rckt4", "find_match_timeout_seconds": 19, "game_mode": "JlZMFxLg", "joinable": false, "max_delay_ms": 6, "region_expansion_range_ms": 79, "region_expansion_rate_ms": 28, "region_latency_initial_range_ms": 16, "region_latency_max_ms": 21, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 8, "min": 23, "name": "edkf2ISi"}, {"max": 63, "min": 33, "name": "5yYosN5W"}, {"max": 26, "min": 100, "name": "JvrLAWNR"}], [{"max": 53, "min": 94, "name": "WgqMMaPm"}, {"max": 99, "min": 80, "name": "OS2ZfQp1"}, {"max": 41, "min": 57, "name": "VuXd7wPH"}], [{"max": 27, "min": 88, "name": "BiFGOh9b"}, {"max": 13, "min": 23, "name": "A5qfYtdG"}, {"max": 88, "min": 50, "name": "Mxe9KaPt"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 23, "role_flexing_second": 53}, "max_number": 35, "min_number": 78, "player_max_number": 50, "player_min_number": 90}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 10, "min": 67, "name": "sWWvJvBi"}, {"max": 27, "min": 25, "name": "3a4IMeuZ"}, {"max": 15, "min": 31, "name": "8koJqtfj"}], [{"max": 83, "min": 57, "name": "lMCeZgho"}, {"max": 7, "min": 26, "name": "krb1n5DB"}, {"max": 34, "min": 69, "name": "zDOtCVGF"}], [{"max": 68, "min": 86, "name": "r7bUM7k2"}, {"max": 40, "min": 20, "name": "KrTu9FO9"}, {"max": 9, "min": 49, "name": "qDY07eL4"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 38, "role_flexing_second": 89}, "duration": 41, "max_number": 5, "min_number": 88, "player_max_number": 26, "player_min_number": 53}, {"combination": {"alliances": [[{"max": 23, "min": 58, "name": "cJ5qD38o"}, {"max": 6, "min": 35, "name": "9mBT7uhW"}, {"max": 51, "min": 75, "name": "FlljDgXd"}], [{"max": 80, "min": 20, "name": "8x2hCQUT"}, {"max": 37, "min": 33, "name": "i3LyrFI9"}, {"max": 79, "min": 65, "name": "jdFWDpmV"}], [{"max": 76, "min": 14, "name": "sOiIsGpA"}, {"max": 27, "min": 33, "name": "4mDJO32R"}, {"max": 37, "min": 14, "name": "Hq9inRXx"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 67, "role_flexing_second": 63}, "duration": 89, "max_number": 82, "min_number": 82, "player_max_number": 10, "player_min_number": 76}, {"combination": {"alliances": [[{"max": 38, "min": 95, "name": "Ep3pWpxy"}, {"max": 100, "min": 49, "name": "sMR0f1pH"}, {"max": 98, "min": 18, "name": "htWkBq9R"}], [{"max": 93, "min": 81, "name": "L4uoiidJ"}, {"max": 71, "min": 59, "name": "c0Bz5Iq8"}, {"max": 32, "min": 52, "name": "lcBoo8Yk"}], [{"max": 11, "min": 2, "name": "Z9DRH1FH"}, {"max": 61, "min": 69, "name": "jMQ38sTM"}, {"max": 12, "min": 51, "name": "GT598Kj0"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 79, "role_flexing_second": 93}, "duration": 42, "max_number": 92, "min_number": 40, "player_max_number": 97, "player_min_number": 26}], "batch_size": 39, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 54, "flex_flat_step_range": 12, "flex_immunity_count": 92, "flex_range_max": 21, "flex_rate_ms": 84, "flex_step_max": 61, "force_authority_match": false, "initial_step_range": 34, "mmr_max": 15, "mmr_mean": 75, "mmr_min": 14, "mmr_std_dev": 33, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "PCt9AHfI", "criteria": "XUoo19M5", "duration": 74, "reference": 0.9353978863645548}, {"attribute": "R8gKzK9l", "criteria": "Jcs9R2Xi", "duration": 73, "reference": 0.7552188259624661}, {"attribute": "tsPM76FG", "criteria": "cRfQoGBS", "duration": 35, "reference": 0.23825874961469218}], "match_options": {"options": [{"name": "aMWNxnb8", "type": "fUGaeDMu"}, {"name": "xRBkFlLQ", "type": "4xB2aRKQ"}, {"name": "t3lCVq3C", "type": "quDmP1Aa"}]}, "matching_rule": [{"attribute": "KoSM4fJr", "criteria": "c1Ql4GdU", "reference": 0.487893499270983}, {"attribute": "Wb0l6zYR", "criteria": "Gzej2E2r", "reference": 0.7910391284170951}, {"attribute": "BGLM7wd4", "criteria": "gD1UYlwD", "reference": 0.47605235165266746}], "rebalance_enable": false, "sort_ticket": {"search_result": "oldestTicketAge", "ticket_queue": "random"}, "sort_tickets": [{"search_result": "distance", "threshold": 12, "ticket_queue": "random"}, {"search_result": "oldestTicketAge", "threshold": 30, "ticket_queue": "random"}, {"search_result": "distance", "threshold": 85, "ticket_queue": "oldestTicketAge"}], "sub_game_modes": {"RS5blu89": {"alliance": {"combination": {"alliances": [[{"max": 43, "min": 3, "name": "o9XlIp7m"}, {"max": 60, "min": 62, "name": "MJorJGJV"}, {"max": 68, "min": 4, "name": "5NzUtShZ"}], [{"max": 7, "min": 72, "name": "eYXx65Lb"}, {"max": 18, "min": 87, "name": "CUMa5dAX"}, {"max": 77, "min": 31, "name": "lOD9paGi"}], [{"max": 91, "min": 60, "name": "MFFv0wbk"}, {"max": 36, "min": 22, "name": "guSbps2a"}, {"max": 56, "min": 10, "name": "6MiB1MP2"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 94, "role_flexing_second": 29}, "max_number": 91, "min_number": 16, "player_max_number": 6, "player_min_number": 13}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 33, "min": 87, "name": "RxFXVRTB"}, {"max": 86, "min": 45, "name": "ylLMxQk1"}, {"max": 5, "min": 15, "name": "T7Y9EU6U"}], [{"max": 15, "min": 45, "name": "dpzGljQ2"}, {"max": 88, "min": 66, "name": "lMBN08ZJ"}, {"max": 5, "min": 94, "name": "9IsS7cIi"}], [{"max": 67, "min": 14, "name": "kdmQZMFs"}, {"max": 73, "min": 74, "name": "1Ua4lJWn"}, {"max": 94, "min": 37, "name": "0FeRplGS"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 30, "role_flexing_second": 78}, "duration": 21, "max_number": 58, "min_number": 86, "player_max_number": 92, "player_min_number": 54}, {"combination": {"alliances": [[{"max": 84, "min": 68, "name": "8bsAxxXE"}, {"max": 72, "min": 6, "name": "Ovb5A42z"}, {"max": 42, "min": 30, "name": "qphuaE7m"}], [{"max": 8, "min": 76, "name": "DiTJB6nD"}, {"max": 12, "min": 35, "name": "fAPq6Rie"}, {"max": 3, "min": 59, "name": "plDPascH"}], [{"max": 17, "min": 30, "name": "HC2Mn2yN"}, {"max": 68, "min": 94, "name": "NLpYSFqM"}, {"max": 22, "min": 55, "name": "YElIshN8"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 90, "role_flexing_second": 97}, "duration": 41, "max_number": 84, "min_number": 63, "player_max_number": 34, "player_min_number": 37}, {"combination": {"alliances": [[{"max": 58, "min": 34, "name": "JuZbsn3A"}, {"max": 99, "min": 44, "name": "1eWCEYCH"}, {"max": 94, "min": 0, "name": "bTfankjY"}], [{"max": 55, "min": 18, "name": "O2DuObJ6"}, {"max": 65, "min": 89, "name": "nUNzomW0"}, {"max": 27, "min": 43, "name": "rjXlfC73"}], [{"max": 86, "min": 53, "name": "IXK4GhJs"}, {"max": 8, "min": 91, "name": "C03WmoHG"}, {"max": 87, "min": 48, "name": "4L6R4DMX"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 77, "role_flexing_second": 2}, "duration": 6, "max_number": 45, "min_number": 52, "player_max_number": 16, "player_min_number": 34}], "name": "PWqUO49H"}, "VBu37qHt": {"alliance": {"combination": {"alliances": [[{"max": 54, "min": 54, "name": "IKxeYnGT"}, {"max": 85, "min": 86, "name": "SGt8Cr1Z"}, {"max": 21, "min": 61, "name": "E81f0YOC"}], [{"max": 71, "min": 57, "name": "i8KFiCtT"}, {"max": 40, "min": 2, "name": "XVu0tcNG"}, {"max": 18, "min": 67, "name": "eebtitDc"}], [{"max": 51, "min": 46, "name": "1PruHw8W"}, {"max": 85, "min": 29, "name": "i8klA4Dn"}, {"max": 72, "min": 3, "name": "HIcj8asd"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 30, "role_flexing_second": 70}, "max_number": 32, "min_number": 90, "player_max_number": 18, "player_min_number": 9}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 9, "min": 57, "name": "aHFt3y1T"}, {"max": 39, "min": 39, "name": "KJu5Dl1i"}, {"max": 84, "min": 24, "name": "hKiBQ36M"}], [{"max": 68, "min": 78, "name": "zOyb6NUk"}, {"max": 64, "min": 11, "name": "3xwl0ndy"}, {"max": 64, "min": 56, "name": "67Yf3arS"}], [{"max": 68, "min": 78, "name": "dDOgysYk"}, {"max": 78, "min": 68, "name": "VEMd34tf"}, {"max": 80, "min": 60, "name": "6Tv1bW7L"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 56, "role_flexing_second": 98}, "duration": 64, "max_number": 28, "min_number": 30, "player_max_number": 31, "player_min_number": 77}, {"combination": {"alliances": [[{"max": 21, "min": 47, "name": "RjSp705k"}, {"max": 78, "min": 3, "name": "FowXo3xC"}, {"max": 11, "min": 97, "name": "OV8zObPX"}], [{"max": 65, "min": 5, "name": "CHi7mBS9"}, {"max": 51, "min": 25, "name": "292ZnGeI"}, {"max": 0, "min": 62, "name": "6CuzGebe"}], [{"max": 22, "min": 24, "name": "fBbla35F"}, {"max": 78, "min": 52, "name": "6cWYzRtC"}, {"max": 38, "min": 89, "name": "8nr4dsR8"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 73, "role_flexing_second": 57}, "duration": 76, "max_number": 53, "min_number": 76, "player_max_number": 33, "player_min_number": 15}, {"combination": {"alliances": [[{"max": 33, "min": 58, "name": "wxrkaBza"}, {"max": 82, "min": 47, "name": "6F05nbZQ"}, {"max": 37, "min": 0, "name": "sZfHXUsd"}], [{"max": 72, "min": 35, "name": "muKY75OQ"}, {"max": 64, "min": 53, "name": "wL8DpRmf"}, {"max": 12, "min": 12, "name": "P1X9356P"}], [{"max": 27, "min": 43, "name": "0D6yjqpy"}, {"max": 11, "min": 81, "name": "J0zG36E8"}, {"max": 71, "min": 80, "name": "Y0XI7Tje"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 22, "role_flexing_second": 64}, "duration": 4, "max_number": 28, "min_number": 56, "player_max_number": 54, "player_min_number": 95}], "name": "7rmnlfEB"}, "HlB3F45o": {"alliance": {"combination": {"alliances": [[{"max": 66, "min": 0, "name": "L7rAkkxx"}, {"max": 17, "min": 26, "name": "5vTF750B"}, {"max": 17, "min": 62, "name": "i7Gc9Vky"}], [{"max": 88, "min": 15, "name": "yQJHYm0Q"}, {"max": 99, "min": 80, "name": "5QcQr24i"}, {"max": 61, "min": 49, "name": "towmnF9q"}], [{"max": 78, "min": 14, "name": "uipllCBb"}, {"max": 99, "min": 9, "name": "MI8kZLgw"}, {"max": 12, "min": 61, "name": "vnC8QoWl"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 95, "role_flexing_second": 17}, "max_number": 7, "min_number": 80, "player_max_number": 28, "player_min_number": 74}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 91, "min": 64, "name": "VqG3zS60"}, {"max": 94, "min": 100, "name": "kwuhkmQx"}, {"max": 47, "min": 12, "name": "JpA0iBLq"}], [{"max": 57, "min": 73, "name": "uFkNeW9G"}, {"max": 68, "min": 78, "name": "QveNeyv5"}, {"max": 89, "min": 9, "name": "jDpzNRb4"}], [{"max": 84, "min": 94, "name": "Ki9KBTUk"}, {"max": 95, "min": 91, "name": "lh4BZS0G"}, {"max": 45, "min": 43, "name": "dzTKwokg"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 19, "role_flexing_second": 24}, "duration": 7, "max_number": 20, "min_number": 16, "player_max_number": 53, "player_min_number": 13}, {"combination": {"alliances": [[{"max": 49, "min": 69, "name": "n6bigK3y"}, {"max": 54, "min": 25, "name": "OhBJDZ2P"}, {"max": 28, "min": 12, "name": "QfsryVuw"}], [{"max": 95, "min": 35, "name": "1Uu9j4hB"}, {"max": 34, "min": 84, "name": "grcXZm2o"}, {"max": 9, "min": 52, "name": "yshW4ACk"}], [{"max": 76, "min": 60, "name": "OlWCFPTl"}, {"max": 42, "min": 98, "name": "iK0VDpKH"}, {"max": 82, "min": 42, "name": "nQBltOQG"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 62, "role_flexing_second": 70}, "duration": 98, "max_number": 36, "min_number": 57, "player_max_number": 80, "player_min_number": 8}, {"combination": {"alliances": [[{"max": 72, "min": 43, "name": "5Xg7UENI"}, {"max": 22, "min": 49, "name": "OArAcHht"}, {"max": 93, "min": 57, "name": "VWRm7Vcd"}], [{"max": 64, "min": 47, "name": "ARVuGFUV"}, {"max": 76, "min": 85, "name": "ZcSQcGRq"}, {"max": 95, "min": 40, "name": "vXx0YdUV"}], [{"max": 62, "min": 53, "name": "ODqRrFxL"}, {"max": 91, "min": 53, "name": "0imfxhOs"}, {"max": 52, "min": 48, "name": "K8GSJPYc"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 99, "role_flexing_second": 55}, "duration": 6, "max_number": 66, "min_number": 50, "player_max_number": 9, "player_min_number": 52}], "name": "qDTGZAeg"}}, "ticket_flexing_selection": "pivot", "ticket_flexing_selections": [{"selection": "random", "threshold": 19}, {"selection": "newest", "threshold": 99}, {"selection": "newest", "threshold": 42}], "use_newest_ticket_for_flexing": false}, "session_queue_timeout_seconds": 97, "social_matchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName '2cXsLgXM' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel '7WIFGktv' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "outUfvdA", "players": [{"results": [{"attribute": "r2CpaxeR", "value": 0.15844556051452607}, {"attribute": "qXu35nNT", "value": 0.5306681074782734}, {"attribute": "4356CrGP", "value": 0.8091811895411463}], "user_id": "ZeJbt8qX"}, {"results": [{"attribute": "8EM1UO6p", "value": 0.6163758132163091}, {"attribute": "W07oFPC9", "value": 0.3569952136070931}, {"attribute": "JoNjCH83", "value": 0.4601928208790961}], "user_id": "LtBcyypn"}, {"results": [{"attribute": "cEyaKoyj", "value": 0.9027004755430778}, {"attribute": "GGrppyfF", "value": 0.8768938294595453}, {"attribute": "I91kMYm5", "value": 0.8861729092949029}], "user_id": "RrsbRRAS"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "4BbYBM69"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "WGaLZqsS", "client_version": "1z5UHeHD", "deployment": "l0boAeeW", "error_code": 20, "error_message": "ZxLZ3o4e", "game_mode": "yMee3s00", "is_mock": "KjXmHyx1", "joinable": false, "match_id": "sCbAcS1p", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 34, "party_attributes": {"thUNMZkI": {}, "rsBWOsrO": {}, "w14GrCOP": {}}, "party_id": "sVEKIrSh", "party_members": [{"extra_attributes": {"WwwiKKWJ": {}, "M8RtHrLp": {}, "h6A5t1Tx": {}}, "user_id": "q2FkPJOY"}, {"extra_attributes": {"L33dkxJk": {}, "RwwXDabl": {}, "9apvGtGf": {}}, "user_id": "LJkEwrdn"}, {"extra_attributes": {"6ikVisTn": {}, "RfBcJM4E": {}, "Edgl6DEe": {}}, "user_id": "YDmlcvEa"}], "ticket_created_at": 12, "ticket_id": "UW5YyYFo"}, {"first_ticket_created_at": 14, "party_attributes": {"5HXBKM6w": {}, "vcMoWlq9": {}, "LuAjF1Fm": {}}, "party_id": "Vnm8Iz57", "party_members": [{"extra_attributes": {"1RK7jlBr": {}, "8pHhTgRy": {}, "Fc7jrBSd": {}}, "user_id": "9JsBf7Eb"}, {"extra_attributes": {"NArGT2TF": {}, "WXNzZeCW": {}, "Da3jfXTJ": {}}, "user_id": "feRKZ8Ol"}, {"extra_attributes": {"WYPUMwst": {}, "ddVXLvMQ": {}, "rJEXEfG4": {}}, "user_id": "zgblxP0a"}], "ticket_created_at": 73, "ticket_id": "F1W6vtDJ"}, {"first_ticket_created_at": 35, "party_attributes": {"s1cULaLZ": {}, "KcFdiy0W": {}, "XeK0KDHi": {}}, "party_id": "HTQ4FCcj", "party_members": [{"extra_attributes": {"JTpV609g": {}, "m6FQEXKy": {}, "TbKHPFVf": {}}, "user_id": "k0vagiLq"}, {"extra_attributes": {"TR70m7uh": {}, "W0ie6fJX": {}, "xrZhA7cO": {}}, "user_id": "HsAPTtfr"}, {"extra_attributes": {"pZQ1fDeq": {}, "x6dE35pW": {}, "P7M65Uio": {}}, "user_id": "PJZUN6jF"}], "ticket_created_at": 30, "ticket_id": "zZj4ElRH"}]}, {"matching_parties": [{"first_ticket_created_at": 89, "party_attributes": {"IyJw2BYu": {}, "eor0NeRu": {}, "iKz1wKy5": {}}, "party_id": "3hlUEdMT", "party_members": [{"extra_attributes": {"QZ7pWXoo": {}, "4ok2jlvj": {}, "G9fLcpdm": {}}, "user_id": "V5VKpEit"}, {"extra_attributes": {"v4AMBXgc": {}, "upTLhkHA": {}, "dR66M5gR": {}}, "user_id": "E0WO9jbq"}, {"extra_attributes": {"MHdrKOLD": {}, "hYzs6wiN": {}, "NEAkLGex": {}}, "user_id": "4LVquqiU"}], "ticket_created_at": 68, "ticket_id": "2noJrpJM"}, {"first_ticket_created_at": 83, "party_attributes": {"0pZ7QrAt": {}, "XhvGioxk": {}, "dbwlrC4w": {}}, "party_id": "iyypGylN", "party_members": [{"extra_attributes": {"Ehs7gajS": {}, "8LtglIVO": {}, "cY9QlB0S": {}}, "user_id": "9DgN5uVg"}, {"extra_attributes": {"Pt1oghYp": {}, "QaoL2yNH": {}, "RhV4w9JO": {}}, "user_id": "eRzmG8kJ"}, {"extra_attributes": {"jMCZLUzh": {}, "MkveIoPF": {}, "Y7GeJAsa": {}}, "user_id": "HKxnZ8Md"}], "ticket_created_at": 36, "ticket_id": "xiTNhEGp"}, {"first_ticket_created_at": 48, "party_attributes": {"bN5LOHiM": {}, "eO16RBk3": {}, "3X1fbcH6": {}}, "party_id": "jQte8BUy", "party_members": [{"extra_attributes": {"2R5a2gk9": {}, "0BD3udvs": {}, "sNVTAkjn": {}}, "user_id": "yv3fSqGJ"}, {"extra_attributes": {"buySSDcP": {}, "mxisGsUd": {}, "XgHMnqEU": {}}, "user_id": "pEh8fLmJ"}, {"extra_attributes": {"oUPH1HSB": {}, "UETtsGm0": {}, "AEoaciXk": {}}, "user_id": "Hmjxvmet"}], "ticket_created_at": 47, "ticket_id": "1sG1HWIr"}]}, {"matching_parties": [{"first_ticket_created_at": 67, "party_attributes": {"h3Ty28Xy": {}, "hGoMgv3D": {}, "vbLYOGDL": {}}, "party_id": "PZXOBHM0", "party_members": [{"extra_attributes": {"3TgoL7pd": {}, "2Uc6NB9g": {}, "ivvRKuHZ": {}}, "user_id": "YDVH0dxf"}, {"extra_attributes": {"BnAUg82l": {}, "v1cWus6X": {}, "PcGtcnkF": {}}, "user_id": "boe2FsBm"}, {"extra_attributes": {"J0Wq8hJ4": {}, "3o6mZlO4": {}, "qbL6atHt": {}}, "user_id": "PXIMJ9Jz"}], "ticket_created_at": 19, "ticket_id": "njnrAq0v"}, {"first_ticket_created_at": 60, "party_attributes": {"BTp8dSfN": {}, "451q7G7S": {}, "pNlp4BBq": {}}, "party_id": "vbSH9Yzp", "party_members": [{"extra_attributes": {"digahLdB": {}, "DY0v0UYN": {}, "MB4e9ksG": {}}, "user_id": "QnxcxXxB"}, {"extra_attributes": {"7pmYzTcl": {}, "8PANz9l7": {}, "V8IsmNDS": {}}, "user_id": "Hvw0MpWH"}, {"extra_attributes": {"ECzIdazW": {}, "bIJRzjEk": {}, "gVP5SYIl": {}}, "user_id": "Ho1KNky3"}], "ticket_created_at": 26, "ticket_id": "IYijfbrp"}, {"first_ticket_created_at": 16, "party_attributes": {"npP6uIdI": {}, "ISVFrynx": {}, "OJN3ZvLX": {}}, "party_id": "I3syRrUc", "party_members": [{"extra_attributes": {"OFHDaeWe": {}, "CbG1x0WN": {}, "3tvbwAae": {}}, "user_id": "5FjySeGA"}, {"extra_attributes": {"EqybWwWA": {}, "MValj0Zv": {}, "5eEmzbHR": {}}, "user_id": "XKFJwgOP"}, {"extra_attributes": {"Wpmcdf19": {}, "i2plWjLl": {}, "K9dfouu0": {}}, "user_id": "xvJBPUU9"}], "ticket_created_at": 79, "ticket_id": "e86sBEhW"}]}], "namespace": "CSxyOOoZ", "party_attributes": {"wR5wJ7DY": {}, "7XhIva3X": {}, "dXQrTdUT": {}}, "party_id": "fy69IiGz", "queued_at": 4, "region": "u5xjgsD8", "server_name": "1iSMVPy1", "status": "GqfrClyX", "ticket_id": "sOLuJq6B", "ticket_ids": ["hATjvXLS", "BRLHmlnq", "dHUZvAU2"], "updated_at": "1985-10-11T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "HjUdEaJN"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID '9q639HXu' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 2, "userID": "saJu8nH9", "weight": 0.14034541715298843}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'Ue6rm0ig' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy 'DgSqID0j' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'DHw1oI22' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCannotMatch", "deployment": "Kpc7hr6e", "description": "Aek8kTRT", "findMatchTimeoutSeconds": 35, "joinable": true, "max_delay_ms": 96, "region_expansion_range_ms": 97, "region_expansion_rate_ms": 70, "region_latency_initial_range_ms": 4, "region_latency_max_ms": 64, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 37, "min": 15, "name": "8kQ06Moy"}, {"max": 51, "min": 77, "name": "8o4YynOF"}, {"max": 92, "min": 13, "name": "SS55oNW1"}], [{"max": 81, "min": 3, "name": "4TbyqGy1"}, {"max": 88, "min": 0, "name": "inJAwwmO"}, {"max": 15, "min": 86, "name": "iv6pjuCZ"}], [{"max": 68, "min": 8, "name": "glRNSdtt"}, {"max": 61, "min": 10, "name": "IwGah1gh"}, {"max": 97, "min": 95, "name": "CIrQu8tI"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 52, "role_flexing_second": 95}, "maxNumber": 89, "minNumber": 80, "playerMaxNumber": 51, "playerMinNumber": 75}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 65, "min": 29, "name": "ky79cLG8"}, {"max": 13, "min": 18, "name": "nulqy3FB"}, {"max": 85, "min": 16, "name": "0d30z7Bs"}], [{"max": 31, "min": 87, "name": "IdzQ7LMS"}, {"max": 29, "min": 4, "name": "OZBEspnT"}, {"max": 81, "min": 43, "name": "jBVXQQtx"}], [{"max": 41, "min": 2, "name": "dEAiaOTV"}, {"max": 13, "min": 58, "name": "sN0IBBwM"}, {"max": 80, "min": 87, "name": "BtZeFmH1"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 91, "role_flexing_second": 27}, "duration": 68, "max_number": 61, "min_number": 60, "player_max_number": 71, "player_min_number": 41}, {"combination": {"alliances": [[{"max": 100, "min": 51, "name": "ObK45RQo"}, {"max": 23, "min": 93, "name": "s3CpJTJU"}, {"max": 74, "min": 50, "name": "iMTWsa0z"}], [{"max": 74, "min": 83, "name": "GaYcMUlE"}, {"max": 9, "min": 47, "name": "daBlYG7E"}, {"max": 20, "min": 91, "name": "8BBVHVTY"}], [{"max": 2, "min": 74, "name": "nZx1ik1W"}, {"max": 89, "min": 4, "name": "sHxDPnvy"}, {"max": 72, "min": 73, "name": "tpYVTgbE"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 90, "role_flexing_second": 69}, "duration": 75, "max_number": 62, "min_number": 73, "player_max_number": 13, "player_min_number": 5}, {"combination": {"alliances": [[{"max": 86, "min": 92, "name": "Rvndr1mY"}, {"max": 64, "min": 62, "name": "Wnz2p4MD"}, {"max": 32, "min": 14, "name": "jNSIpPdo"}], [{"max": 16, "min": 23, "name": "uXDHBZ0X"}, {"max": 47, "min": 76, "name": "eOBG3lWk"}, {"max": 83, "min": 17, "name": "2oj4qnde"}], [{"max": 68, "min": 88, "name": "7ELGG1Ve"}, {"max": 27, "min": 70, "name": "eKgJ6Bca"}, {"max": 16, "min": 7, "name": "LKMPr2eq"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 26, "role_flexing_second": 9}, "duration": 72, "max_number": 71, "min_number": 6, "player_max_number": 54, "player_min_number": 88}], "batch_size": 39, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 76, "flex_flat_step_range": 93, "flex_immunity_count": 35, "flex_range_max": 24, "flex_rate_ms": 64, "flex_step_max": 87, "force_authority_match": false, "initial_step_range": 69, "mmr_max": 52, "mmr_mean": 42, "mmr_min": 60, "mmr_std_dev": 100, "override_mmr_data": true, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexingRules": [{"attribute": "xacCDiwH", "criteria": "EvJhcIBR", "duration": 95, "reference": 0.951648245289587}, {"attribute": "URUt9HQJ", "criteria": "k3vunMEg", "duration": 50, "reference": 0.20742075639440016}, {"attribute": "SjcRPhEC", "criteria": "Mn2WoPBi", "duration": 73, "reference": 0.9226714844143262}], "match_options": {"options": [{"name": "z2nh9SGB", "type": "zIC378l1"}, {"name": "jf9SMDA3", "type": "y1mTbbNL"}, {"name": "ymGWAHmn", "type": "AqOjo251"}]}, "matchingRules": [{"attribute": "bumYYjSk", "criteria": "0dL2DwzH", "reference": 0.7034158805052052}, {"attribute": "x9zsXx5D", "criteria": "2EV8988g", "reference": 0.0674000572561757}, {"attribute": "9vqTx7DP", "criteria": "dZj6HCKM", "reference": 0.2041867339752529}], "sort_ticket": {"search_result": "distance", "ticket_queue": "none"}, "sort_tickets": [{"search_result": "random", "threshold": 71, "ticket_queue": "oldestTicketAge"}, {"search_result": "distance", "threshold": 45, "ticket_queue": "largestPartySize"}, {"search_result": "oldestTicketAge", "threshold": 3, "ticket_queue": "distance"}], "sub_game_modes": {}, "ticket_flexing_selection": "random", "ticket_flexing_selections": [{"selection": "oldest", "threshold": 55}, {"selection": "oldest", "threshold": 27}, {"selection": "oldest", "threshold": 2}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 36, "socialMatchmaking": true, "sub_gamemode_selection": "random", "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName '8rLiGakz' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'l8qL3r50' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'eCQTZqZh' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 40}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'rnDJ0u4D' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'U9sAboaj' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "lavTLtmz", "count": 35, "mmrMax": 0.5634177486192823, "mmrMean": 0.03881249170290724, "mmrMin": 0.9773267540551783, "mmrStdDev": 0.044366138014430345}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'iCMlOST5' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 91, "party_attributes": {"KOyNmYAX": {}, "g1qCtDaE": {}, "8t1X0go8": {}}, "party_id": "ndO8r8is", "party_members": [{"extra_attributes": {"H57lNe6y": {}, "qxUB75M2": {}, "Xn19Iw8O": {}}, "user_id": "Mfush7vq"}, {"extra_attributes": {"ODSk6wGg": {}, "M6gUTJA4": {}, "WZG69uiZ": {}}, "user_id": "Fx3tOUpf"}, {"extra_attributes": {"P8Dn2JiV": {}, "PJBhVBHn": {}, "bl1yX09x": {}}, "user_id": "0L9tWF95"}], "ticket_created_at": 59, "ticket_id": "w49QzMtS"}, {"first_ticket_created_at": 70, "party_attributes": {"7g59p5dD": {}, "fkodgdbo": {}, "cNbTjcCS": {}}, "party_id": "Z90v3A8r", "party_members": [{"extra_attributes": {"cqMhtv4f": {}, "xAvmG77l": {}, "yWCR2pEJ": {}}, "user_id": "XgYi0eaj"}, {"extra_attributes": {"4dOY0Zwu": {}, "cewYpYQg": {}, "vlhN3Yvn": {}}, "user_id": "jjkXto22"}, {"extra_attributes": {"cfuQU1C2": {}, "oyVGqj4G": {}, "WrMnkSgY": {}}, "user_id": "uM4PTnaH"}], "ticket_created_at": 34, "ticket_id": "PcRycTQO"}, {"first_ticket_created_at": 31, "party_attributes": {"CgPAlxTV": {}, "duUppoly": {}, "59yxcKhP": {}}, "party_id": "IgxNYcli", "party_members": [{"extra_attributes": {"8RQpsB70": {}, "XWT4A1rA": {}, "O1siweq0": {}}, "user_id": "BFSJmz4R"}, {"extra_attributes": {"TBlfb5p4": {}, "UlJvMnLy": {}, "IhBI5Oqg": {}}, "user_id": "M5ozpjq6"}, {"extra_attributes": {"lUJjdEA0": {}, "yVuj1n22": {}, "1Mkde7rB": {}}, "user_id": "JmrRP7kn"}], "ticket_created_at": 76, "ticket_id": "5hY6KI7d"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'ocwM6CeG' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 97}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'B3GowVR5' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName '1G7FQaUR' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'tVyh2dwo' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["Jnh1bKei", "2k5IVszd", "Qwazkk94"], "party_id": "WCYCze8g", "user_id": "S2JQ0szx"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'jgvoax2r' \
    --matchID 'bz8e2oiZ' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'CRaznrvq' \
    --matchID 'GiyB31TX' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'oQXdJ959' \
    --matchID '8SlB9JQE' \
    --namespace $AB_NAMESPACE \
    --userID 'MxbXZ61T' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'QKMvD7uu' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'Lw2xuG9T' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE