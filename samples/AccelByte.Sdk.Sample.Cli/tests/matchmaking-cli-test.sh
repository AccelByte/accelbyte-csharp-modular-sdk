#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '69' \
    --offset '100' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "wXPrL8mA", "description": "Y6WCqkHN", "find_match_timeout_seconds": 28, "game_mode": "W1VSUem4", "joinable": false, "max_delay_ms": 43, "region_expansion_range_ms": 6, "region_expansion_rate_ms": 48, "region_latency_initial_range_ms": 94, "region_latency_max_ms": 100, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 80, "min": 2, "name": "JNiwTc66"}, {"max": 53, "min": 39, "name": "ShhMRqiK"}, {"max": 78, "min": 99, "name": "KlKWC0Y8"}], [{"max": 96, "min": 94, "name": "DuvDjJUH"}, {"max": 87, "min": 56, "name": "f7lezVwe"}, {"max": 52, "min": 16, "name": "PDD0fhWM"}], [{"max": 44, "min": 26, "name": "KRK3Z4iY"}, {"max": 65, "min": 68, "name": "ggyMISAv"}, {"max": 21, "min": 93, "name": "MfNNGQ2U"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 52, "role_flexing_second": 80}, "max_number": 26, "min_number": 37, "player_max_number": 4, "player_min_number": 99}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 63, "min": 97, "name": "XoFtqAej"}, {"max": 52, "min": 35, "name": "m4JE95Xi"}, {"max": 73, "min": 65, "name": "JKYaYkTF"}], [{"max": 39, "min": 19, "name": "qLZU1E96"}, {"max": 2, "min": 40, "name": "vnLwzvNI"}, {"max": 71, "min": 56, "name": "NgpX8WUK"}], [{"max": 82, "min": 96, "name": "4c7eF6re"}, {"max": 19, "min": 48, "name": "Aq5A5IO0"}, {"max": 41, "min": 93, "name": "MTBmEpRH"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 28, "role_flexing_second": 1}, "duration": 30, "max_number": 20, "min_number": 78, "player_max_number": 66, "player_min_number": 2}, {"combination": {"alliances": [[{"max": 10, "min": 30, "name": "gGqjN492"}, {"max": 93, "min": 75, "name": "gnS9rCvw"}, {"max": 37, "min": 19, "name": "TUeNNTpc"}], [{"max": 57, "min": 68, "name": "Ho8QwMnt"}, {"max": 65, "min": 71, "name": "6BsD3HBS"}, {"max": 65, "min": 5, "name": "iWNvfE9h"}], [{"max": 72, "min": 87, "name": "GgRbC1Vn"}, {"max": 54, "min": 16, "name": "vjrJFYlc"}, {"max": 14, "min": 44, "name": "gsRQasdL"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 32, "role_flexing_second": 36}, "duration": 27, "max_number": 45, "min_number": 72, "player_max_number": 18, "player_min_number": 49}, {"combination": {"alliances": [[{"max": 100, "min": 33, "name": "mzFNqobJ"}, {"max": 78, "min": 4, "name": "OG2OlpX5"}, {"max": 4, "min": 57, "name": "SUCatu10"}], [{"max": 32, "min": 38, "name": "fLPnquI6"}, {"max": 85, "min": 34, "name": "hdKPqzQu"}, {"max": 66, "min": 64, "name": "twgY46Mx"}], [{"max": 17, "min": 40, "name": "9CHAEI4X"}, {"max": 39, "min": 11, "name": "fXpIa9Uc"}, {"max": 37, "min": 49, "name": "PT38odPv"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 96, "role_flexing_second": 33}, "duration": 19, "max_number": 58, "min_number": 91, "player_max_number": 1, "player_min_number": 29}], "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 93, "flex_flat_step_range": 94, "flex_immunity_count": 79, "flex_range_max": 12, "flex_rate_ms": 68, "flex_step_max": 43, "force_authority_match": false, "initial_step_range": 87, "mmr_max": 73, "mmr_mean": 43, "mmr_min": 84, "mmr_std_dev": 65, "override_mmr_data": true, "use_bucket_mmr": false, "use_flat_flex_step": false}, "flexing_rule": [{"attribute": "uXEonxZ6", "criteria": "HvOUffWi", "duration": 24, "reference": 0.483577028304246}, {"attribute": "R1EScxyW", "criteria": "fD65CnhC", "duration": 79, "reference": 0.36326360737727514}, {"attribute": "51qd3jtE", "criteria": "18NHi918", "duration": 18, "reference": 0.9277895903677486}], "match_options": {"options": [{"name": "bPniW1uB", "type": "t2NokM5T"}, {"name": "Mf7EqHdk", "type": "0SMl8TsL"}, {"name": "3H727Kmu", "type": "IIsCeoUu"}]}, "matching_rule": [{"attribute": "LzDRQhd2", "criteria": "2rtTtURu", "reference": 0.31867648076145694}, {"attribute": "tvuSOKIa", "criteria": "ZoxPH7CL", "reference": 0.3261325992461601}, {"attribute": "kUTQMd9l", "criteria": "aDAnkF9S", "reference": 0.48985993079939927}], "rebalance_enable": true, "sub_game_modes": {"4ULTUSaT": {"alliance": {"combination": {"alliances": [[{"max": 22, "min": 38, "name": "JsCDsJWc"}, {"max": 76, "min": 28, "name": "mIp1jANl"}, {"max": 92, "min": 61, "name": "R690Bcmu"}], [{"max": 91, "min": 84, "name": "evy5vHNo"}, {"max": 3, "min": 51, "name": "65PGibi3"}, {"max": 96, "min": 87, "name": "NMxQl6zy"}], [{"max": 90, "min": 37, "name": "0p4DQr3K"}, {"max": 83, "min": 67, "name": "2AhNgGNx"}, {"max": 97, "min": 87, "name": "PRmqvEmV"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 58, "role_flexing_second": 68}, "max_number": 0, "min_number": 17, "player_max_number": 58, "player_min_number": 94}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 13, "min": 97, "name": "KOzYZ5QI"}, {"max": 81, "min": 14, "name": "0U2MRKu4"}, {"max": 53, "min": 54, "name": "H0UHG1iX"}], [{"max": 55, "min": 77, "name": "0t21Rmhc"}, {"max": 26, "min": 2, "name": "ZBP7jDuv"}, {"max": 95, "min": 7, "name": "Sd2q2a1Q"}], [{"max": 85, "min": 28, "name": "X13rNLgj"}, {"max": 57, "min": 92, "name": "15fRL7Cd"}, {"max": 70, "min": 85, "name": "Qnv13jpv"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 66, "role_flexing_second": 90}, "duration": 23, "max_number": 63, "min_number": 5, "player_max_number": 28, "player_min_number": 60}, {"combination": {"alliances": [[{"max": 43, "min": 16, "name": "2M22xtBY"}, {"max": 73, "min": 68, "name": "WpOpbTYn"}, {"max": 7, "min": 8, "name": "UIDMu6yO"}], [{"max": 64, "min": 2, "name": "BEoRKMuF"}, {"max": 48, "min": 89, "name": "jj2DRzTt"}, {"max": 14, "min": 69, "name": "Pvlf55FA"}], [{"max": 49, "min": 1, "name": "XkYNAbbi"}, {"max": 26, "min": 35, "name": "EQNzdqWs"}, {"max": 55, "min": 37, "name": "zcgIbmCl"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 17, "role_flexing_second": 9}, "duration": 95, "max_number": 53, "min_number": 36, "player_max_number": 93, "player_min_number": 1}, {"combination": {"alliances": [[{"max": 16, "min": 80, "name": "lDT8F7rw"}, {"max": 3, "min": 69, "name": "02IVraZo"}, {"max": 5, "min": 43, "name": "9aBU8DGr"}], [{"max": 39, "min": 50, "name": "6HVQaEUE"}, {"max": 92, "min": 7, "name": "bJnpMvZC"}, {"max": 81, "min": 98, "name": "GcV6MqnA"}], [{"max": 12, "min": 78, "name": "GWQAMnrx"}, {"max": 91, "min": 100, "name": "uDdREXdn"}, {"max": 78, "min": 78, "name": "GJ8uuNwt"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 98, "role_flexing_second": 20}, "duration": 34, "max_number": 47, "min_number": 100, "player_max_number": 92, "player_min_number": 75}], "name": "YF2OaNtP"}, "mTeqGM8T": {"alliance": {"combination": {"alliances": [[{"max": 4, "min": 20, "name": "OjJ43eLS"}, {"max": 75, "min": 51, "name": "zERLzSUb"}, {"max": 64, "min": 0, "name": "22T0kEmC"}], [{"max": 98, "min": 50, "name": "Sws7OQLs"}, {"max": 42, "min": 32, "name": "UQG26uFf"}, {"max": 0, "min": 18, "name": "OBMb0Ocj"}], [{"max": 65, "min": 24, "name": "0TpxhLfW"}, {"max": 78, "min": 53, "name": "y2UEks98"}, {"max": 32, "min": 84, "name": "QIgeQHtd"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 3, "role_flexing_second": 99}, "max_number": 57, "min_number": 90, "player_max_number": 46, "player_min_number": 1}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 31, "min": 49, "name": "nQzPnCYY"}, {"max": 13, "min": 55, "name": "U5qPvnkT"}, {"max": 18, "min": 6, "name": "Nt0bwany"}], [{"max": 32, "min": 26, "name": "ZnuRdcE5"}, {"max": 20, "min": 100, "name": "gVkrkACS"}, {"max": 75, "min": 19, "name": "vlMrxqe8"}], [{"max": 66, "min": 84, "name": "Br4HNpve"}, {"max": 61, "min": 7, "name": "DxmJvgtx"}, {"max": 8, "min": 3, "name": "31hXNmou"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 78, "role_flexing_second": 78}, "duration": 7, "max_number": 17, "min_number": 49, "player_max_number": 20, "player_min_number": 50}, {"combination": {"alliances": [[{"max": 64, "min": 81, "name": "vJmSWyxR"}, {"max": 38, "min": 20, "name": "JdJAIqwg"}, {"max": 62, "min": 90, "name": "gvURJTHK"}], [{"max": 10, "min": 89, "name": "kOsFA9pZ"}, {"max": 84, "min": 28, "name": "0EWJmEwv"}, {"max": 83, "min": 87, "name": "4jeYtDTc"}], [{"max": 53, "min": 9, "name": "bjfgGV2H"}, {"max": 25, "min": 40, "name": "lsAldxtA"}, {"max": 59, "min": 30, "name": "sMhwWTql"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 25, "role_flexing_second": 41}, "duration": 95, "max_number": 98, "min_number": 29, "player_max_number": 89, "player_min_number": 54}, {"combination": {"alliances": [[{"max": 38, "min": 87, "name": "UlmNghkj"}, {"max": 60, "min": 59, "name": "aqufSgQF"}, {"max": 86, "min": 30, "name": "dvBaDhMi"}], [{"max": 6, "min": 26, "name": "61RK64sd"}, {"max": 34, "min": 56, "name": "cjNpBolD"}, {"max": 95, "min": 35, "name": "RH6ClvOw"}], [{"max": 39, "min": 95, "name": "jD5JSlHF"}, {"max": 53, "min": 14, "name": "1GQzYAir"}, {"max": 54, "min": 53, "name": "yqauZfhv"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 0, "role_flexing_second": 62}, "duration": 87, "max_number": 21, "min_number": 100, "player_max_number": 21, "player_min_number": 10}], "name": "xOMeofOm"}, "sgIuMzO7": {"alliance": {"combination": {"alliances": [[{"max": 0, "min": 32, "name": "xCiOAjLO"}, {"max": 52, "min": 10, "name": "goYpxhdj"}, {"max": 39, "min": 69, "name": "4MfpEq5w"}], [{"max": 93, "min": 31, "name": "It3RjNtd"}, {"max": 74, "min": 10, "name": "6UPHEg7k"}, {"max": 32, "min": 5, "name": "oUOzWXrH"}], [{"max": 96, "min": 99, "name": "ShwKDq8X"}, {"max": 54, "min": 70, "name": "uoG602A4"}, {"max": 17, "min": 57, "name": "8y9D1svq"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 39, "role_flexing_second": 63}, "max_number": 91, "min_number": 74, "player_max_number": 15, "player_min_number": 17}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 71, "min": 71, "name": "BzhtTQCS"}, {"max": 25, "min": 3, "name": "csJBHZ7P"}, {"max": 96, "min": 7, "name": "jiATflQB"}], [{"max": 62, "min": 74, "name": "2bxno0xI"}, {"max": 1, "min": 61, "name": "llbKOMos"}, {"max": 35, "min": 69, "name": "jssJ9MGU"}], [{"max": 25, "min": 43, "name": "d8RF4qso"}, {"max": 18, "min": 0, "name": "2VehvHPj"}, {"max": 32, "min": 54, "name": "llqtIrP1"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 77, "role_flexing_second": 63}, "duration": 41, "max_number": 18, "min_number": 89, "player_max_number": 66, "player_min_number": 68}, {"combination": {"alliances": [[{"max": 64, "min": 25, "name": "Hbdnpn7y"}, {"max": 32, "min": 8, "name": "0ZGZKCbl"}, {"max": 86, "min": 49, "name": "ZpJyr4Pj"}], [{"max": 65, "min": 90, "name": "fAJk91Y0"}, {"max": 85, "min": 70, "name": "tHMotrZD"}, {"max": 63, "min": 37, "name": "cJzWLDQs"}], [{"max": 15, "min": 6, "name": "60sz9tLp"}, {"max": 22, "min": 7, "name": "IGSkXZ6j"}, {"max": 29, "min": 0, "name": "HBHp7OxP"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 18, "role_flexing_second": 59}, "duration": 0, "max_number": 71, "min_number": 3, "player_max_number": 44, "player_min_number": 17}, {"combination": {"alliances": [[{"max": 95, "min": 28, "name": "RbQcNaW8"}, {"max": 99, "min": 15, "name": "EVCq3uu1"}, {"max": 50, "min": 11, "name": "3w1ylU4M"}], [{"max": 92, "min": 50, "name": "wLdmNUbV"}, {"max": 37, "min": 0, "name": "d0aF1FL8"}, {"max": 10, "min": 35, "name": "x5tPZi7u"}], [{"max": 22, "min": 57, "name": "Y8Ick59t"}, {"max": 89, "min": 95, "name": "n1pw6Euh"}, {"max": 63, "min": 42, "name": "rHyQjrOV"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 23, "role_flexing_second": 63}, "duration": 61, "max_number": 87, "min_number": 58, "player_max_number": 37, "player_min_number": 3}], "name": "v5UZrs7B"}}, "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 32, "social_matchmaking": false, "ticket_observability_enable": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'Q5W356Hw' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'MuAOqUUr' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "Rt8lZiSf", "players": [{"results": [{"attribute": "HJsbklsa", "value": 0.6950701013676566}, {"attribute": "BeWMPU51", "value": 0.2165922073173091}, {"attribute": "vTrxlBNb", "value": 0.07657247907659726}], "user_id": "2H3PzxnB"}, {"results": [{"attribute": "gufM94V0", "value": 0.15046522688011144}, {"attribute": "SknQ9mQV", "value": 0.13456651248862694}, {"attribute": "4DZgsHNO", "value": 0.6672471162992504}], "user_id": "GRa2OywO"}, {"results": [{"attribute": "Td9adIhb", "value": 0.3065624734421326}, {"attribute": "FxwBAVJZ", "value": 0.6454181631088691}, {"attribute": "OdPEJuLr", "value": 0.7686312677152971}], "user_id": "4GNdVJ4N"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "YdzxRkRE"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "ke2guUaR", "client_version": "aNaSbaXb", "deployment": "ugVgjHPf", "error_code": 83, "error_message": "arU9fpyN", "game_mode": "aozq1KBq", "is_mock": "OjTPbxrA", "joinable": false, "match_id": "1UTXaLpK", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 42, "party_attributes": {"aNUFgZbL": {}, "ly91lQbG": {}, "KMPlHOft": {}}, "party_id": "JP9jAD0a", "party_members": [{"extra_attributes": {"a8tOXNEV": {}, "LCXhnQOw": {}, "Pxfjn0U3": {}}, "user_id": "rYBvK8iZ"}, {"extra_attributes": {"95mKIxq1": {}, "Ark1G5QE": {}, "xJBgP87Q": {}}, "user_id": "OYS35ky9"}, {"extra_attributes": {"Nkji27ZH": {}, "wlPshhIo": {}, "6EfvgxWL": {}}, "user_id": "GJBWwgVV"}], "ticket_created_at": 12, "ticket_id": "trRn2TBs"}, {"first_ticket_created_at": 55, "party_attributes": {"fe7O8a1R": {}, "qj4zqCWK": {}, "JN5pyflr": {}}, "party_id": "JsFSdDTM", "party_members": [{"extra_attributes": {"jcwzFYqa": {}, "6719XwnU": {}, "MdJQIiLz": {}}, "user_id": "HRHnvXyp"}, {"extra_attributes": {"YMbYhKMS": {}, "2WRjaFTc": {}, "hbDWuTMR": {}}, "user_id": "nlAFJdEn"}, {"extra_attributes": {"UQfRPux9": {}, "VpMk9eQX": {}, "oFyuiYmI": {}}, "user_id": "eAxzuVEq"}], "ticket_created_at": 59, "ticket_id": "nIQHy5fU"}, {"first_ticket_created_at": 66, "party_attributes": {"KbDEgJp3": {}, "nXrvhGPG": {}, "pyrfrIL6": {}}, "party_id": "S97CJT8c", "party_members": [{"extra_attributes": {"TSBFdXe3": {}, "nHo5Un0c": {}, "kDsWDoOu": {}}, "user_id": "uBeekRQY"}, {"extra_attributes": {"OoI2jTAa": {}, "foDKaVn7": {}, "mLHBjeKU": {}}, "user_id": "6r0hJ2VD"}, {"extra_attributes": {"W3HGEN06": {}, "10Xtc9Fh": {}, "m4IfdQ8z": {}}, "user_id": "d7f5Lx3j"}], "ticket_created_at": 80, "ticket_id": "mtr3fcD1"}]}, {"matching_parties": [{"first_ticket_created_at": 81, "party_attributes": {"RGMVv6lu": {}, "oRLBBevC": {}, "igsBqCbe": {}}, "party_id": "p6mlav2G", "party_members": [{"extra_attributes": {"ePa6aeBx": {}, "r5JyxOQ1": {}, "CoAoVc83": {}}, "user_id": "IzKoiJE7"}, {"extra_attributes": {"7BV6iYVP": {}, "d0pUMlxL": {}, "MF8ieW8p": {}}, "user_id": "fBhsZez9"}, {"extra_attributes": {"h7y0WS7W": {}, "a7vprTA3": {}, "SxBqDbJC": {}}, "user_id": "fl02mfGs"}], "ticket_created_at": 43, "ticket_id": "hV3yIR76"}, {"first_ticket_created_at": 44, "party_attributes": {"rv97wLEp": {}, "t0RO0WJZ": {}, "3cagChiP": {}}, "party_id": "ZjVpEmt4", "party_members": [{"extra_attributes": {"FA6SX3HW": {}, "mcikG1Up": {}, "2PfR8QDQ": {}}, "user_id": "1nREfmLf"}, {"extra_attributes": {"jIJ1W2cX": {}, "w7L8taXi": {}, "RF5S9jvq": {}}, "user_id": "8ZZktZfq"}, {"extra_attributes": {"gGeshpQi": {}, "5vZ7qoJQ": {}, "qoEvcJJD": {}}, "user_id": "kWGIxqOP"}], "ticket_created_at": 1, "ticket_id": "GOvYUkUj"}, {"first_ticket_created_at": 22, "party_attributes": {"nUidscZP": {}, "7Rc3KzI7": {}, "iEmoahh9": {}}, "party_id": "xql4e1wQ", "party_members": [{"extra_attributes": {"elLSq79J": {}, "GshCg3vv": {}, "yifPxDB3": {}}, "user_id": "SVMsykS7"}, {"extra_attributes": {"hhpMEYsX": {}, "16sm2LZk": {}, "vUvJv6Ka": {}}, "user_id": "EsbchfFO"}, {"extra_attributes": {"kFf4NBSS": {}, "Q0EKUUS7": {}, "4wxdmdNX": {}}, "user_id": "MlqjWmbt"}], "ticket_created_at": 18, "ticket_id": "mqVOHh70"}]}, {"matching_parties": [{"first_ticket_created_at": 5, "party_attributes": {"rak6UEsI": {}, "62fCbcMD": {}, "MTDbp03W": {}}, "party_id": "hHOf5vKB", "party_members": [{"extra_attributes": {"H22vOKpj": {}, "U5RTqTej": {}, "J78n2Zts": {}}, "user_id": "9Ij2HFNL"}, {"extra_attributes": {"dQoCYoT4": {}, "VjDabjrO": {}, "wkKdgQ5O": {}}, "user_id": "VVaJvvZL"}, {"extra_attributes": {"c31Fst51": {}, "IlMUWF7H": {}, "07ekOmju": {}}, "user_id": "exrR2PrP"}], "ticket_created_at": 93, "ticket_id": "iBDs9Ero"}, {"first_ticket_created_at": 54, "party_attributes": {"PtIUu47B": {}, "ROL3tLYk": {}, "NHvOaNGq": {}}, "party_id": "a8Ge9XR4", "party_members": [{"extra_attributes": {"6frbzyFC": {}, "q6nVQ4FN": {}, "4yaNM2y3": {}}, "user_id": "c8jGiYAR"}, {"extra_attributes": {"9DH8hKlM": {}, "xkD6tllF": {}, "Tt6ZpdOR": {}}, "user_id": "wnJgTVwZ"}, {"extra_attributes": {"GZP05sAR": {}, "F98MZzyR": {}, "mHchE8hA": {}}, "user_id": "LEIniLPE"}], "ticket_created_at": 39, "ticket_id": "7D2LqwKo"}, {"first_ticket_created_at": 64, "party_attributes": {"rOHknOMW": {}, "yAYiD4cO": {}, "KRsxT4t2": {}}, "party_id": "ksvsZQfd", "party_members": [{"extra_attributes": {"vkaQTm6n": {}, "5WNUsBUj": {}, "Tr1rHAsy": {}}, "user_id": "SWqiI2Qy"}, {"extra_attributes": {"xondPxzb": {}, "Sxt8jAcX": {}, "Y5cm86M8": {}}, "user_id": "z0JQDAvW"}, {"extra_attributes": {"yegy3FRw": {}, "yyORtw5n": {}, "BUtDpGff": {}}, "user_id": "bhezjDij"}], "ticket_created_at": 31, "ticket_id": "ER9XRaM4"}]}], "namespace": "kyjZTv82", "party_attributes": {"HgfOG4oU": {}, "WalQVfBz": {}, "SmaswbYo": {}}, "party_id": "CasTMrp4", "queued_at": 79, "region": "UmzvoQ4T", "server_name": "QdXZXk32", "status": "v4EQfIPt", "ticket_id": "kmxnv4su", "ticket_ids": ["ijbRsWBg", "cvmnqxlz", "yM2Gfvc6"], "updated_at": "1985-06-08T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "FSLJQNsk"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'qUoLBMHx' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 70, "userID": "XHYw28pc", "weight": 0.248405276127593}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'xNFirENY' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'Rfr3awJI' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName '0NoYl6Td' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "gZTOG9br", "description": "g7V5DrVK", "findMatchTimeoutSeconds": 43, "joinable": true, "max_delay_ms": 3, "region_expansion_range_ms": 9, "region_expansion_rate_ms": 66, "region_latency_initial_range_ms": 73, "region_latency_max_ms": 8, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 93, "min": 28, "name": "Y9sXdPiP"}, {"max": 95, "min": 20, "name": "WTd5zEUn"}, {"max": 5, "min": 84, "name": "zvSzu3VI"}], [{"max": 45, "min": 63, "name": "5Ne5VAR7"}, {"max": 16, "min": 48, "name": "zF62Yllb"}, {"max": 22, "min": 35, "name": "iZQwutNu"}], [{"max": 82, "min": 77, "name": "Se4tXMP7"}, {"max": 61, "min": 36, "name": "5qPzGHE7"}, {"max": 85, "min": 51, "name": "2wbn7FL1"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 53, "role_flexing_second": 47}, "maxNumber": 39, "minNumber": 100, "playerMaxNumber": 25, "playerMinNumber": 31}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 74, "min": 76, "name": "tmx5Pwvw"}, {"max": 63, "min": 66, "name": "b9z5fsZ0"}, {"max": 57, "min": 79, "name": "HGD6q2Cq"}], [{"max": 18, "min": 36, "name": "sBT9xOoV"}, {"max": 4, "min": 79, "name": "S5tRxKrU"}, {"max": 50, "min": 53, "name": "ACGen51C"}], [{"max": 70, "min": 77, "name": "n0V9S85c"}, {"max": 22, "min": 28, "name": "orqHCwXt"}, {"max": 81, "min": 78, "name": "66NfT0Wh"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 53, "role_flexing_second": 98}, "duration": 28, "max_number": 9, "min_number": 16, "player_max_number": 55, "player_min_number": 84}, {"combination": {"alliances": [[{"max": 33, "min": 94, "name": "7ciTxAGN"}, {"max": 46, "min": 73, "name": "oUdNHBJi"}, {"max": 55, "min": 37, "name": "n6mczIDG"}], [{"max": 36, "min": 15, "name": "FjmccOvp"}, {"max": 90, "min": 35, "name": "fUOwHdtL"}, {"max": 59, "min": 7, "name": "axLpqRae"}], [{"max": 71, "min": 20, "name": "U6SAInLj"}, {"max": 37, "min": 16, "name": "JN7ByJWv"}, {"max": 15, "min": 72, "name": "rRTuTUcb"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 6, "role_flexing_second": 80}, "duration": 37, "max_number": 1, "min_number": 44, "player_max_number": 2, "player_min_number": 56}, {"combination": {"alliances": [[{"max": 77, "min": 74, "name": "lvDbHlkm"}, {"max": 65, "min": 56, "name": "ceJuSiiY"}, {"max": 57, "min": 89, "name": "IqfMBDyo"}], [{"max": 83, "min": 34, "name": "cfCBF7wE"}, {"max": 12, "min": 78, "name": "ENIrdKcY"}, {"max": 11, "min": 66, "name": "4uduBINk"}], [{"max": 70, "min": 75, "name": "bp2jnLSD"}, {"max": 49, "min": 42, "name": "EdPNNpvA"}, {"max": 67, "min": 64, "name": "VRbNGAea"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 43, "role_flexing_second": 19}, "duration": 85, "max_number": 20, "min_number": 40, "player_max_number": 74, "player_min_number": 5}], "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 28, "flex_flat_step_range": 6, "flex_immunity_count": 12, "flex_range_max": 3, "flex_rate_ms": 1, "flex_step_max": 3, "force_authority_match": false, "initial_step_range": 1, "mmr_max": 41, "mmr_mean": 4, "mmr_min": 53, "mmr_std_dev": 74, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "wS6CBEn0", "criteria": "13lIDxGf", "duration": 39, "reference": 0.6208101451510327}, {"attribute": "SWIivawR", "criteria": "0qU7p2K8", "duration": 82, "reference": 0.04547070528180752}, {"attribute": "zWPQy0yq", "criteria": "v1lzwdUa", "duration": 17, "reference": 0.01802527934134368}], "match_options": {"options": [{"name": "Vxs5VzXZ", "type": "WOIthuuv"}, {"name": "w0GcAhgB", "type": "IixEzvCK"}, {"name": "xOQMCzKN", "type": "rIpVQIDH"}]}, "matchingRules": [{"attribute": "tOjBQxIg", "criteria": "BP78YBfS", "reference": 0.1660801676343744}, {"attribute": "0aelejnt", "criteria": "2lTksQRw", "reference": 0.37348934532504796}, {"attribute": "xLl3Skyo", "criteria": "3i0pxyKP", "reference": 0.13942126993506676}], "sub_game_modes": {}, "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 28, "socialMatchmaking": false, "ticket_observability_enable": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'guHG0tYn' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'Qiu9hb9W' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'rZyedvJA' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 74}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'BgDIvYnJ' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'sVllZX6c' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "Xixt08LW", "count": 67, "mmrMax": 0.8866579981427507, "mmrMean": 0.7589644284663347, "mmrMin": 0.6873154786872195, "mmrStdDev": 0.4742350131038735}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'ay5jYdXR' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 17, "party_attributes": {"NBSbZxuL": {}, "nRm0NTc3": {}, "pxqhR5NW": {}}, "party_id": "fHBK0FrU", "party_members": [{"extra_attributes": {"bWtzGTwN": {}, "9D4WWElW": {}, "NyZNBbbd": {}}, "user_id": "UZRIvWx2"}, {"extra_attributes": {"cB8xvtAM": {}, "kdVvYkaX": {}, "TBEV2kMG": {}}, "user_id": "kkF1NPU8"}, {"extra_attributes": {"vH5MhqHT": {}, "6dBPoxIF": {}, "Svt5PrOo": {}}, "user_id": "kLv8Tjpe"}], "ticket_created_at": 48, "ticket_id": "gGMv9Or2"}, {"first_ticket_created_at": 70, "party_attributes": {"iJ5Dt0xk": {}, "taP3ObR7": {}, "flYrrews": {}}, "party_id": "DZP3V7t3", "party_members": [{"extra_attributes": {"wtKpxu5b": {}, "GSyI18rT": {}, "tPum1SKf": {}}, "user_id": "V30rGY8D"}, {"extra_attributes": {"BjLwaeYh": {}, "0OmNxUtD": {}, "bZDpYJrs": {}}, "user_id": "y0xdVyTY"}, {"extra_attributes": {"SqLjJ5sg": {}, "LdK6TSSY": {}, "Uq0ewGTr": {}}, "user_id": "1KdjhZXf"}], "ticket_created_at": 36, "ticket_id": "kFWmTt59"}, {"first_ticket_created_at": 83, "party_attributes": {"PwGJ7xft": {}, "l0Q7CBAh": {}, "KghLJ8dM": {}}, "party_id": "RtTXimrG", "party_members": [{"extra_attributes": {"yGX3HSY1": {}, "eUb0tueg": {}, "SCPIJJf2": {}}, "user_id": "OA91vSFw"}, {"extra_attributes": {"PjheNb1R": {}, "qRDNkd02": {}, "pfxSIFoc": {}}, "user_id": "Rc6s1CBY"}, {"extra_attributes": {"EsiHI6lY": {}, "EPKs7lap": {}, "YtAl9k3F": {}}, "user_id": "1yhHKhC7"}], "ticket_created_at": 0, "ticket_id": "AClQRysr"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'HCE6Rvjo' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 30}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'eW2TO0Is' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'EFkcRSKH' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'uymcNK6E' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["pPKEYWo4", "mdUx5THL", "9aIRDSvb"], "party_id": "nbTo8Zat", "user_id": "2RU9IH2N"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'dU2DoFr6' \
    --matchID 'ekw68pTo' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'ApLDi3ql' \
    --matchID 'dIzJvbzM' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName '7x01HiWX' \
    --matchID 'txDSOSQq' \
    --namespace $AB_NAMESPACE \
    --userID 'SiIyCuIR' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'kov2AH3Q' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName '8sluXHlR' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE