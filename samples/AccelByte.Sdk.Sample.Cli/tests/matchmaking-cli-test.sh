#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '100' \
    --offset '55' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatch", "deployment": "xIFbxNqv", "description": "gOS7rmbN", "find_match_timeout_seconds": 53, "game_mode": "tKA2W8Bn", "joinable": false, "max_delay_ms": 33, "region_expansion_range_ms": 89, "region_expansion_rate_ms": 33, "region_latency_initial_range_ms": 89, "region_latency_max_ms": 1, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 18, "min": 2, "name": "6xUWRqVm"}, {"max": 9, "min": 31, "name": "6GsWSLpy"}, {"max": 1, "min": 6, "name": "OykA30QP"}], [{"max": 16, "min": 18, "name": "yaJ4gHwu"}, {"max": 20, "min": 100, "name": "dgvTyHMB"}, {"max": 62, "min": 89, "name": "1YGlnx7G"}], [{"max": 55, "min": 56, "name": "hGNsQ5yQ"}, {"max": 54, "min": 8, "name": "uHsQjJ2S"}, {"max": 34, "min": 7, "name": "yXXqLU2y"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 2, "role_flexing_second": 56}, "max_number": 85, "min_number": 54, "player_max_number": 70, "player_min_number": 85}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 49, "min": 1, "name": "YWBWnOVG"}, {"max": 96, "min": 51, "name": "tAgkhVQU"}, {"max": 69, "min": 44, "name": "G3E3ohNA"}], [{"max": 81, "min": 30, "name": "PgeihZKL"}, {"max": 67, "min": 99, "name": "JTJOpERU"}, {"max": 100, "min": 35, "name": "4BucUUFI"}], [{"max": 50, "min": 29, "name": "in47uxZ6"}, {"max": 100, "min": 47, "name": "jPMSOBMM"}, {"max": 63, "min": 19, "name": "8Dl93PW5"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 18, "role_flexing_second": 53}, "duration": 59, "max_number": 29, "min_number": 69, "player_max_number": 13, "player_min_number": 55}, {"combination": {"alliances": [[{"max": 32, "min": 22, "name": "jEk6bNIw"}, {"max": 71, "min": 15, "name": "oAhptEyF"}, {"max": 60, "min": 25, "name": "l8REpUTZ"}], [{"max": 23, "min": 80, "name": "ZbNXdct6"}, {"max": 46, "min": 99, "name": "YnTTAU7z"}, {"max": 78, "min": 41, "name": "CZVVs6R5"}], [{"max": 84, "min": 51, "name": "TRzdLAl4"}, {"max": 68, "min": 55, "name": "tvEm5ZQJ"}, {"max": 92, "min": 22, "name": "6zP8JG9E"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 45, "role_flexing_second": 59}, "duration": 24, "max_number": 13, "min_number": 40, "player_max_number": 35, "player_min_number": 80}, {"combination": {"alliances": [[{"max": 64, "min": 37, "name": "OYMRy0vD"}, {"max": 59, "min": 22, "name": "V3m7H0b2"}, {"max": 12, "min": 21, "name": "q4LlZRpZ"}], [{"max": 93, "min": 86, "name": "pHebJOaR"}, {"max": 50, "min": 47, "name": "gS6MvbZA"}, {"max": 21, "min": 2, "name": "P8KdJ2BJ"}], [{"max": 43, "min": 80, "name": "VRZDylO7"}, {"max": 47, "min": 48, "name": "eev4i0Ad"}, {"max": 26, "min": 19, "name": "Zd3GDVy7"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 13, "role_flexing_second": 18}, "duration": 79, "max_number": 97, "min_number": 8, "player_max_number": 17, "player_min_number": 93}], "batch_size": 72, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 67, "flex_flat_step_range": 13, "flex_immunity_count": 79, "flex_range_max": 53, "flex_rate_ms": 86, "flex_step_max": 91, "force_authority_match": false, "initial_step_range": 44, "mmr_max": 38, "mmr_mean": 11, "mmr_min": 20, "mmr_std_dev": 44, "override_mmr_data": true, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "Rn2UcTCS", "criteria": "Q7zsucmz", "duration": 92, "reference": 0.3045785221225633}, {"attribute": "n5TdegJP", "criteria": "hrW4lM8k", "duration": 70, "reference": 0.08719152798602237}, {"attribute": "ws1X7l7J", "criteria": "M1PtWvmi", "duration": 6, "reference": 0.054896444457197546}], "match_options": {"options": [{"name": "RUGeYXDj", "type": "JVe9qrXD"}, {"name": "S8jsxi2f", "type": "ojZ3rZTP"}, {"name": "L8a6JCsI", "type": "CMF8syvZ"}]}, "matching_rule": [{"attribute": "GUWydp5K", "criteria": "nindyMA7", "reference": 0.4495798465156985}, {"attribute": "FQC7n9yw", "criteria": "3zYAWnnu", "reference": 0.13354161284041643}, {"attribute": "hQoX0uOl", "criteria": "VVtv0GMc", "reference": 0.3247756837801723}], "rebalance_enable": false, "sort_ticket": {"search_result": "RyMUHJvs", "ticket_queue": "TWgtC1Di"}, "sort_tickets": [{"search_result": "fakbI6in", "threshold": 17, "ticket_queue": "KisIftcu"}, {"search_result": "mQSfJ7wH", "threshold": 25, "ticket_queue": "jo6WxDRF"}, {"search_result": "yt96dSFs", "threshold": 99, "ticket_queue": "T7gGcudW"}], "sub_game_modes": {"ZFIxQk64": {"alliance": {"combination": {"alliances": [[{"max": 43, "min": 62, "name": "3TUfsFaO"}, {"max": 3, "min": 31, "name": "uG9621Mb"}, {"max": 62, "min": 80, "name": "Gs57tpZi"}], [{"max": 91, "min": 22, "name": "BA2xT68V"}, {"max": 66, "min": 95, "name": "YXj729Du"}, {"max": 96, "min": 16, "name": "fUo4w0Rg"}], [{"max": 11, "min": 91, "name": "P1ZoohNC"}, {"max": 11, "min": 10, "name": "JhUK5PGF"}, {"max": 90, "min": 42, "name": "L28C0Kf3"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 50, "role_flexing_second": 59}, "max_number": 69, "min_number": 56, "player_max_number": 71, "player_min_number": 4}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 68, "min": 96, "name": "v63VBZKx"}, {"max": 53, "min": 14, "name": "RVVPhnPl"}, {"max": 33, "min": 21, "name": "94W6p4UW"}], [{"max": 34, "min": 6, "name": "vPhpOvSZ"}, {"max": 22, "min": 0, "name": "C6xIkwiy"}, {"max": 30, "min": 66, "name": "3VbRQd5a"}], [{"max": 2, "min": 85, "name": "3OTkgdDk"}, {"max": 91, "min": 48, "name": "wlZjDQvn"}, {"max": 37, "min": 60, "name": "T3WXJClm"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 79}, "duration": 65, "max_number": 38, "min_number": 59, "player_max_number": 40, "player_min_number": 60}, {"combination": {"alliances": [[{"max": 29, "min": 95, "name": "7aVYi2d7"}, {"max": 20, "min": 37, "name": "kUkoyIS3"}, {"max": 11, "min": 91, "name": "Cdi5sJeN"}], [{"max": 19, "min": 77, "name": "hIxR53ZB"}, {"max": 36, "min": 12, "name": "uwlfgsPq"}, {"max": 99, "min": 93, "name": "EWtrEkyI"}], [{"max": 92, "min": 30, "name": "1l7K0vvt"}, {"max": 29, "min": 42, "name": "0XS7oxiy"}, {"max": 42, "min": 40, "name": "b2F57hAT"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 5, "role_flexing_second": 60}, "duration": 90, "max_number": 2, "min_number": 37, "player_max_number": 77, "player_min_number": 68}, {"combination": {"alliances": [[{"max": 25, "min": 75, "name": "rb2WJ7tv"}, {"max": 22, "min": 67, "name": "l70e6Hp6"}, {"max": 21, "min": 49, "name": "EtZOJnPa"}], [{"max": 19, "min": 14, "name": "LBwRvifx"}, {"max": 86, "min": 25, "name": "hS2fwo3k"}, {"max": 56, "min": 59, "name": "ZUgX8SAM"}], [{"max": 79, "min": 47, "name": "60DUq3HX"}, {"max": 74, "min": 11, "name": "upXraFYc"}, {"max": 100, "min": 80, "name": "KB64HMlQ"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 59, "role_flexing_second": 14}, "duration": 18, "max_number": 29, "min_number": 68, "player_max_number": 41, "player_min_number": 65}], "name": "jq1NiBVz"}, "J05T4ewG": {"alliance": {"combination": {"alliances": [[{"max": 77, "min": 26, "name": "azfNpONg"}, {"max": 56, "min": 57, "name": "nGQ0WLWO"}, {"max": 77, "min": 0, "name": "GrH4VApT"}], [{"max": 4, "min": 99, "name": "gjqGsnwD"}, {"max": 94, "min": 3, "name": "e7sYoShj"}, {"max": 56, "min": 60, "name": "InwmS3dK"}], [{"max": 92, "min": 98, "name": "sy9fXbrk"}, {"max": 64, "min": 98, "name": "CJtc8pW1"}, {"max": 24, "min": 71, "name": "JpU1oTnD"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 39, "role_flexing_second": 48}, "max_number": 66, "min_number": 9, "player_max_number": 73, "player_min_number": 13}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 68, "min": 50, "name": "An7RkDtt"}, {"max": 93, "min": 79, "name": "K13BiMRu"}, {"max": 55, "min": 90, "name": "Tp2QNSOB"}], [{"max": 19, "min": 49, "name": "iIecSfVu"}, {"max": 12, "min": 62, "name": "BmeSKBs3"}, {"max": 97, "min": 70, "name": "nZOUILEI"}], [{"max": 35, "min": 66, "name": "fDXhhN3A"}, {"max": 83, "min": 72, "name": "8tXRXuSk"}, {"max": 7, "min": 22, "name": "h7E9HFVt"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 63, "role_flexing_second": 66}, "duration": 43, "max_number": 4, "min_number": 82, "player_max_number": 57, "player_min_number": 99}, {"combination": {"alliances": [[{"max": 74, "min": 39, "name": "FlplSzG2"}, {"max": 59, "min": 29, "name": "0F7hPnHi"}, {"max": 39, "min": 25, "name": "sVuBahH1"}], [{"max": 62, "min": 94, "name": "42PDQKHz"}, {"max": 64, "min": 96, "name": "y4AU5avk"}, {"max": 83, "min": 68, "name": "Qp7ro4ER"}], [{"max": 4, "min": 7, "name": "rh573DmL"}, {"max": 14, "min": 15, "name": "esHOPaDw"}, {"max": 77, "min": 36, "name": "XoMxSpk0"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 22, "role_flexing_second": 61}, "duration": 58, "max_number": 99, "min_number": 53, "player_max_number": 100, "player_min_number": 37}, {"combination": {"alliances": [[{"max": 61, "min": 28, "name": "E9G47bVG"}, {"max": 64, "min": 23, "name": "h1TzTeSk"}, {"max": 36, "min": 64, "name": "BjZ7Whag"}], [{"max": 63, "min": 33, "name": "iY3xoK14"}, {"max": 51, "min": 10, "name": "23KVQU1L"}, {"max": 16, "min": 48, "name": "k0WOiAft"}], [{"max": 41, "min": 58, "name": "j5UwoH9b"}, {"max": 35, "min": 20, "name": "QqTLKgtk"}, {"max": 91, "min": 66, "name": "G7jHrVdv"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 83, "role_flexing_second": 88}, "duration": 10, "max_number": 44, "min_number": 14, "player_max_number": 92, "player_min_number": 60}], "name": "Ku7gCiPK"}, "l0Hu2UYG": {"alliance": {"combination": {"alliances": [[{"max": 79, "min": 18, "name": "L5M7o3Xi"}, {"max": 78, "min": 73, "name": "JOOs2qOy"}, {"max": 90, "min": 13, "name": "nxWMzCi5"}], [{"max": 72, "min": 75, "name": "cuMA8ndl"}, {"max": 73, "min": 83, "name": "gNdkUzmf"}, {"max": 99, "min": 6, "name": "KVUv3np0"}], [{"max": 73, "min": 17, "name": "RbIpZI3W"}, {"max": 86, "min": 88, "name": "io3dbavx"}, {"max": 27, "min": 81, "name": "rW47ntWy"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 66, "role_flexing_second": 89}, "max_number": 85, "min_number": 79, "player_max_number": 7, "player_min_number": 49}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 8, "min": 22, "name": "obAap8qo"}, {"max": 91, "min": 95, "name": "kAbWExJD"}, {"max": 37, "min": 77, "name": "KODn3BwM"}], [{"max": 100, "min": 100, "name": "o1QwbgMr"}, {"max": 29, "min": 49, "name": "pxJQLHYv"}, {"max": 48, "min": 86, "name": "aSGNa95M"}], [{"max": 59, "min": 35, "name": "FX3gsLhT"}, {"max": 8, "min": 36, "name": "NA5727Pq"}, {"max": 96, "min": 92, "name": "TK87OKta"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 90, "role_flexing_second": 76}, "duration": 5, "max_number": 71, "min_number": 67, "player_max_number": 78, "player_min_number": 30}, {"combination": {"alliances": [[{"max": 100, "min": 2, "name": "LVgS33og"}, {"max": 27, "min": 13, "name": "6JzYKTc2"}, {"max": 25, "min": 68, "name": "TUY4UW80"}], [{"max": 35, "min": 42, "name": "UN83MJBy"}, {"max": 40, "min": 5, "name": "1fzLJl1i"}, {"max": 39, "min": 78, "name": "wf9ClrX3"}], [{"max": 16, "min": 95, "name": "QJmqrqOI"}, {"max": 30, "min": 56, "name": "ghI3apJ3"}, {"max": 41, "min": 88, "name": "e8jbKKJE"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 96, "role_flexing_second": 21}, "duration": 70, "max_number": 5, "min_number": 39, "player_max_number": 77, "player_min_number": 23}, {"combination": {"alliances": [[{"max": 99, "min": 66, "name": "LTYZvo9S"}, {"max": 21, "min": 91, "name": "I5Aow7mE"}, {"max": 84, "min": 67, "name": "5KEAC7lM"}], [{"max": 25, "min": 94, "name": "7n2TvF7u"}, {"max": 24, "min": 79, "name": "lYcxpFFN"}, {"max": 0, "min": 74, "name": "tJZlrCpL"}], [{"max": 61, "min": 22, "name": "lTz90glq"}, {"max": 23, "min": 52, "name": "idreVmtw"}, {"max": 25, "min": 96, "name": "hAE3PnXp"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 70, "role_flexing_second": 2}, "duration": 0, "max_number": 88, "min_number": 19, "player_max_number": 3, "player_min_number": 45}], "name": "pIdJpbvJ"}}, "ticket_flexing_selection": "qKl1437F", "ticket_flexing_selections": [{"selection": "rUhuBF89", "threshold": 72}, {"selection": "xZIDNujk", "threshold": 64}, {"selection": "UboFYwyF", "threshold": 51}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 81, "social_matchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'MjaemKmf' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'HAJLhAhe' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "noJTaOJh", "players": [{"results": [{"attribute": "WlKop9Xk", "value": 0.9580993053241587}, {"attribute": "m5qO8imX", "value": 0.7141975354960616}, {"attribute": "6HfXnzaw", "value": 0.30828964609302134}], "user_id": "ombSA2X0"}, {"results": [{"attribute": "9GzNNHBA", "value": 0.15072017332286347}, {"attribute": "KhKT0LcD", "value": 0.5421702443909941}, {"attribute": "M8mOYXeK", "value": 0.5838158462787232}], "user_id": "zwus3TXB"}, {"results": [{"attribute": "GzMEwvbb", "value": 0.6443118526357601}, {"attribute": "4T70DLFq", "value": 0.5522058863945517}, {"attribute": "DG9MEDc6", "value": 0.093492287482287}], "user_id": "aHhmaSDH"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "4Bs2QDU9"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "VKkv9bZ3", "client_version": "YQbcM9Vl", "deployment": "ySqSlOmt", "error_code": 41, "error_message": "ZCyYuwek", "game_mode": "Huc7vXXj", "is_mock": "j5YgQ01H", "joinable": true, "match_id": "AH3il3sK", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 66, "party_attributes": {"KAyCjKNv": {}, "sd2YXvhS": {}, "mTDZV4ae": {}}, "party_id": "N8hfj2R5", "party_members": [{"extra_attributes": {"UDWb7j8f": {}, "oBY3WRSB": {}, "5QzmeKYN": {}}, "user_id": "ZAIuu2ZD"}, {"extra_attributes": {"6SOl3y8N": {}, "XmNkm6JR": {}, "p7JkfSFK": {}}, "user_id": "Aq8O2kCB"}, {"extra_attributes": {"4TDo3stZ": {}, "fdIn720I": {}, "fBTPMMbU": {}}, "user_id": "0OihfCPB"}], "ticket_created_at": 55, "ticket_id": "FPwCrh2V"}, {"first_ticket_created_at": 26, "party_attributes": {"OsINd9hO": {}, "r5VzPaJ8": {}, "LudAfGD3": {}}, "party_id": "jpO4SHEV", "party_members": [{"extra_attributes": {"rAnxMjnB": {}, "dKekn0B6": {}, "YdluCZar": {}}, "user_id": "d8arplVz"}, {"extra_attributes": {"b6dvKia5": {}, "YwTLJWEF": {}, "Hka6PiUD": {}}, "user_id": "8RInMU9H"}, {"extra_attributes": {"zLttiF9K": {}, "ZzVBBHJD": {}, "YC1jgGva": {}}, "user_id": "HToeCytL"}], "ticket_created_at": 43, "ticket_id": "LrLjJWmM"}, {"first_ticket_created_at": 5, "party_attributes": {"yatWSu61": {}, "QrAu5Mq3": {}, "0ohwwILs": {}}, "party_id": "WDCtKPPd", "party_members": [{"extra_attributes": {"zwV7YrAM": {}, "7XFVTwrT": {}, "MvQByHNl": {}}, "user_id": "OrActJ5l"}, {"extra_attributes": {"K2YCU2i5": {}, "DPEzb4Y1": {}, "wusq1HWP": {}}, "user_id": "0Alyn0jR"}, {"extra_attributes": {"iCEFr3Wo": {}, "wzUd8B3X": {}, "Dtq4Ya1G": {}}, "user_id": "Ta4rVlRq"}], "ticket_created_at": 73, "ticket_id": "p1lnQGXh"}]}, {"matching_parties": [{"first_ticket_created_at": 40, "party_attributes": {"bF9QYKlb": {}, "pLJvAMTp": {}, "Cv7HaAUm": {}}, "party_id": "7x8PRLe0", "party_members": [{"extra_attributes": {"FDk4CsDj": {}, "W9fDriTA": {}, "FZPv7cLq": {}}, "user_id": "zgoOvdIR"}, {"extra_attributes": {"6GY9Ohxy": {}, "iZkDMWaN": {}, "eznATeX3": {}}, "user_id": "cc4tOzXT"}, {"extra_attributes": {"VyaV6ngD": {}, "fO0d7mMu": {}, "0lbYnnOw": {}}, "user_id": "PI2yLdi3"}], "ticket_created_at": 63, "ticket_id": "K1xbjeRM"}, {"first_ticket_created_at": 82, "party_attributes": {"VB8i8AjO": {}, "3u2nQUSu": {}, "tZaa3zWM": {}}, "party_id": "IdyKGMJh", "party_members": [{"extra_attributes": {"TxjtvAv2": {}, "6tlqYo8r": {}, "Z63MtqJw": {}}, "user_id": "rBNe4N2t"}, {"extra_attributes": {"cXlFyUrM": {}, "bVsIAj14": {}, "eTtyczx7": {}}, "user_id": "G1BplRKL"}, {"extra_attributes": {"B12GNovi": {}, "gonA5IaA": {}, "5EEl5x06": {}}, "user_id": "DDiNxQ6q"}], "ticket_created_at": 47, "ticket_id": "a9f0pHOr"}, {"first_ticket_created_at": 2, "party_attributes": {"tZdOIVWx": {}, "nMMhxdW6": {}, "KiuajglC": {}}, "party_id": "IJsQgz7c", "party_members": [{"extra_attributes": {"r05DuAi2": {}, "icTrTfIh": {}, "sY3hM8or": {}}, "user_id": "Yt1T1jxD"}, {"extra_attributes": {"b3cK83lA": {}, "LeSeG5vc": {}, "U3KxggIQ": {}}, "user_id": "yHetY5jD"}, {"extra_attributes": {"RaGiE085": {}, "J43ePwTe": {}, "fblXTL7U": {}}, "user_id": "WpTPLVzv"}], "ticket_created_at": 68, "ticket_id": "iyjnknmC"}]}, {"matching_parties": [{"first_ticket_created_at": 8, "party_attributes": {"Ue08h9XT": {}, "10wEz9ne": {}, "vMkNQWE4": {}}, "party_id": "I0wCY53v", "party_members": [{"extra_attributes": {"l3qNCjN7": {}, "6a66LKsX": {}, "uOItb39v": {}}, "user_id": "bO23BNXR"}, {"extra_attributes": {"j9qfO4hs": {}, "BmjBs1vY": {}, "P8TgLSbS": {}}, "user_id": "v4Ga5AzC"}, {"extra_attributes": {"NxXReJUg": {}, "UfeNiBg5": {}, "TWomj1Gi": {}}, "user_id": "dhs36L8S"}], "ticket_created_at": 12, "ticket_id": "w920i2mK"}, {"first_ticket_created_at": 85, "party_attributes": {"L4Zv99EY": {}, "Wy1MhivS": {}, "Ugv0YTQK": {}}, "party_id": "FoV72rei", "party_members": [{"extra_attributes": {"xm8zElBI": {}, "WHUM1Atc": {}, "nbkD8CmG": {}}, "user_id": "kTxCIpqD"}, {"extra_attributes": {"W7UsWAgb": {}, "vbtsHcnL": {}, "WA9pzm6E": {}}, "user_id": "4AIMgN6p"}, {"extra_attributes": {"Wb6Hgcg2": {}, "VjXmrHcu": {}, "L1Eaz9fK": {}}, "user_id": "ng2g0ufz"}], "ticket_created_at": 33, "ticket_id": "OPlJjYuF"}, {"first_ticket_created_at": 2, "party_attributes": {"HIWGxJH7": {}, "smuAAJro": {}, "bACyyoTT": {}}, "party_id": "tSDIxq6F", "party_members": [{"extra_attributes": {"wjQ4m6Wj": {}, "J5iKNS1f": {}, "k5GmhwmB": {}}, "user_id": "SB2c2Nd6"}, {"extra_attributes": {"fulg6mmS": {}, "9v11rXOT": {}, "iZOXGaXf": {}}, "user_id": "YeoOo7oM"}, {"extra_attributes": {"CoI0LMIi": {}, "72FnpVdS": {}, "OTdijxf6": {}}, "user_id": "5L4pIpe9"}], "ticket_created_at": 21, "ticket_id": "SBSQE8jn"}]}], "namespace": "Kz2ltZNV", "party_attributes": {"oglh7i6f": {}, "9iAutD4V": {}, "bCVvEvRY": {}}, "party_id": "HKPjTBAQ", "queued_at": 9, "region": "aZpYeb5Q", "server_name": "QYY2SExh", "status": "3WP3gDpz", "ticket_id": "yqVxDrGS", "ticket_ids": ["WaC4L8cQ", "qEBQLBsn", "zqfPkOE1"], "updated_at": "1982-03-26T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "q29b8Fdk"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'WGhuLbIP' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 89, "userID": "eBHkDnQf", "weight": 0.7217175423246275}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'XKUm77Dr' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy 'qkmYA1iU' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'kApabNFQ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCannotMatch", "deployment": "4Pr6QjAa", "description": "i3PRDIT4", "findMatchTimeoutSeconds": 65, "joinable": true, "max_delay_ms": 64, "region_expansion_range_ms": 71, "region_expansion_rate_ms": 11, "region_latency_initial_range_ms": 78, "region_latency_max_ms": 66, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 25, "min": 42, "name": "89DztY1h"}, {"max": 7, "min": 65, "name": "SFmznKgi"}, {"max": 98, "min": 8, "name": "B4L9to8m"}], [{"max": 51, "min": 13, "name": "dgy1qyD8"}, {"max": 45, "min": 22, "name": "3oAADd6x"}, {"max": 66, "min": 36, "name": "7MwnyBN9"}], [{"max": 17, "min": 69, "name": "SEcl2d0D"}, {"max": 29, "min": 80, "name": "QBWOsm0T"}, {"max": 86, "min": 95, "name": "FiRSiAjV"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 16, "role_flexing_second": 45}, "maxNumber": 24, "minNumber": 84, "playerMaxNumber": 64, "playerMinNumber": 60}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 34, "min": 13, "name": "jOn4Rzfh"}, {"max": 45, "min": 4, "name": "ccSWn4kI"}, {"max": 1, "min": 48, "name": "Dd7Rz2G1"}], [{"max": 2, "min": 77, "name": "mSF6pKkV"}, {"max": 82, "min": 21, "name": "cKFycRYp"}, {"max": 39, "min": 67, "name": "6SmU1JoU"}], [{"max": 94, "min": 27, "name": "isNc0fhe"}, {"max": 38, "min": 20, "name": "gzLeHKzT"}, {"max": 100, "min": 41, "name": "TgrhAaEX"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 86, "role_flexing_second": 29}, "duration": 38, "max_number": 93, "min_number": 21, "player_max_number": 17, "player_min_number": 52}, {"combination": {"alliances": [[{"max": 38, "min": 40, "name": "uLp56xD5"}, {"max": 10, "min": 13, "name": "EwpZROyM"}, {"max": 6, "min": 87, "name": "84W24oHq"}], [{"max": 0, "min": 36, "name": "BRCiDdpt"}, {"max": 98, "min": 27, "name": "3HhNeXB6"}, {"max": 95, "min": 45, "name": "3pUB9BEG"}], [{"max": 100, "min": 15, "name": "QDTNHQtE"}, {"max": 16, "min": 89, "name": "zVX2vZlp"}, {"max": 74, "min": 4, "name": "IZFwoqOz"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 75, "role_flexing_second": 92}, "duration": 40, "max_number": 81, "min_number": 49, "player_max_number": 23, "player_min_number": 22}, {"combination": {"alliances": [[{"max": 24, "min": 21, "name": "epji04df"}, {"max": 73, "min": 5, "name": "lLb9fBTq"}, {"max": 47, "min": 74, "name": "SfiV0g4z"}], [{"max": 17, "min": 37, "name": "949oRhWA"}, {"max": 18, "min": 64, "name": "5yobCugM"}, {"max": 13, "min": 21, "name": "qUqC0YTZ"}], [{"max": 13, "min": 45, "name": "QpshJ3YN"}, {"max": 30, "min": 88, "name": "oLXb7LKI"}, {"max": 78, "min": 17, "name": "3ieW5gd6"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 69, "role_flexing_second": 86}, "duration": 72, "max_number": 22, "min_number": 40, "player_max_number": 0, "player_min_number": 27}], "batch_size": 43, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 69, "flex_flat_step_range": 48, "flex_immunity_count": 31, "flex_range_max": 22, "flex_rate_ms": 29, "flex_step_max": 46, "force_authority_match": false, "initial_step_range": 17, "mmr_max": 18, "mmr_mean": 22, "mmr_min": 2, "mmr_std_dev": 58, "override_mmr_data": false, "use_bucket_mmr": true, "use_flat_flex_step": true}, "flexingRules": [{"attribute": "9gTfTlzZ", "criteria": "pL4nnpPs", "duration": 97, "reference": 0.9020177488695231}, {"attribute": "kEFulOoG", "criteria": "a9Q04e6Q", "duration": 79, "reference": 0.11599715797606203}, {"attribute": "EE8XbHtn", "criteria": "jHHC20Ho", "duration": 0, "reference": 0.634204327768769}], "match_options": {"options": [{"name": "eMv7g2XD", "type": "SUq1c1V3"}, {"name": "6MxmXcjB", "type": "SPvOZo9l"}, {"name": "2bzF1RFO", "type": "wuSztTw1"}]}, "matchingRules": [{"attribute": "AtGyAJIr", "criteria": "E381RB0c", "reference": 0.6481797866934774}, {"attribute": "nAfS3ubD", "criteria": "iyx84OQn", "reference": 0.5081795129575253}, {"attribute": "eURm9YUB", "criteria": "GLKeFbMP", "reference": 0.5210791328288552}], "sort_ticket": {"search_result": "YY5SFdAn", "ticket_queue": "jseBn64c"}, "sort_tickets": [{"search_result": "1McQl6BT", "threshold": 46, "ticket_queue": "Kzktz7pl"}, {"search_result": "WqzXKADt", "threshold": 73, "ticket_queue": "qz2W603j"}, {"search_result": "3mB80nNq", "threshold": 6, "ticket_queue": "I9UXe6t8"}], "sub_game_modes": {}, "ticket_flexing_selection": "5Li5eqcT", "ticket_flexing_selections": [{"selection": "uztbyhs4", "threshold": 30}, {"selection": "6IZCw0hw", "threshold": 68}, {"selection": "nZUySWdc", "threshold": 15}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 21, "socialMatchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'Ari1IYqb' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName '1PrkuR7b' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'nFxy2kNm' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 3}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'B4TDpB21' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'NBCFCkYQ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "0UxcIFSn", "count": 19, "mmrMax": 0.3279183515421924, "mmrMean": 0.55643521295265, "mmrMin": 0.309778776507576, "mmrStdDev": 0.7587967881953506}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'cfJLGHEY' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 58, "party_attributes": {"iAH3UVFb": {}, "XEqIvWOX": {}, "APB3lgtr": {}}, "party_id": "h7pZVXfY", "party_members": [{"extra_attributes": {"LFbeHmWm": {}, "5MOdtls6": {}, "IhNafn71": {}}, "user_id": "6QjbNpHo"}, {"extra_attributes": {"7BQQ2dBT": {}, "l18bDTGU": {}, "ZldJoKpH": {}}, "user_id": "7JYL8UWc"}, {"extra_attributes": {"anLPfdAh": {}, "xoasamRV": {}, "MyLADIvW": {}}, "user_id": "2nxFaLrG"}], "ticket_created_at": 11, "ticket_id": "ArVMda5E"}, {"first_ticket_created_at": 79, "party_attributes": {"2sVN6QzZ": {}, "gQn7s8GA": {}, "GDpk1GbK": {}}, "party_id": "1O6NtUY1", "party_members": [{"extra_attributes": {"TZShFJkR": {}, "9a3nmoeX": {}, "UngK7FQI": {}}, "user_id": "9Snu3zr9"}, {"extra_attributes": {"iyBMO5H3": {}, "20ifKiX8": {}, "M1ZRPE1h": {}}, "user_id": "TuDksPEc"}, {"extra_attributes": {"mWkMSeQo": {}, "dehl0WVE": {}, "3X7YwoIx": {}}, "user_id": "UPnb42sv"}], "ticket_created_at": 41, "ticket_id": "snWkfSzc"}, {"first_ticket_created_at": 29, "party_attributes": {"ggnKnosQ": {}, "d3tCc3uC": {}, "O8tkFW3o": {}}, "party_id": "FG5vvDDe", "party_members": [{"extra_attributes": {"Hyvh80Hv": {}, "hSOjSglt": {}, "ynjxFBtA": {}}, "user_id": "ccY1hNT5"}, {"extra_attributes": {"kzlIv11s": {}, "lUR3NCIe": {}, "TAd5Q25w": {}}, "user_id": "XHALarGi"}, {"extra_attributes": {"Du8fLwYU": {}, "R79Xd8QR": {}, "kEPaoynS": {}}, "user_id": "vekvTIK1"}], "ticket_created_at": 58, "ticket_id": "PlA0bLcV"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'bvxQKWjb' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 43}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'k04JhyWi' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'Vusn2kRA' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'XKDqR8mp' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["q8N3071w", "W376eO57", "i3912XMa"], "party_id": "7r5bqrae", "user_id": "KLDVYYWg"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'GOpkHnNW' \
    --matchID 'LeOkEhCA' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName '0CpvqJLT' \
    --matchID 'PL5PJ5ka' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName '4XJjpdtS' \
    --matchID 'X2pgqP5c' \
    --namespace $AB_NAMESPACE \
    --userID 'KmV86eqm' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName '9t7cW8Vl' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'l56B5WnJ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE