#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '55' \
    --offset '43' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatch", "deployment": "L5VLrO2f", "description": "5laXSlYy", "find_match_timeout_seconds": 24, "game_mode": "zjYWWVcG", "joinable": false, "max_delay_ms": 57, "region_expansion_range_ms": 97, "region_expansion_rate_ms": 43, "region_latency_initial_range_ms": 64, "region_latency_max_ms": 76, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 79, "min": 9, "name": "DMwG566b"}, {"max": 97, "min": 5, "name": "TXi5tYvz"}, {"max": 96, "min": 49, "name": "emgEy42v"}], [{"max": 98, "min": 82, "name": "Tg9XIino"}, {"max": 53, "min": 70, "name": "auJGdEPQ"}, {"max": 45, "min": 94, "name": "w6ZkopHJ"}], [{"max": 71, "min": 85, "name": "PmqCcBvR"}, {"max": 92, "min": 82, "name": "YyXnktev"}, {"max": 41, "min": 79, "name": "kSLQZRRR"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 56, "role_flexing_second": 60}, "max_number": 55, "min_number": 71, "player_max_number": 60, "player_min_number": 8}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 54, "min": 39, "name": "zn7VFxwo"}, {"max": 54, "min": 15, "name": "sCi6mvGH"}, {"max": 64, "min": 71, "name": "s7cAdQS2"}], [{"max": 57, "min": 5, "name": "VrcStZHl"}, {"max": 29, "min": 16, "name": "sak45UzI"}, {"max": 80, "min": 32, "name": "kSiJ6H4H"}], [{"max": 10, "min": 46, "name": "e8umcVDV"}, {"max": 57, "min": 70, "name": "mXzlKvMR"}, {"max": 73, "min": 56, "name": "WlvYFqav"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 27, "role_flexing_second": 41}, "duration": 31, "max_number": 77, "min_number": 28, "player_max_number": 51, "player_min_number": 8}, {"combination": {"alliances": [[{"max": 23, "min": 24, "name": "tMMawkww"}, {"max": 25, "min": 56, "name": "pS9KvHBU"}, {"max": 70, "min": 4, "name": "UQCZqUCi"}], [{"max": 39, "min": 29, "name": "hqVk5k6w"}, {"max": 96, "min": 90, "name": "jG8JQi8O"}, {"max": 21, "min": 83, "name": "77hUtXzC"}], [{"max": 30, "min": 21, "name": "7f01ek13"}, {"max": 23, "min": 29, "name": "IjCZcSZM"}, {"max": 79, "min": 85, "name": "3ceiA5Q2"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 63}, "duration": 86, "max_number": 64, "min_number": 22, "player_max_number": 89, "player_min_number": 73}, {"combination": {"alliances": [[{"max": 10, "min": 86, "name": "jauhC4tF"}, {"max": 50, "min": 1, "name": "KrXpZ5Ql"}, {"max": 55, "min": 78, "name": "ejSxsWhw"}], [{"max": 25, "min": 52, "name": "Q3D8KLxD"}, {"max": 83, "min": 43, "name": "14b7xLkt"}, {"max": 33, "min": 1, "name": "9WIuTDo3"}], [{"max": 87, "min": 4, "name": "jJ7gDLkB"}, {"max": 73, "min": 70, "name": "L015wksb"}, {"max": 51, "min": 95, "name": "EzCd4r0e"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 50, "role_flexing_second": 79}, "duration": 34, "max_number": 30, "min_number": 1, "player_max_number": 91, "player_min_number": 77}], "batch_size": 82, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 66, "flex_flat_step_range": 19, "flex_immunity_count": 90, "flex_range_max": 25, "flex_rate_ms": 52, "flex_step_max": 62, "force_authority_match": false, "initial_step_range": 52, "mmr_max": 36, "mmr_mean": 39, "mmr_min": 19, "mmr_std_dev": 4, "override_mmr_data": true, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexing_rule": [{"attribute": "KFBywNWO", "criteria": "oyFLODks", "duration": 19, "reference": 0.9307090138613322}, {"attribute": "SpLjQB82", "criteria": "JwXuX4nV", "duration": 6, "reference": 0.05174451278875192}, {"attribute": "QQtXCcps", "criteria": "sw5W9hky", "duration": 98, "reference": 0.3852819226997023}], "match_options": {"options": [{"name": "2ZHwgJnU", "type": "mxah7xOP"}, {"name": "hsxEfaLg", "type": "4r9VCwCY"}, {"name": "9zJmDMfn", "type": "U5SGaxII"}]}, "matching_rule": [{"attribute": "74newdyM", "criteria": "SJ8zH9et", "reference": 0.5985385866903946}, {"attribute": "mDM4FDWX", "criteria": "7u6WweXZ", "reference": 0.22227322036927832}, {"attribute": "vT0RwBdD", "criteria": "h5MygASl", "reference": 0.6272120501741734}], "rebalance_enable": false, "sort_ticket": {"search_result": "oldestTicketAge", "ticket_queue": "none"}, "sort_tickets": [{"search_result": "distance", "threshold": 99, "ticket_queue": "distance"}, {"search_result": "distance", "threshold": 55, "ticket_queue": "largestPartySize"}, {"search_result": "oldestTicketAge", "threshold": 33, "ticket_queue": "oldestTicketAge"}], "sub_game_modes": {"Ig3ljXgd": {"alliance": {"combination": {"alliances": [[{"max": 44, "min": 67, "name": "BZYRIjrR"}, {"max": 43, "min": 36, "name": "roYk8Y41"}, {"max": 35, "min": 24, "name": "WKS252yw"}], [{"max": 87, "min": 70, "name": "9nHPlDY7"}, {"max": 14, "min": 72, "name": "4eeE5dQc"}, {"max": 15, "min": 21, "name": "ZF7vF9ff"}], [{"max": 43, "min": 22, "name": "I1DvPmi6"}, {"max": 22, "min": 40, "name": "rtIADv9a"}, {"max": 7, "min": 7, "name": "MuLfbd6L"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 77, "role_flexing_second": 36}, "max_number": 73, "min_number": 45, "player_max_number": 18, "player_min_number": 77}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 19, "min": 22, "name": "WjjvDDhi"}, {"max": 21, "min": 18, "name": "HDZgJfHb"}, {"max": 22, "min": 90, "name": "fzQ6GyeM"}], [{"max": 12, "min": 42, "name": "je4xbq9o"}, {"max": 94, "min": 42, "name": "x2O0NZdv"}, {"max": 8, "min": 66, "name": "vfta5qMV"}], [{"max": 87, "min": 63, "name": "cPozmML8"}, {"max": 13, "min": 28, "name": "V7jf90im"}, {"max": 75, "min": 34, "name": "Ojz1IrgZ"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 62, "role_flexing_second": 58}, "duration": 51, "max_number": 0, "min_number": 7, "player_max_number": 8, "player_min_number": 86}, {"combination": {"alliances": [[{"max": 76, "min": 70, "name": "7m4OLISc"}, {"max": 36, "min": 89, "name": "VH5TflIt"}, {"max": 62, "min": 21, "name": "DXOp3v7Y"}], [{"max": 84, "min": 55, "name": "e15CDY6G"}, {"max": 25, "min": 68, "name": "XBh8gRoo"}, {"max": 35, "min": 35, "name": "uvdnUcyS"}], [{"max": 4, "min": 56, "name": "kptma5Ny"}, {"max": 39, "min": 72, "name": "IPqJVg0b"}, {"max": 26, "min": 83, "name": "dI6pUyyw"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 94, "role_flexing_second": 58}, "duration": 68, "max_number": 87, "min_number": 0, "player_max_number": 42, "player_min_number": 72}, {"combination": {"alliances": [[{"max": 26, "min": 40, "name": "TsId6biO"}, {"max": 31, "min": 66, "name": "d5lKF012"}, {"max": 13, "min": 39, "name": "372DGySF"}], [{"max": 12, "min": 84, "name": "5QFGNeDB"}, {"max": 67, "min": 31, "name": "K1RZvZBy"}, {"max": 19, "min": 26, "name": "LIn5rSMj"}], [{"max": 87, "min": 65, "name": "I50YFsVA"}, {"max": 94, "min": 44, "name": "iAo5h2Da"}, {"max": 22, "min": 64, "name": "mV7my7DV"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 98, "role_flexing_second": 9}, "duration": 13, "max_number": 76, "min_number": 33, "player_max_number": 77, "player_min_number": 93}], "name": "va9eyjYJ"}, "6AgcoIZY": {"alliance": {"combination": {"alliances": [[{"max": 41, "min": 38, "name": "szvWneuz"}, {"max": 72, "min": 44, "name": "ykILaU3k"}, {"max": 19, "min": 23, "name": "Ps3Zu6pU"}], [{"max": 40, "min": 5, "name": "rB3fkjRz"}, {"max": 43, "min": 75, "name": "89EKnptX"}, {"max": 29, "min": 47, "name": "kOaRqhPa"}], [{"max": 29, "min": 60, "name": "rGQg6BLW"}, {"max": 55, "min": 94, "name": "MYLB5ZwS"}, {"max": 68, "min": 19, "name": "WimxZRFp"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 74, "role_flexing_second": 99}, "max_number": 20, "min_number": 31, "player_max_number": 68, "player_min_number": 97}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 26, "min": 59, "name": "Xd7zYz0N"}, {"max": 65, "min": 62, "name": "wavReU2R"}, {"max": 3, "min": 41, "name": "2Pmeql5l"}], [{"max": 71, "min": 22, "name": "ZF9gtQjU"}, {"max": 43, "min": 92, "name": "Vv2b0Z26"}, {"max": 50, "min": 0, "name": "dNngimFr"}], [{"max": 94, "min": 5, "name": "LqMr7LHK"}, {"max": 100, "min": 19, "name": "mpF26vkW"}, {"max": 75, "min": 64, "name": "FaWw6mZk"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 8, "role_flexing_second": 92}, "duration": 0, "max_number": 68, "min_number": 33, "player_max_number": 29, "player_min_number": 94}, {"combination": {"alliances": [[{"max": 44, "min": 95, "name": "Kp6gjs8P"}, {"max": 5, "min": 66, "name": "nGxH7BSe"}, {"max": 39, "min": 67, "name": "G0l9eI2U"}], [{"max": 10, "min": 4, "name": "AJalvI5f"}, {"max": 93, "min": 42, "name": "MbeGCxIg"}, {"max": 71, "min": 85, "name": "CcPoA0Fo"}], [{"max": 43, "min": 6, "name": "Bot2jIJ0"}, {"max": 71, "min": 0, "name": "PRPdp33J"}, {"max": 1, "min": 29, "name": "Br69d24O"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 95, "role_flexing_second": 3}, "duration": 68, "max_number": 92, "min_number": 70, "player_max_number": 90, "player_min_number": 24}, {"combination": {"alliances": [[{"max": 81, "min": 97, "name": "pqUm4iFA"}, {"max": 41, "min": 53, "name": "okQA1AnD"}, {"max": 8, "min": 56, "name": "GxBcWDVs"}], [{"max": 88, "min": 39, "name": "0IrWYNk5"}, {"max": 56, "min": 93, "name": "YSkrxO4q"}, {"max": 39, "min": 26, "name": "guey79HN"}], [{"max": 10, "min": 32, "name": "wXqqouvT"}, {"max": 44, "min": 83, "name": "GRPstq1q"}, {"max": 36, "min": 100, "name": "LDj9nUi6"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 94, "role_flexing_second": 73}, "duration": 0, "max_number": 11, "min_number": 1, "player_max_number": 84, "player_min_number": 90}], "name": "gp7cC7c0"}, "k7RT9nA6": {"alliance": {"combination": {"alliances": [[{"max": 16, "min": 3, "name": "i3BLbQ0O"}, {"max": 61, "min": 25, "name": "YiZO1Ym3"}, {"max": 45, "min": 14, "name": "8ClKwQ9t"}], [{"max": 28, "min": 5, "name": "FNbgZBJg"}, {"max": 65, "min": 77, "name": "f36ZAyqW"}, {"max": 19, "min": 16, "name": "pV0DRGnS"}], [{"max": 90, "min": 41, "name": "rnAnL4ko"}, {"max": 17, "min": 39, "name": "psMcFcSA"}, {"max": 10, "min": 79, "name": "JcxsDVU3"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 73, "role_flexing_second": 48}, "max_number": 10, "min_number": 45, "player_max_number": 17, "player_min_number": 3}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 59, "min": 30, "name": "PWSjWgex"}, {"max": 22, "min": 72, "name": "ZgmJaF2W"}, {"max": 12, "min": 50, "name": "43pZN7ka"}], [{"max": 53, "min": 53, "name": "tN9dQTKl"}, {"max": 40, "min": 59, "name": "onW6nSPk"}, {"max": 27, "min": 35, "name": "4LAiCdDJ"}], [{"max": 36, "min": 68, "name": "hVk8qqe9"}, {"max": 77, "min": 17, "name": "FjxQymJv"}, {"max": 23, "min": 11, "name": "Zf0oz1tR"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 96, "role_flexing_second": 73}, "duration": 7, "max_number": 16, "min_number": 51, "player_max_number": 34, "player_min_number": 8}, {"combination": {"alliances": [[{"max": 62, "min": 47, "name": "i8HKWV5k"}, {"max": 20, "min": 72, "name": "9LKlrl8D"}, {"max": 87, "min": 82, "name": "v4AIJkUb"}], [{"max": 14, "min": 75, "name": "KjRvrpxB"}, {"max": 32, "min": 71, "name": "uHrEYYpy"}, {"max": 52, "min": 44, "name": "1LHTPz3U"}], [{"max": 25, "min": 22, "name": "FNluVHek"}, {"max": 65, "min": 67, "name": "oU7OG7kV"}, {"max": 16, "min": 92, "name": "A5W3sLtL"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 60, "role_flexing_second": 84}, "duration": 47, "max_number": 47, "min_number": 35, "player_max_number": 80, "player_min_number": 40}, {"combination": {"alliances": [[{"max": 1, "min": 49, "name": "FVdMNebx"}, {"max": 47, "min": 60, "name": "1TvIyRdY"}, {"max": 60, "min": 5, "name": "xLqR3IT1"}], [{"max": 86, "min": 74, "name": "8OAElOkl"}, {"max": 91, "min": 62, "name": "5hy0YtLn"}, {"max": 5, "min": 4, "name": "iRVKSemS"}], [{"max": 35, "min": 32, "name": "4Vpf3hwQ"}, {"max": 71, "min": 22, "name": "hGraEHcV"}, {"max": 27, "min": 64, "name": "Kbb27X7x"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 70, "role_flexing_second": 40}, "duration": 63, "max_number": 8, "min_number": 68, "player_max_number": 68, "player_min_number": 24}], "name": "wAPguh50"}}, "ticket_flexing_selection": "newest", "ticket_flexing_selections": [{"selection": "random", "threshold": 40}, {"selection": "pivot", "threshold": 79}, {"selection": "pivot", "threshold": 24}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 22, "social_matchmaking": false, "sub_gamemode_selection": "random", "ticket_observability_enable": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'XWAt7WsJ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'xnPUp2F9' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "sHAr6iLy", "players": [{"results": [{"attribute": "6lu2nUUK", "value": 0.8583353765558075}, {"attribute": "VjtOvIpc", "value": 0.05323927663542172}, {"attribute": "Oxb6CjMi", "value": 0.9237756478791879}], "user_id": "5mf47c2T"}, {"results": [{"attribute": "2hfy7h5g", "value": 0.7047714243835668}, {"attribute": "Pm2j0qKF", "value": 0.4358468515013638}, {"attribute": "DBzyBJc8", "value": 0.7858526975796241}], "user_id": "ZNgO8M6z"}, {"results": [{"attribute": "bpBmGUqZ", "value": 0.2599722494355797}, {"attribute": "ojkNh0wO", "value": 0.8921044813234252}, {"attribute": "82klj7WH", "value": 0.5133453451184431}], "user_id": "mxSe3G9A"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "KkK4d8qh"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "OYlf73Sn", "client_version": "YM904IBJ", "deployment": "vd4cyQpk", "error_code": 84, "error_message": "vj4VPGM9", "game_mode": "e8Dp6mSr", "is_mock": "U8TCgvwd", "joinable": true, "match_id": "YRTKUAJW", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 65, "party_attributes": {"XYGMqZut": {}, "6L4VYBqj": {}, "1XsIOar6": {}}, "party_id": "6oxLgoA8", "party_members": [{"extra_attributes": {"MjeyARdb": {}, "7nXxteo4": {}, "h51JJ1ck": {}}, "user_id": "4x2iPRkr"}, {"extra_attributes": {"qlgEJpGF": {}, "y61lx1fn": {}, "5mILAzMB": {}}, "user_id": "iwzLiLvP"}, {"extra_attributes": {"Iyh2OpYG": {}, "9Rta3la3": {}, "IfdJZLLR": {}}, "user_id": "HGa4BFfx"}], "ticket_created_at": 30, "ticket_id": "DwS8zKQK"}, {"first_ticket_created_at": 43, "party_attributes": {"IaNnG64S": {}, "NDLvkAgC": {}, "fbtY1gN5": {}}, "party_id": "ETmSz3iW", "party_members": [{"extra_attributes": {"loUDuOtg": {}, "DJ7GDd43": {}, "6m2IR8Vy": {}}, "user_id": "PvxVouSO"}, {"extra_attributes": {"LmJGsFuH": {}, "E9Anic2f": {}, "Yjwytkyg": {}}, "user_id": "JKD50xOK"}, {"extra_attributes": {"hthann6u": {}, "SFKxNxHO": {}, "McXH0KcI": {}}, "user_id": "q1WRP24J"}], "ticket_created_at": 25, "ticket_id": "NygsZLco"}, {"first_ticket_created_at": 20, "party_attributes": {"Src1c0ay": {}, "frhSnaeC": {}, "LLP7uvxB": {}}, "party_id": "84ry00WI", "party_members": [{"extra_attributes": {"4Slyp5pQ": {}, "VcGHZq4C": {}, "XJIeLa2b": {}}, "user_id": "ufL2Q2sj"}, {"extra_attributes": {"MCyZAwkg": {}, "f0xnAfja": {}, "fOij5IWv": {}}, "user_id": "Hk6h4Gye"}, {"extra_attributes": {"AYznxm0B": {}, "iYL80cUJ": {}, "X4zlBj0e": {}}, "user_id": "DLvHFyQK"}], "ticket_created_at": 18, "ticket_id": "xcCehiPI"}]}, {"matching_parties": [{"first_ticket_created_at": 41, "party_attributes": {"O3Hv8xiy": {}, "Un92tBoA": {}, "gtabKPog": {}}, "party_id": "yjK3FgCG", "party_members": [{"extra_attributes": {"K0nuc5DI": {}, "VDUs1VtC": {}, "neJMby8R": {}}, "user_id": "hmkNbrGt"}, {"extra_attributes": {"qQSONfQC": {}, "630BDvWK": {}, "0ijLvraZ": {}}, "user_id": "r3OhhadB"}, {"extra_attributes": {"3F2iIY7r": {}, "t7gSKk1i": {}, "7Fx39295": {}}, "user_id": "b9FvlKUI"}], "ticket_created_at": 62, "ticket_id": "CI95AbBK"}, {"first_ticket_created_at": 93, "party_attributes": {"2TJ0P5cI": {}, "hv4pcxdP": {}, "YjcSJ05h": {}}, "party_id": "4E1sZNkD", "party_members": [{"extra_attributes": {"glZkrNOY": {}, "q0yxEwLj": {}, "hCPkYmjU": {}}, "user_id": "EtI285RT"}, {"extra_attributes": {"A8MoyoRZ": {}, "QgyO5lYC": {}, "7ARjd28Y": {}}, "user_id": "GmjQ86cQ"}, {"extra_attributes": {"J9sQOldu": {}, "vB1YL9ac": {}, "s8ror9LR": {}}, "user_id": "MRhQPQF4"}], "ticket_created_at": 65, "ticket_id": "dJkBKnU5"}, {"first_ticket_created_at": 27, "party_attributes": {"rjR6QByj": {}, "Q1YQwBbQ": {}, "L2gdYzUr": {}}, "party_id": "3N1MdMzh", "party_members": [{"extra_attributes": {"XH5wWO7E": {}, "gATvRNYK": {}, "cs9b0W0z": {}}, "user_id": "gbhwa162"}, {"extra_attributes": {"M4YQxtIp": {}, "JLfFaquZ": {}, "STQimVyR": {}}, "user_id": "MUbzjo56"}, {"extra_attributes": {"L0inB7f1": {}, "kwmus3u3": {}, "7r7iGHOF": {}}, "user_id": "HSzHEmUw"}], "ticket_created_at": 6, "ticket_id": "0VCM85Q9"}]}, {"matching_parties": [{"first_ticket_created_at": 1, "party_attributes": {"GZSYP0gs": {}, "JZlhm8vz": {}, "GhcDSxEC": {}}, "party_id": "1MXdxbNX", "party_members": [{"extra_attributes": {"U4N6V7ux": {}, "AX6CFOKj": {}, "QKA99tvp": {}}, "user_id": "NIzYrETf"}, {"extra_attributes": {"I9MK3Wjw": {}, "Ob0ESULj": {}, "8V4eFznO": {}}, "user_id": "GlaBxsI6"}, {"extra_attributes": {"7QmtO2Jz": {}, "YTan43Jg": {}, "3Cq5utZU": {}}, "user_id": "FBupJS3Q"}], "ticket_created_at": 29, "ticket_id": "5VZUqSyv"}, {"first_ticket_created_at": 44, "party_attributes": {"6cFyUCyB": {}, "Hvc74bNT": {}, "7yGXN5aZ": {}}, "party_id": "ISLqjwzm", "party_members": [{"extra_attributes": {"zbJTOxN2": {}, "rCpVvkfX": {}, "kqdgGwNr": {}}, "user_id": "tJFxKxdP"}, {"extra_attributes": {"kvCJjJln": {}, "50FyXlpo": {}, "4NHHGR70": {}}, "user_id": "Tb1eVUyI"}, {"extra_attributes": {"WTvHfUxM": {}, "7OZVsDFg": {}, "zBMdsq2I": {}}, "user_id": "S3mxBhsO"}], "ticket_created_at": 52, "ticket_id": "AFiFk11T"}, {"first_ticket_created_at": 55, "party_attributes": {"q06QW8Ka": {}, "mnGop99K": {}, "AOopgAOV": {}}, "party_id": "EsUFJlDu", "party_members": [{"extra_attributes": {"9uchwsMd": {}, "qey9sOkt": {}, "2snCRLZl": {}}, "user_id": "F8jX82qq"}, {"extra_attributes": {"2NZbSt9g": {}, "j8xXt1j4": {}, "QhcNr06E": {}}, "user_id": "H5tG4OMN"}, {"extra_attributes": {"8bnTzVV3": {}, "OyNVvKh5": {}, "uukObIYO": {}}, "user_id": "g9u1yAdn"}], "ticket_created_at": 72, "ticket_id": "V9PxxPqo"}]}], "namespace": "C7dZnqLv", "party_attributes": {"V7TRHb5D": {}, "8I3WRpFZ": {}, "6rfI6Nqe": {}}, "party_id": "MrEHESuN", "queued_at": 55, "region": "3wS88dvM", "server_name": "7mh1CeZv", "status": "Da6Ntu4c", "ticket_id": "Qg7rprSL", "ticket_ids": ["t872PBwI", "Qm84f3BK", "yuW3yqeT"], "updated_at": "1985-07-27T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "4q71dcXF"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID '3wQvfLxk' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 36, "userID": "fZcwxNe5", "weight": 0.26231175556807174}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs '0s8Z5lBt' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'sCBZhKbt' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'cF5OB9tt' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatch", "deployment": "zzwn8mXx", "description": "TWhIsU5C", "findMatchTimeoutSeconds": 39, "joinable": false, "max_delay_ms": 92, "region_expansion_range_ms": 7, "region_expansion_rate_ms": 72, "region_latency_initial_range_ms": 39, "region_latency_max_ms": 24, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 29, "min": 80, "name": "L8M5UrGi"}, {"max": 39, "min": 47, "name": "FaYB0Cyb"}, {"max": 100, "min": 25, "name": "3YqLDAgT"}], [{"max": 19, "min": 43, "name": "JWT9P44D"}, {"max": 49, "min": 90, "name": "txgKUlYe"}, {"max": 4, "min": 93, "name": "aJeIft4m"}], [{"max": 66, "min": 50, "name": "AyST5JpY"}, {"max": 17, "min": 67, "name": "hwRB113g"}, {"max": 30, "min": 80, "name": "Gk8XNDSp"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 62, "role_flexing_second": 28}, "maxNumber": 53, "minNumber": 36, "playerMaxNumber": 77, "playerMinNumber": 7}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 28, "min": 15, "name": "XLdCrRQM"}, {"max": 71, "min": 100, "name": "2IhWeLoB"}, {"max": 9, "min": 2, "name": "d2zFiON1"}], [{"max": 28, "min": 11, "name": "E1IXV0HV"}, {"max": 87, "min": 56, "name": "GDEYNnLo"}, {"max": 25, "min": 16, "name": "YZzYWR5Q"}], [{"max": 51, "min": 90, "name": "ErZLVDA7"}, {"max": 12, "min": 52, "name": "JgimIgLI"}, {"max": 20, "min": 21, "name": "XVbXAcYM"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 58, "role_flexing_second": 82}, "duration": 53, "max_number": 89, "min_number": 61, "player_max_number": 27, "player_min_number": 62}, {"combination": {"alliances": [[{"max": 11, "min": 81, "name": "0YqoRbRo"}, {"max": 86, "min": 48, "name": "Xl5GRSr7"}, {"max": 60, "min": 73, "name": "DlRLTiwo"}], [{"max": 57, "min": 45, "name": "L49qO3ae"}, {"max": 30, "min": 55, "name": "4b0PUR3n"}, {"max": 4, "min": 14, "name": "yocbFa4n"}], [{"max": 66, "min": 25, "name": "9aqVaGFS"}, {"max": 69, "min": 72, "name": "mm3U7692"}, {"max": 80, "min": 13, "name": "pYsiR0Fr"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 53, "role_flexing_second": 43}, "duration": 96, "max_number": 90, "min_number": 62, "player_max_number": 62, "player_min_number": 61}, {"combination": {"alliances": [[{"max": 81, "min": 48, "name": "jkFCslLS"}, {"max": 28, "min": 54, "name": "00hJjarD"}, {"max": 75, "min": 55, "name": "lNFMivro"}], [{"max": 91, "min": 58, "name": "gBPGsa0y"}, {"max": 67, "min": 51, "name": "7BEySmbU"}, {"max": 0, "min": 66, "name": "ivzwqswA"}], [{"max": 96, "min": 87, "name": "bUkdak0p"}, {"max": 75, "min": 90, "name": "XwDCoqNJ"}, {"max": 62, "min": 47, "name": "7iSBRXZS"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 37, "role_flexing_second": 13}, "duration": 10, "max_number": 22, "min_number": 99, "player_max_number": 55, "player_min_number": 75}], "batch_size": 79, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 92, "flex_flat_step_range": 13, "flex_immunity_count": 16, "flex_range_max": 62, "flex_rate_ms": 13, "flex_step_max": 82, "force_authority_match": false, "initial_step_range": 53, "mmr_max": 6, "mmr_mean": 95, "mmr_min": 31, "mmr_std_dev": 39, "override_mmr_data": false, "use_bucket_mmr": false, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "AfHa1mq5", "criteria": "JphMjy2H", "duration": 13, "reference": 0.2604160127371302}, {"attribute": "3H24hNf4", "criteria": "QetEKOLM", "duration": 96, "reference": 0.47836462970818194}, {"attribute": "Zeck5469", "criteria": "2NiFoL7Y", "duration": 57, "reference": 0.8413731163451463}], "match_options": {"options": [{"name": "R1oaHKrQ", "type": "ho119NhH"}, {"name": "Ww2v6IIo", "type": "eMkyqsFI"}, {"name": "0Upo79mV", "type": "TlAySzwK"}]}, "matchingRules": [{"attribute": "8oPBZdij", "criteria": "irejiHbg", "reference": 0.3879278462770127}, {"attribute": "a7PMJt1h", "criteria": "zjpsDUOh", "reference": 0.8753386346394029}, {"attribute": "kttepcfV", "criteria": "UoAGgG9C", "reference": 0.11527659922520461}], "sort_ticket": {"search_result": "none", "ticket_queue": "largestPartySize"}, "sort_tickets": [{"search_result": "distance", "threshold": 69, "ticket_queue": "random"}, {"search_result": "oldestTicketAge", "threshold": 59, "ticket_queue": "largestPartySize"}, {"search_result": "largestPartySize", "threshold": 69, "ticket_queue": "distance"}], "sub_game_modes": {}, "ticket_flexing_selection": "random", "ticket_flexing_selections": [{"selection": "newest", "threshold": 56}, {"selection": "random", "threshold": 88}, {"selection": "pivot", "threshold": 35}], "use_newest_ticket_for_flexing": true}, "sessionQueueTimeoutSeconds": 77, "socialMatchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'saZNrX4i' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'RZMF5YIi' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'lHchpZXl' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 9}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'Zl1RcBFb' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'vQ4Qtzaz' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "2bf5oD9d", "count": 84, "mmrMax": 0.19314364387745142, "mmrMean": 0.48145645356355127, "mmrMin": 0.21999400727069562, "mmrStdDev": 0.35574000365540004}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName 'doWo8U5U' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 89, "party_attributes": {"HxQ3gJjX": {}, "4VR9unwD": {}, "UuxC2tS7": {}}, "party_id": "S7JU0QqM", "party_members": [{"extra_attributes": {"dLCyciz4": {}, "o42uAECR": {}, "hojUROev": {}}, "user_id": "n2xB8t3l"}, {"extra_attributes": {"oATXnwwH": {}, "NSqII7bI": {}, "v9aZ6LGH": {}}, "user_id": "F7PigHTZ"}, {"extra_attributes": {"ebhhZxfc": {}, "NnHnTAPt": {}, "qf5tpqcl": {}}, "user_id": "UOiWZsUn"}], "ticket_created_at": 54, "ticket_id": "JdV2WAIN"}, {"first_ticket_created_at": 91, "party_attributes": {"i2vZSvl6": {}, "4n8EREgU": {}, "yDY95WQr": {}}, "party_id": "26YqgJiB", "party_members": [{"extra_attributes": {"ENMQnjmC": {}, "WpVHJg5F": {}, "epd3hTze": {}}, "user_id": "yrgUXkrm"}, {"extra_attributes": {"V7ORS3Q1": {}, "qrec4vsq": {}, "bXKjrUtM": {}}, "user_id": "8JuytNVL"}, {"extra_attributes": {"3ylzfpld": {}, "evhWM2ml": {}, "EC6imE6u": {}}, "user_id": "flydmaWo"}], "ticket_created_at": 3, "ticket_id": "qSSl54Yg"}, {"first_ticket_created_at": 43, "party_attributes": {"M3pB6eqD": {}, "ZuKTxsTU": {}, "XFovZf60": {}}, "party_id": "za1gDcK6", "party_members": [{"extra_attributes": {"92B82ZZM": {}, "JV2WFRQn": {}, "cAhdxeSt": {}}, "user_id": "ExlEPAqZ"}, {"extra_attributes": {"CpSAVJ1u": {}, "63eLyyDx": {}, "rlunBPIp": {}}, "user_id": "qYQGHueZ"}, {"extra_attributes": {"gQYaR6DO": {}, "mYt09Ryl": {}, "mMQzveYi": {}}, "user_id": "QAhNUNcJ"}], "ticket_created_at": 60, "ticket_id": "c9of1ptr"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName '8yph2sG2' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 98}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'nOXUieXX' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'Lo3WSkhb' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'hmxh7Rd7' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["7mbZzx7Q", "inG6jnsi", "MFpWyFzv"], "party_id": "4xN6Cyu6", "user_id": "0NNQnPBt"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'm0WnPdD2' \
    --matchID 'ZQzbpi2f' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'DYDBVtMb' \
    --matchID 'vmQTIPeW' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'JsMTKaef' \
    --matchID 'Ar9Kn9tE' \
    --namespace $AB_NAMESPACE \
    --userID 'gMyIrj9k' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'gyZWhnmX' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'KbtLEvYP' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE