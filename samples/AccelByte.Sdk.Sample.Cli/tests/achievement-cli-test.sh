#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..30"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 AdminListAchievements
$CLI_EXE \
    --sn achievement \
    --op AdminListAchievements \
    --namespace $AB_NAMESPACE \
    --global 'false' \
    --limit '72' \
    --offset '95' \
    --sortBy 'listOrder:asc' \
    --tags '["2a4eCWWB", "1KauobHV", "J3E7lVNP"]' \
    > test.out 2>&1
eval_tap $? 2 'AdminListAchievements' test.out

#- 3 AdminCreateNewAchievement
# body param: body
echo '{"achievementCode": "3FNvyFiu", "customAttributes": {"XPjOgFyH": {}, "98quOT5f": {}, "4Kwus0dU": {}}, "defaultLanguage": "j5HnlbrM", "description": {"sczXn6FW": "x5XUhTJp", "KgyzPVVG": "36qhJaV8", "v24ozy3x": "Jwj1vk4O"}, "global": false, "goalValue": 0.772670062381061, "hidden": true, "incremental": false, "lockedIcons": [{"slug": "NYnWZNWy", "url": "If7Hz5Aa"}, {"slug": "Kt2hemTt", "url": "Gxl9SkcC"}, {"slug": "n4Xg7wJy", "url": "O57loaJ5"}], "name": {"mWgrECsa": "8UEY1AiL", "fvJTbVYw": "xFTQBWF9", "bjjB9I8a": "BGdDq47n"}, "statCode": "pzMUisPf", "tags": ["jZxoiMcu", "J3UQyZ3j", "4DfkGKI2"], "unlockedIcons": [{"slug": "NtKh30J6", "url": "h7jHuNkg"}, {"slug": "Q1MwzZ0X", "url": "i584e72h"}, {"slug": "aziUXWZ6", "url": "58lAQ4Jo"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op AdminCreateNewAchievement \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 3 'AdminCreateNewAchievement' test.out

#- 4 ExportAchievements
$CLI_EXE \
    --sn achievement \
    --op ExportAchievements \
    --namespace $AB_NAMESPACE \
    --tags '["LEXRMMr7", "Tu77FWf8", "Zjqwjmvn"]' \
    > test.out 2>&1
eval_tap $? 4 'ExportAchievements' test.out

#- 5 ImportAchievements
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn achievement \
    --op ImportAchievements \
    --namespace $AB_NAMESPACE \
    --upload file $TEMP_FILE_UPLOAD \
    --strategy '4IE5Qjs9' \
    > test.out 2>&1
eval_tap $? 5 'ImportAchievements' test.out

#- 6 AdminGetAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminGetAchievement \
    --achievementCode 'x3pbjsLW' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'AdminGetAchievement' test.out

#- 7 AdminUpdateAchievement
# body param: body
echo '{"customAttributes": {"2FvIDN63": {}, "A2hJRGDX": {}, "gsSIynrT": {}}, "defaultLanguage": "q232siki", "description": {"1INaMgFu": "eh4GVcaD", "8wQiT5Bq": "2Q3W4sXa", "g8AXcqqG": "Qb7RMuQy"}, "global": true, "goalValue": 0.5203543647542457, "hidden": true, "incremental": false, "lockedIcons": [{"slug": "VpcTRIkK", "url": "rMPS0WxH"}, {"slug": "7R0VnuQT", "url": "2CqLAti4"}, {"slug": "KBFZ1Eou", "url": "AMU4pxxv"}], "name": {"vobw5dnb": "FiCXy0oU", "H4E8L9ee": "6hSQxlsP", "p1z1BWdu": "WNL1i3Ej"}, "statCode": "FPyFwbeP", "tags": ["JibLmntt", "xGNv6gSG", "8B8G7Nt3"], "unlockedIcons": [{"slug": "32xUzvt1", "url": "GI8EQINS"}, {"slug": "ws72vjyQ", "url": "9IWYdNbX"}, {"slug": "bEUTzrVk", "url": "CwBhHlbI"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op AdminUpdateAchievement \
    --achievementCode 'd66dbYXa' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'AdminUpdateAchievement' test.out

#- 8 AdminDeleteAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminDeleteAchievement \
    --achievementCode 'XAfXe1Sx' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 8 'AdminDeleteAchievement' test.out

#- 9 AdminUpdateAchievementListOrder
# body param: body
echo '{"targetOrder": 30}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op AdminUpdateAchievementListOrder \
    --achievementCode 'oyzoozav' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'AdminUpdateAchievementListOrder' test.out

#- 10 AdminListGlobalAchievements
$CLI_EXE \
    --sn achievement \
    --op AdminListGlobalAchievements \
    --namespace $AB_NAMESPACE \
    --achievementCodes 'P1mSogDO' \
    --limit '41' \
    --offset '14' \
    --sortBy 'createdAt:asc' \
    --status 'ilTGMWvE' \
    --tags '["OMbRPV5C", "mXYtpyOQ", "WgUTtVtm"]' \
    > test.out 2>&1
eval_tap $? 10 'AdminListGlobalAchievements' test.out

#- 11 AdminListGlobalAchievementContributors
$CLI_EXE \
    --sn achievement \
    --op AdminListGlobalAchievementContributors \
    --achievementCode 'lTWXVAXk' \
    --namespace $AB_NAMESPACE \
    --limit '68' \
    --offset '87' \
    --sortBy 'contributedValue' \
    > test.out 2>&1
eval_tap $? 11 'AdminListGlobalAchievementContributors' test.out

#- 12 ResetGlobalAchievement
$CLI_EXE \
    --sn achievement \
    --op ResetGlobalAchievement \
    --achievementCode 'Y8kpRDb5' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'ResetGlobalAchievement' test.out

#- 13 BulkCreatePSNEvent
# body param: body
echo '{"data": [{"events": [{"dateTime": "zLznsJjG", "eventData": {"eventName": "ajvKtUGD", "properties": {"c7aDYkRU": {}, "QcURcuuK": {}, "uhVXOfTS": {}}}, "eventId": "vRPSYnBy", "version": "RfaJSgEG"}, {"dateTime": "CiPhcozY", "eventData": {"eventName": "fFyGXCMd", "properties": {"Xacg4ucx": {}, "5XAxPOeW": {}, "QVaDYMN0": {}}}, "eventId": "Xeq6reBu", "version": "c4DBYfrU"}, {"dateTime": "Mq1PSjEJ", "eventData": {"eventName": "j9S2fp6l", "properties": {"MMWJIII6": {}, "oyidZhlj": {}, "IpnBuCOM": {}}}, "eventId": "b4cdxMvC", "version": "R46pLqHA"}], "thirdPartyUserId": "Bxd2jdcl", "userId": "A8lM9ZvB"}, {"events": [{"dateTime": "QkiomHii", "eventData": {"eventName": "0nA6LhGA", "properties": {"YBfW7wRh": {}, "O0zXbNRB": {}, "bBj91FTt": {}}}, "eventId": "LALcs4cr", "version": "XC94a4ld"}, {"dateTime": "XuFjviZd", "eventData": {"eventName": "U1HduCSB", "properties": {"iGHwX1xH": {}, "6l3Q4QVI": {}, "ACZXgeRD": {}}}, "eventId": "qZpLJw9Y", "version": "2TLFxGZu"}, {"dateTime": "ihymZPQU", "eventData": {"eventName": "J9e1ZhmN", "properties": {"eHhiQoaQ": {}, "kzMXBVnb": {}, "YaKBrZQE": {}}}, "eventId": "zzblXoeF", "version": "qrAfH07a"}], "thirdPartyUserId": "PDqvAV2U", "userId": "9S3Qj0wx"}, {"events": [{"dateTime": "3KZh3WTr", "eventData": {"eventName": "mjXA6xBJ", "properties": {"3h8GrGTG": {}, "zrP9NRdp": {}, "PiG6JIjo": {}}}, "eventId": "zqiPr1I6", "version": "yw1iOKxj"}, {"dateTime": "xt5CbvDO", "eventData": {"eventName": "Rmd0KsAp", "properties": {"xrZIKYYr": {}, "MvfDqsre": {}, "pzmXYIZO": {}}}, "eventId": "o9yuD36m", "version": "RiDYORrH"}, {"dateTime": "vFS28pAH", "eventData": {"eventName": "Fp342EAR", "properties": {"vQAdhKkn": {}, "Qdh6ncuI": {}, "5V7eBzgA": {}}}, "eventId": "9730GDAj", "version": "Jb2tTCmW"}], "thirdPartyUserId": "T3HpsMma", "userId": "fyLMMTaN"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op BulkCreatePSNEvent \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'BulkCreatePSNEvent' test.out

#- 14 AdminListTags
$CLI_EXE \
    --sn achievement \
    --op AdminListTags \
    --namespace $AB_NAMESPACE \
    --limit '55' \
    --name 'MVONVIUA' \
    --offset '90' \
    --sortBy 'name:asc' \
    > test.out 2>&1
eval_tap $? 14 'AdminListTags' test.out

#- 15 AdminListUserAchievements
$CLI_EXE \
    --sn achievement \
    --op AdminListUserAchievements \
    --namespace $AB_NAMESPACE \
    --userId 'ylAFCnCp' \
    --limit '48' \
    --offset '37' \
    --preferUnlocked 'true' \
    --sortBy 'createdAt' \
    --tags '["cJvi71Xh", "fbDNcGoh", "WDNFfnEF"]' \
    > test.out 2>&1
eval_tap $? 15 'AdminListUserAchievements' test.out

#- 16 AdminBulkUnlockAchievement
# body param: body
echo '{"achievementCodes": ["WZ5FEk39", "JV4PC1Hr", "KMmXIoQd"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op AdminBulkUnlockAchievement \
    --namespace $AB_NAMESPACE \
    --userId '7RGAyJGw' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 16 'AdminBulkUnlockAchievement' test.out

#- 17 AdminResetAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminResetAchievement \
    --achievementCode 'U78oCTML' \
    --namespace $AB_NAMESPACE \
    --userId '24GHzIkU' \
    > test.out 2>&1
eval_tap $? 17 'AdminResetAchievement' test.out

#- 18 AdminUnlockAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminUnlockAchievement \
    --achievementCode 'tlREfO5D' \
    --namespace $AB_NAMESPACE \
    --userId 'AZLdY6d1' \
    > test.out 2>&1
eval_tap $? 18 'AdminUnlockAchievement' test.out

#- 19 AdminAnonymizeUserAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminAnonymizeUserAchievement \
    --namespace $AB_NAMESPACE \
    --userId 'uulepwHm' \
    > test.out 2>&1
eval_tap $? 19 'AdminAnonymizeUserAchievement' test.out

#- 20 AdminListUserContributions
$CLI_EXE \
    --sn achievement \
    --op AdminListUserContributions \
    --namespace $AB_NAMESPACE \
    --userId 'MxrNt9um' \
    --achievementCodes '62DkjuFn' \
    --limit '93' \
    --offset '100' \
    --sortBy 'contributedValue:desc' \
    --tags '["REw3OEFX", "F8qYSa4o", "QDUFNC3D"]' \
    > test.out 2>&1
eval_tap $? 20 'AdminListUserContributions' test.out

#- 21 PublicListAchievements
$CLI_EXE \
    --sn achievement \
    --op PublicListAchievements \
    --namespace $AB_NAMESPACE \
    --global 'true' \
    --limit '83' \
    --offset '72' \
    --sortBy 'listOrder:asc' \
    --tags '["jMXzpgSM", "fm0MFILl", "T1qmiZFC"]' \
    --language 'LOiXjjZv' \
    > test.out 2>&1
eval_tap $? 21 'PublicListAchievements' test.out

#- 22 PublicGetAchievement
$CLI_EXE \
    --sn achievement \
    --op PublicGetAchievement \
    --achievementCode 'To3Udiq9' \
    --namespace $AB_NAMESPACE \
    --language 'j5CzyR3m' \
    > test.out 2>&1
eval_tap $? 22 'PublicGetAchievement' test.out

#- 23 PublicListGlobalAchievements
$CLI_EXE \
    --sn achievement \
    --op PublicListGlobalAchievements \
    --namespace $AB_NAMESPACE \
    --achievementCodes '6JUhrG6g' \
    --limit '46' \
    --offset '26' \
    --sortBy 'achievedAt:desc' \
    --status 'uzNkrERv' \
    --tags '["vyM0qGgx", "3YiF29SQ", "H6cM2JDX"]' \
    > test.out 2>&1
eval_tap $? 23 'PublicListGlobalAchievements' test.out

#- 24 ListGlobalAchievementContributors
$CLI_EXE \
    --sn achievement \
    --op ListGlobalAchievementContributors \
    --achievementCode '2GQXK85I' \
    --namespace $AB_NAMESPACE \
    --limit '93' \
    --offset '28' \
    --sortBy 'contributedValue' \
    > test.out 2>&1
eval_tap $? 24 'ListGlobalAchievementContributors' test.out

#- 25 PublicListTags
$CLI_EXE \
    --sn achievement \
    --op PublicListTags \
    --namespace $AB_NAMESPACE \
    --limit '100' \
    --name 'XeWtLdUp' \
    --offset '81' \
    --sortBy 'createdAt' \
    > test.out 2>&1
eval_tap $? 25 'PublicListTags' test.out

#- 26 PublicListUserAchievements
$CLI_EXE \
    --sn achievement \
    --op PublicListUserAchievements \
    --namespace $AB_NAMESPACE \
    --userId 'LNMrhxDk' \
    --limit '14' \
    --offset '75' \
    --preferUnlocked 'true' \
    --sortBy 'achievedAt' \
    --tags '["PVSYQh7M", "s0TuzmKY", "U8Ia2g6s"]' \
    > test.out 2>&1
eval_tap $? 26 'PublicListUserAchievements' test.out

#- 27 PublicBulkUnlockAchievement
# body param: body
echo '{"achievementCodes": ["wCB0p2p7", "y1jZWdZR", "37Mmhkjg"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op PublicBulkUnlockAchievement \
    --namespace $AB_NAMESPACE \
    --userId 'BMgSA5SC' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 27 'PublicBulkUnlockAchievement' test.out

#- 28 PublicUnlockAchievement
$CLI_EXE \
    --sn achievement \
    --op PublicUnlockAchievement \
    --achievementCode 'OPa3Y2Bu' \
    --namespace $AB_NAMESPACE \
    --userId 'thMamOuQ' \
    > test.out 2>&1
eval_tap $? 28 'PublicUnlockAchievement' test.out

#- 29 ListUserContributions
$CLI_EXE \
    --sn achievement \
    --op ListUserContributions \
    --namespace $AB_NAMESPACE \
    --userId 'S5aXZyzo' \
    --achievementCodes '5oajqHr8' \
    --limit '64' \
    --offset '67' \
    --sortBy 'contributedValue:desc' \
    --tags '["hVNW6Duh", "4Zww61Xh", "yIiLfXPQ"]' \
    > test.out 2>&1
eval_tap $? 29 'ListUserContributions' test.out

#- 30 ClaimGlobalAchievementReward
$CLI_EXE \
    --sn achievement \
    --op ClaimGlobalAchievementReward \
    --achievementCode 'DLXdwOrT' \
    --namespace $AB_NAMESPACE \
    --userId 'LhZUns4P' \
    > test.out 2>&1
eval_tap $? 30 'ClaimGlobalAchievementReward' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE