#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 
# - template file: 

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..27"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 AdminListAchievements
$CLI_EXE \
    --sn achievement \
    --op AdminListAchievements \
    --namespace $AB_NAMESPACE \
    --global 'true' \
    --limit '99' \
    --offset '36' \
    --sortBy 'updatedAt:asc' \
    --tags '["jgpxzB7L", "rf3T6BZI", "TOmy5UWY"]' \
    > test.out 2>&1
eval_tap $? 2 'AdminListAchievements' test.out

#- 3 AdminCreateNewAchievement
# body param: body
echo '{"achievementCode": "oP9LWWQw", "customAttributes": {"EDA0M7ur": {}, "pbHE5xvr": {}, "J6ShPblR": {}}, "defaultLanguage": "PMIjwH8x", "description": {"TH404aRD": "471sUsWP", "YfbmFuT9": "3idae3TI", "3B2TiR6W": "jZoIDqjm"}, "global": false, "goalValue": 0.12337137052695268, "hidden": false, "incremental": true, "lockedIcons": [{"slug": "mWx1Df0R", "url": "dJZ8wBgT"}, {"slug": "cS9cXON1", "url": "FNr2UjnZ"}, {"slug": "gJPAsq5i", "url": "vjZJ7hPa"}], "name": {"Qj3PdBu8": "IHerYJcO", "oB3aRADF": "VhU9tUbJ", "myzcyWFv": "cdVsMI97"}, "statCode": "6HqTDPj7", "tags": ["czTldQOv", "5scgsP7C", "Cww7xaOQ"], "unlockedIcons": [{"slug": "gmkLk5OO", "url": "8WKVkCmS"}, {"slug": "J12IBYKy", "url": "VoRmArQu"}, {"slug": "kAbJGyQc", "url": "sOoEJoF6"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op AdminCreateNewAchievement \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 3 'AdminCreateNewAchievement' test.out

#- 4 ExportAchievements
$CLI_EXE \
    --sn achievement \
    --op ExportAchievements \
    --namespace $AB_NAMESPACE \
    --tags '["adl7g0EE", "pJUg5viV", "RuvYMjJ2"]' \
    > test.out 2>&1
eval_tap $? 4 'ExportAchievements' test.out

#- 5 ImportAchievements
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn achievement \
    --op ImportAchievements \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'YW4onBfY' \
    > test.out 2>&1
eval_tap $? 5 'ImportAchievements' test.out

#- 6 AdminGetAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminGetAchievement \
    --achievementCode 'j1wj04ER' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'AdminGetAchievement' test.out

#- 7 AdminUpdateAchievement
# body param: body
echo '{"customAttributes": {"qwX6sRIg": {}, "zPeJ3h9n": {}, "piNJE4x5": {}}, "defaultLanguage": "fpmEhzmF", "description": {"ZA2L5FRE": "V2iBBZpc", "Cx2ALwq5": "kP9R2PTL", "Ly8LnZis": "9QtESAFE"}, "global": false, "goalValue": 0.29619409146724796, "hidden": false, "incremental": true, "lockedIcons": [{"slug": "DKT3pyxv", "url": "pqXCcNAc"}, {"slug": "PwNq8fYS", "url": "OmqBsnGN"}, {"slug": "iJTOqyLd", "url": "5Q1uxwOy"}], "name": {"fcEu6LlB": "fk2YBLOQ", "H3llBany": "GuuOOdWR", "t3JQkHYO": "PjLpy7DF"}, "statCode": "ZY3VF1Ni", "tags": ["8fiJo6E8", "R1McAoLr", "wRaDT0c9"], "unlockedIcons": [{"slug": "s0GaqZjP", "url": "P08MfgGr"}, {"slug": "HaxXFqbO", "url": "5z5ovONB"}, {"slug": "XBNwWBWh", "url": "Urxyst3b"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op AdminUpdateAchievement \
    --achievementCode 'YdGvwd2U' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'AdminUpdateAchievement' test.out

#- 8 AdminDeleteAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminDeleteAchievement \
    --achievementCode 'KULytqp7' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 8 'AdminDeleteAchievement' test.out

#- 9 AdminUpdateAchievementListOrder
# body param: body
echo '{"targetOrder": 31}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn achievement \
    --op AdminUpdateAchievementListOrder \
    --achievementCode 'b7BvIpHk' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'AdminUpdateAchievementListOrder' test.out

#- 10 AdminListGlobalAchievements
$CLI_EXE \
    --sn achievement \
    --op AdminListGlobalAchievements \
    --namespace $AB_NAMESPACE \
    --achievementCodes 'aF37fuLV' \
    --limit '88' \
    --offset '5' \
    --sortBy 'AcvkmbvH' \
    --status 'a6NWIZNe' \
    --tags '["I6lMtbSi", "KJFJyxRf", "ePkp0Z46"]' \
    > test.out 2>&1
eval_tap $? 10 'AdminListGlobalAchievements' test.out

#- 11 AdminListGlobalAchievementContributors
$CLI_EXE \
    --sn achievement \
    --op AdminListGlobalAchievementContributors \
    --achievementCode 'gjALmHHm' \
    --namespace $AB_NAMESPACE \
    --limit '3' \
    --offset '3' \
    --sortBy 'ovKu1pg1' \
    > test.out 2>&1
eval_tap $? 11 'AdminListGlobalAchievementContributors' test.out

#- 12 ResetGlobalAchievement
$CLI_EXE \
    --sn achievement \
    --op ResetGlobalAchievement \
    --achievementCode 'Mx0hxDAI' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'ResetGlobalAchievement' test.out

#- 13 AdminListTags
$CLI_EXE \
    --sn achievement \
    --op AdminListTags \
    --namespace $AB_NAMESPACE \
    --limit '21' \
    --name 'fTafTHYU' \
    --offset '25' \
    --sortBy 'EHPIiTkO' \
    > test.out 2>&1
eval_tap $? 13 'AdminListTags' test.out

#- 14 AdminListUserAchievements
$CLI_EXE \
    --sn achievement \
    --op AdminListUserAchievements \
    --namespace $AB_NAMESPACE \
    --userId 'i84j8XQv' \
    --limit '36' \
    --offset '88' \
    --preferUnlocked 'false' \
    --sortBy 'Ink6OMdv' \
    --tags '["wyr7qGH0", "XNU2Oebc", "KQoQAlOv"]' \
    > test.out 2>&1
eval_tap $? 14 'AdminListUserAchievements' test.out

#- 15 AdminResetAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminResetAchievement \
    --achievementCode '7mcZwUQv' \
    --namespace $AB_NAMESPACE \
    --userId 'DjHSJGTA' \
    > test.out 2>&1
eval_tap $? 15 'AdminResetAchievement' test.out

#- 16 AdminUnlockAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminUnlockAchievement \
    --achievementCode 'Tc1Q3pBn' \
    --namespace $AB_NAMESPACE \
    --userId 'bvZAfIkL' \
    > test.out 2>&1
eval_tap $? 16 'AdminUnlockAchievement' test.out

#- 17 AdminAnonymizeUserAchievement
$CLI_EXE \
    --sn achievement \
    --op AdminAnonymizeUserAchievement \
    --namespace $AB_NAMESPACE \
    --userId 'URh3MYox' \
    > test.out 2>&1
eval_tap $? 17 'AdminAnonymizeUserAchievement' test.out

#- 18 AdminListUserContributions
$CLI_EXE \
    --sn achievement \
    --op AdminListUserContributions \
    --namespace $AB_NAMESPACE \
    --userId 'fgooydtp' \
    --achievementCodes 'LW78RHn4' \
    --limit '94' \
    --offset '9' \
    --sortBy 'mrVGfPsX' \
    --tags '["M8WlvjPk", "9E2xQ1wM", "MOejwaM2"]' \
    > test.out 2>&1
eval_tap $? 18 'AdminListUserContributions' test.out

#- 19 PublicListAchievements
$CLI_EXE \
    --sn achievement \
    --op PublicListAchievements \
    --namespace $AB_NAMESPACE \
    --global 'false' \
    --limit '59' \
    --offset '91' \
    --sortBy 'createdAt:desc' \
    --tags '["2uFinBC1", "ydRtJ3ux", "aH4JBbBv"]' \
    --language '6XwbqdAs' \
    > test.out 2>&1
eval_tap $? 19 'PublicListAchievements' test.out

#- 20 PublicGetAchievement
$CLI_EXE \
    --sn achievement \
    --op PublicGetAchievement \
    --achievementCode 'm4ORuuIj' \
    --namespace $AB_NAMESPACE \
    --language 'ojwh8be1' \
    > test.out 2>&1
eval_tap $? 20 'PublicGetAchievement' test.out

#- 21 PublicListGlobalAchievements
$CLI_EXE \
    --sn achievement \
    --op PublicListGlobalAchievements \
    --namespace $AB_NAMESPACE \
    --achievementCodes 'ccEJgQ3J' \
    --limit '31' \
    --offset '10' \
    --sortBy 'zHaQpB9N' \
    --status 'dyel4DPS' \
    --tags '["HnxIP3Bl", "TmMs9pja", "uEg1lZ4i"]' \
    > test.out 2>&1
eval_tap $? 21 'PublicListGlobalAchievements' test.out

#- 22 ListGlobalAchievementContributors
$CLI_EXE \
    --sn achievement \
    --op ListGlobalAchievementContributors \
    --achievementCode 'gsggVgVu' \
    --namespace $AB_NAMESPACE \
    --limit '35' \
    --offset '81' \
    --sortBy 'DZZ9HOrv' \
    > test.out 2>&1
eval_tap $? 22 'ListGlobalAchievementContributors' test.out

#- 23 PublicListTags
$CLI_EXE \
    --sn achievement \
    --op PublicListTags \
    --namespace $AB_NAMESPACE \
    --limit '42' \
    --name 'lMwiYbW2' \
    --offset '91' \
    --sortBy 'm9Jyj4no' \
    > test.out 2>&1
eval_tap $? 23 'PublicListTags' test.out

#- 24 PublicListUserAchievements
$CLI_EXE \
    --sn achievement \
    --op PublicListUserAchievements \
    --namespace $AB_NAMESPACE \
    --userId 'BLGVEeN3' \
    --limit '75' \
    --offset '31' \
    --preferUnlocked 'false' \
    --sortBy 'URAsYxdv' \
    --tags '["KU6KFb9B", "i2oSaCAc", "MV07xFZa"]' \
    > test.out 2>&1
eval_tap $? 24 'PublicListUserAchievements' test.out

#- 25 PublicUnlockAchievement
$CLI_EXE \
    --sn achievement \
    --op PublicUnlockAchievement \
    --achievementCode 'Br61Ehim' \
    --namespace $AB_NAMESPACE \
    --userId 't6iINltR' \
    > test.out 2>&1
eval_tap $? 25 'PublicUnlockAchievement' test.out

#- 26 ListUserContributions
$CLI_EXE \
    --sn achievement \
    --op ListUserContributions \
    --namespace $AB_NAMESPACE \
    --userId 'cCWnz5nv' \
    --achievementCodes 'RV7rD0Pr' \
    --limit '67' \
    --offset '10' \
    --sortBy 'KSB1JJvt' \
    --tags '["zOFiMwgE", "GoFBDHTs", "My3nethS"]' \
    > test.out 2>&1
eval_tap $? 26 'ListUserContributions' test.out

#- 27 ClaimGlobalAchievementReward
$CLI_EXE \
    --sn achievement \
    --op ClaimGlobalAchievementReward \
    --achievementCode 'a8JKDuHT' \
    --namespace $AB_NAMESPACE \
    --userId 'uj5woh4O' \
    > test.out 2>&1
eval_tap $? 27 'ClaimGlobalAchievementReward' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE